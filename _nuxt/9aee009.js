(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1061:function(e,t,r){"use strict";r.r(t),r.d(t,"Provider",(function(){return n.b})),r.d(t,"BaseProvider",(function(){return z})),r.d(t,"Resolver",(function(){return V})),r.d(t,"UrlJsonRpcProvider",(function(){return ye})),r.d(t,"FallbackProvider",(function(){return Qe})),r.d(t,"AlchemyProvider",(function(){return Ee})),r.d(t,"AlchemyWebSocketProvider",(function(){return we})),r.d(t,"CloudflareProvider",(function(){return ke})),r.d(t,"EtherscanProvider",(function(){return Pe})),r.d(t,"InfuraProvider",(function(){return tt})),r.d(t,"InfuraWebSocketProvider",(function(){return et})),r.d(t,"JsonRpcProvider",(function(){return le})),r.d(t,"NodesmithProvider",(function(){return st})),r.d(t,"PocketProvider",(function(){return at})),r.d(t,"StaticJsonRpcProvider",(function(){return be})),r.d(t,"Web3Provider",(function(){return ht})),r.d(t,"WebSocketProvider",(function(){return me})),r.d(t,"IpcProvider",(function(){return Xe})),r.d(t,"JsonRpcSigner",(function(){return oe})),r.d(t,"getDefaultProvider",(function(){return mt})),r.d(t,"getNetwork",(function(){return o.a})),r.d(t,"isCommunityResource",(function(){return C})),r.d(t,"isCommunityResourcable",(function(){return N})),r.d(t,"showThrottleMessage",(function(){return j})),r.d(t,"Formatter",(function(){return _}));var n=r(220),o=r(214),c=r(154),l=r(91),d=r(11),h=r(928),f=r(3178),m=r(0),y=r(408),v=r(119),T=r(58),w=r(347),E=r.n(w),S=r(2);const I="providers/5.0.23";var k=r(118),x=r(927),O=r(37);const A=new S.b(I);class _{constructor(){A.checkNew(new.target,_),this.formats=this.getDefaultFormats()}getDefaultFormats(){const e={},address=this.address.bind(this),t=this.bigNumber.bind(this),r=this.blockTag.bind(this),data=this.data.bind(this),n=this.hash.bind(this),o=this.hex.bind(this),c=this.number.bind(this);return e.transaction={hash:n,blockHash:_.allowNull(n,null),blockNumber:_.allowNull(c,null),transactionIndex:_.allowNull(c,null),confirmations:_.allowNull(c,null),from:address,gasPrice:t,gasLimit:t,to:_.allowNull(address,null),value:t,nonce:c,data:data,r:_.allowNull(this.uint256),s:_.allowNull(this.uint256),v:_.allowNull(c),creates:_.allowNull(address,null),raw:_.allowNull(data)},e.transactionRequest={from:_.allowNull(address),nonce:_.allowNull(c),gasLimit:_.allowNull(t),gasPrice:_.allowNull(t),to:_.allowNull(address),value:_.allowNull(t),data:_.allowNull((e=>this.data(e,!0)))},e.receiptLog={transactionIndex:c,blockNumber:c,transactionHash:n,address:address,topics:_.arrayOf(n),data:data,logIndex:c,blockHash:n},e.receipt={to:_.allowNull(this.address,null),from:_.allowNull(this.address,null),contractAddress:_.allowNull(address,null),transactionIndex:c,root:_.allowNull(o),gasUsed:t,logsBloom:_.allowNull(data),blockHash:n,transactionHash:n,logs:_.arrayOf(this.receiptLog.bind(this)),blockNumber:c,confirmations:_.allowNull(c,null),cumulativeGasUsed:t,status:_.allowNull(c)},e.block={hash:n,parentHash:n,number:c,timestamp:c,nonce:_.allowNull(o),difficulty:this.difficulty.bind(this),gasLimit:t,gasUsed:t,miner:address,extraData:data,transactions:_.allowNull(_.arrayOf(n))},e.blockWithTransactions=Object(m.g)(e.block),e.blockWithTransactions.transactions=_.allowNull(_.arrayOf(this.transactionResponse.bind(this))),e.filter={fromBlock:_.allowNull(r,void 0),toBlock:_.allowNull(r,void 0),blockHash:_.allowNull(n,void 0),address:_.allowNull(address,void 0),topics:_.allowNull(this.topics.bind(this),void 0)},e.filterLog={blockNumber:_.allowNull(c),blockHash:_.allowNull(n),transactionIndex:c,removed:_.allowNull(this.boolean.bind(this)),address:address,data:_.allowFalsish(data,"0x"),topics:_.arrayOf(n),transactionHash:n,logIndex:c},e}number(e){return"0x"===e?0:l.a.from(e).toNumber()}bigNumber(e){return l.a.from(e)}boolean(e){if("boolean"==typeof e)return e;if("string"==typeof e){if("true"===(e=e.toLowerCase()))return!0;if("false"===e)return!1}throw new Error("invalid boolean - "+e)}hex(e,t){return"string"==typeof e&&(t||"0x"===e.substring(0,2)||(e="0x"+e),Object(d.isHexString)(e))?e.toLowerCase():A.throwArgumentError("invalid hash","value",e)}data(e,t){const r=this.hex(e,t);if(r.length%2!=0)throw new Error("invalid data; odd-length - "+e);return r}address(e){return Object(k.getAddress)(e)}callAddress(e){if(!Object(d.isHexString)(e,32))return null;const address=Object(k.getAddress)(Object(d.hexDataSlice)(e,12));return address===x.a?null:address}contractAddress(e){return Object(k.getContractAddress)(e)}blockTag(e){if(null==e)return"latest";if("earliest"===e)return"0x0";if("latest"===e||"pending"===e)return e;if("number"==typeof e||Object(d.isHexString)(e))return Object(d.hexValue)(e);throw new Error("invalid blockTag")}hash(e,t){const r=this.hex(e,t);return 32!==Object(d.hexDataLength)(r)?A.throwArgumentError("invalid hash","value",e):r}difficulty(e){if(null==e)return null;const t=l.a.from(e);try{return t.toNumber()}catch(e){}return null}uint256(e){if(!Object(d.isHexString)(e))throw new Error("invalid uint256");return Object(d.hexZeroPad)(e,32)}_block(e,t){return null!=e.author&&null==e.miner&&(e.miner=e.author),_.check(t,e)}block(e){return this._block(e,this.formats.block)}blockWithTransactions(e){return this._block(e,this.formats.blockWithTransactions)}transactionRequest(e){return _.check(this.formats.transactionRequest,e)}transactionResponse(e){null!=e.gas&&null==e.gasLimit&&(e.gasLimit=e.gas),e.to&&l.a.from(e.to).isZero()&&(e.to="0x0000000000000000000000000000000000000000"),null!=e.input&&null==e.data&&(e.data=e.input),null==e.to&&null==e.creates&&(e.creates=this.contractAddress(e));const t=_.check(this.formats.transaction,e);if(null!=e.chainId){let r=e.chainId;Object(d.isHexString)(r)&&(r=l.a.from(r).toNumber()),t.chainId=r}else{let r=e.networkId;null==r&&null==t.v&&(r=e.chainId),Object(d.isHexString)(r)&&(r=l.a.from(r).toNumber()),"number"!=typeof r&&null!=t.v&&(r=(t.v-35)/2,r<0&&(r=0),r=parseInt(r)),"number"!=typeof r&&(r=0),t.chainId=r}return t.blockHash&&"x"===t.blockHash.replace(/0/g,"")&&(t.blockHash=null),t}transaction(e){return Object(O.parse)(e)}receiptLog(e){return _.check(this.formats.receiptLog,e)}receipt(e){const t=_.check(this.formats.receipt,e);if(null!=t.root)if(t.root.length<=4){const e=l.a.from(t.root).toNumber();0===e||1===e?(null!=t.status&&t.status!==e&&A.throwArgumentError("alt-root-status/status mismatch","value",{root:t.root,status:t.status}),t.status=e,delete t.root):A.throwArgumentError("invalid alt-root-status","value.root",t.root)}else 66!==t.root.length&&A.throwArgumentError("invalid root hash","value.root",t.root);return null!=t.status&&(t.byzantium=!0),t}topics(e){return Array.isArray(e)?e.map((e=>this.topics(e))):null!=e?this.hash(e,!0):null}filter(e){return _.check(this.formats.filter,e)}filterLog(e){return _.check(this.formats.filterLog,e)}static check(e,object){const t={};for(const r in e)try{const n=e[r](object[r]);void 0!==n&&(t[r]=n)}catch(e){throw e.checkKey=r,e.checkValue=object[r],e}return t}static allowNull(e,t){return function(r){return null==r?t:e(r)}}static allowFalsish(e,t){return function(r){return r?e(r):t}}static arrayOf(e){return function(t){if(!Array.isArray(t))throw new Error("not an array");const r=[];return t.forEach((function(t){r.push(e(t))})),r}}}function N(e){return e&&"function"==typeof e.isCommunityResource}function C(e){return N(e)&&e.isCommunityResource()}let R=!1;function j(){R||(R=!0,console.log("========= NOTICE ========="),console.log("Request-Rate Exceeded  (this message will not be repeated)"),console.log(""),console.log("The default API keys for each service are provided as a highly-throttled,"),console.log("community resource for low-traffic projects and early prototyping."),console.log(""),console.log("While your application will continue to function, we highly recommended"),console.log("signing up for your own API keys to improve performance, increase your"),console.log("request rate/limit and enable other perks, such as metrics and advanced APIs."),console.log(""),console.log("For more details: https://docs.ethers.io/api-keys/"),console.log("=========================="))}var P=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const B=new S.b(I);function D(e){return null==e?"null":(32!==Object(d.hexDataLength)(e)&&B.throwArgumentError("invalid topic","topic",e),e.toLowerCase())}function F(e){for(e=e.slice();e.length>0&&null==e[e.length-1];)e.pop();return e.map((e=>{if(Array.isArray(e)){const t={};e.forEach((e=>{t[D(e)]=!0}));const r=Object.keys(t);return r.sort(),r.join("|")}return D(e)})).join("&")}function U(e){if("string"==typeof e){if(e=e.toLowerCase(),32===Object(d.hexDataLength)(e))return"tx:"+e;if(-1===e.indexOf(":"))return e}else{if(Array.isArray(e))return"filter:*:"+F(e);if(n.a.isForkEvent(e))throw B.warn("not implemented"),new Error("not implemented");if(e&&"object"==typeof e)return"filter:"+(e.address||"*")+":"+F(e.topics||[])}throw new Error("invalid event - "+e)}function M(){return(new Date).getTime()}const H=["block","network","pending","poll"];class L{constructor(e,t,r){Object(m.d)(this,"tag",e),Object(m.d)(this,"listener",t),Object(m.d)(this,"once",r)}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const e=this.tag.split(":");return"tx"!==e[0]?null:e[1]}get filter(){const e=this.tag.split(":");if("filter"!==e[0])return null;const address=e[1],t=""===(data=e[2])?[]:data.split(/&/g).map((e=>{if(""===e)return[];const t=e.split("|").map((e=>"null"===e?null:e));return 1===t.length?t[0]:t}));var data;const filter={};return t.length>0&&(filter.topics=t),address&&"*"!==address&&(filter.address=address),filter}pollable(){return this.tag.indexOf(":")>=0||H.indexOf(this.tag)>=0}}const W={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function $(e){return Object(d.hexZeroPad)(l.a.from(e).toHexString(),32)}function G(data){return c.a.encode(Object(d.concat)([data,Object(d.hexDataSlice)(Object(y.c)(Object(y.c)(data)),0,4)]))}class V{constructor(e,address,t){Object(m.d)(this,"provider",e),Object(m.d)(this,"name",t),Object(m.d)(this,"address",e.formatter.address(address))}_fetchBytes(e,t){return P(this,void 0,void 0,(function*(){const r={to:this.address,data:Object(d.hexConcat)([e,Object(f.b)(this.name),t||"0x"])},n=yield this.provider.call(r);if("0x"===n)return null;const o=l.a.from(Object(d.hexDataSlice)(n,0,32)).toNumber(),c=l.a.from(Object(d.hexDataSlice)(n,o,o+32)).toNumber();return Object(d.hexDataSlice)(n,o+32,o+32+c)}))}_getAddress(e,t){const r=W[String(e)];if(null==r&&B.throwError(`unsupported coin type: ${e}`,S.b.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`}),"eth"===r.ilk)return this.provider.formatter.address(t);const n=Object(d.arrayify)(t);if(null!=r.p2pkh){const e=t.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(e){const t=parseInt(e[1],16);if(e[2].length===2*t&&t>=1&&t<=75)return G(Object(d.concat)([[r.p2pkh],"0x"+e[2]]))}}if(null!=r.p2sh){const e=t.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(e){const t=parseInt(e[1],16);if(e[2].length===2*t&&t>=1&&t<=75)return G(Object(d.concat)([[r.p2sh],"0x"+e[2]]))}}if(null!=r.prefix){const e=n[1];let t=n[0];if(0===t?20!==e&&32!==e&&(t=-1):t=-1,t>=0&&n.length===2+e&&e>=1&&e<=75){const e=E.a.toWords(n.slice(2));return e.unshift(t),E.a.encode(r.prefix,e)}}return null}getAddress(e){return P(this,void 0,void 0,(function*(){if(null==e&&(e=60),60===e){const e={to:this.address,data:"0x3b3b57de"+Object(f.b)(this.name).substring(2)},t=yield this.provider.call(e);return"0x"===t||t===h.a?null:this.provider.formatter.callAddress(t)}const t=yield this._fetchBytes("0xf1cb7e06",$(e));if(null==t||"0x"===t)return null;const address=this._getAddress(e,t);return null==address&&B.throwError("invalid or unsupported coin data",S.b.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`,coinType:e,data:t}),address}))}getContentHash(){return P(this,void 0,void 0,(function*(){const e=yield this._fetchBytes("0xbc1c58d1");if(null==e||"0x"===e)return null;const t=e.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const e=parseInt(t[3],16);if(t[4].length===2*e)return"ipfs://"+c.a.encode("0x"+t[1])}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);return r&&64===r[1].length?"bzz://"+r[1]:B.throwError("invalid or unsupported content hash data",S.b.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:e})}))}getText(e){return P(this,void 0,void 0,(function*(){let t=Object(v.f)(e);t=Object(d.concat)([$(64),$(t.length),t]),t.length%32!=0&&(t=Object(d.concat)([t,Object(d.hexZeroPad)("0x",32-e.length%32)]));const r=yield this._fetchBytes("0x59d1d43c",Object(d.hexlify)(t));return null==r||"0x"===r?null:Object(v.h)(r)}))}}let K=null,J=1;class z extends n.b{constructor(e){if(B.checkNew(new.target,n.b),super(),this._events=[],this._emitted={block:-2},this.formatter=new.target.getFormatter(),Object(m.d)(this,"anyNetwork","any"===e),this.anyNetwork&&(e=this.detectNetwork()),e instanceof Promise)this._networkPromise=e,e.catch((e=>{})),this._ready().catch((e=>{}));else{const t=Object(m.e)(new.target,"getNetwork")(e);t?(Object(m.d)(this,"_network",t),this.emit("network",t,null)):B.throwArgumentError("invalid network","network",e)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return P(this,void 0,void 0,(function*(){if(null==this._network){let e=null;if(this._networkPromise)try{e=yield this._networkPromise}catch(e){}null==e&&(e=yield this.detectNetwork()),e||B.throwError("no network detected",S.b.errors.UNKNOWN_ERROR,{}),null==this._network&&(this.anyNetwork?this._network=e:Object(m.d)(this,"_network",e),this.emit("network",e,null))}return this._network}))}get ready(){return Object(T.poll)((()=>this._ready().then((e=>e),(e=>{if(e.code!==S.b.errors.NETWORK_ERROR||"noNetwork"!==e.event)throw e}))))}static getFormatter(){return null==K&&(K=new _),K}static getNetwork(e){return Object(o.a)(null==e?"homestead":e)}_getInternalBlockNumber(e){return P(this,void 0,void 0,(function*(){if(yield this._ready(),e>0)for(;this._internalBlockNumber;){const t=this._internalBlockNumber;try{const r=yield t;if(M()-r.respTime<=e)return r.blockNumber;break}catch(e){if(this._internalBlockNumber===t)break}}const t=M(),r=Object(m.f)({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then((e=>null),(e=>e))}).then((({blockNumber:e,networkError:n})=>{if(n)throw this._internalBlockNumber===r&&(this._internalBlockNumber=null),n;const o=M();return(e=l.a.from(e).toNumber())<this._maxInternalBlockNumber&&(e=this._maxInternalBlockNumber),this._maxInternalBlockNumber=e,this._setFastBlockNumber(e),{blockNumber:e,reqTime:t,respTime:o}}));return this._internalBlockNumber=r,r.catch((e=>{this._internalBlockNumber===r&&(this._internalBlockNumber=null)})),(yield r).blockNumber}))}poll(){return P(this,void 0,void 0,(function*(){const e=J++,t=[];let r=null;try{r=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(e){return void this.emit("error",e)}if(this._setFastBlockNumber(r),this.emit("poll",e,r),r!==this._lastBlockNumber){if(-2===this._emitted.block&&(this._emitted.block=r-1),Math.abs(this._emitted.block-r)>1e3)B.warn("network block skew detected; skipping block events"),this.emit("error",B.makeError("network block skew detected",S.b.errors.NETWORK_ERROR,{blockNumber:r,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",r);else for(let i=this._emitted.block+1;i<=r;i++)this.emit("block",i);this._emitted.block!==r&&(this._emitted.block=r,Object.keys(this._emitted).forEach((e=>{if("block"===e)return;const t=this._emitted[e];"pending"!==t&&r-t>12&&delete this._emitted[e]}))),-2===this._lastBlockNumber&&(this._lastBlockNumber=r-1),this._events.forEach((e=>{switch(e.type){case"tx":{const r=e.hash;let n=this.getTransactionReceipt(r).then((e=>e&&null!=e.blockNumber?(this._emitted["t:"+r]=e.blockNumber,this.emit(r,e),null):null)).catch((e=>{this.emit("error",e)}));t.push(n);break}case"filter":{const filter=e.filter;filter.fromBlock=this._lastBlockNumber+1,filter.toBlock=r;const n=this.getLogs(filter).then((e=>{0!==e.length&&e.forEach((e=>{this._emitted["b:"+e.blockHash]=e.blockNumber,this._emitted["t:"+e.transactionHash]=e.blockNumber,this.emit(filter,e)}))})).catch((e=>{this.emit("error",e)}));t.push(n);break}}})),this._lastBlockNumber=r,Promise.all(t).then((()=>{this.emit("didPoll",e)})).catch((e=>{this.emit("error",e)}))}else this.emit("didPoll",e)}))}resetEventsBlock(e){this._lastBlockNumber=e-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return P(this,void 0,void 0,(function*(){return B.throwError("provider does not support network detection",S.b.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})}))}getNetwork(){return P(this,void 0,void 0,(function*(){const e=yield this._ready(),t=yield this.detectNetwork();if(e.chainId!==t.chainId){if(this.anyNetwork)return this._network=t,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",t,e),yield(r=0,new Promise((e=>{setTimeout(e,r)}))),this._network;const n=B.makeError("underlying network changed",S.b.errors.NETWORK_ERROR,{event:"changed",network:e,detectedNetwork:t});throw this.emit("error",n),n}var r;return e}))}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then((e=>{this._setFastBlockNumber(e)}),(e=>{})),null!=this._fastBlockNumber?this._fastBlockNumber:-1}get polling(){return null!=this._poller}set polling(e){e&&!this._poller?(this._poller=setInterval((()=>{this.poll()}),this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout((()=>{this.poll(),this._bootstrapPoll=setTimeout((()=>{this._poller||this.poll(),this._bootstrapPoll=null}),this.pollingInterval)}),0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(e){if("number"!=typeof e||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval((()=>{this.poll()}),this._pollingInterval))}_getFastBlockNumber(){const e=M();return e-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=e,this._fastBlockNumberPromise=this.getBlockNumber().then((e=>((null==this._fastBlockNumber||e>this._fastBlockNumber)&&(this._fastBlockNumber=e),this._fastBlockNumber)))),this._fastBlockNumberPromise}_setFastBlockNumber(e){null!=this._fastBlockNumber&&e<this._fastBlockNumber||(this._fastQueryDate=M(),(null==this._fastBlockNumber||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))}waitForTransaction(e,t,r){return P(this,void 0,void 0,(function*(){null==t&&(t=1);const n=yield this.getTransactionReceipt(e);return(n?n.confirmations:0)>=t?n:new Promise(((n,o)=>{let c=null,l=!1;const d=r=>{r.confirmations<t||(c&&clearTimeout(c),l||(l=!0,this.removeListener(e,d),n(r)))};this.on(e,d),"number"==typeof r&&r>0&&(c=setTimeout((()=>{l||(c=null,l=!0,this.removeListener(e,d),o(B.makeError("timeout exceeded",S.b.errors.TIMEOUT,{timeout:r})))}),r),c.unref&&c.unref())}))}))}getBlockNumber(){return P(this,void 0,void 0,(function*(){return this._getInternalBlockNumber(0)}))}getGasPrice(){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const e=yield this.perform("getGasPrice",{});try{return l.a.from(e)}catch(t){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"getGasPrice",result:e,error:t})}}))}getBalance(e,t){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const r=yield Object(m.f)({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),n=yield this.perform("getBalance",r);try{return l.a.from(n)}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"getBalance",params:r,result:n,error:e})}}))}getTransactionCount(e,t){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const r=yield Object(m.f)({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),n=yield this.perform("getTransactionCount",r);try{return l.a.from(n).toNumber()}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"getTransactionCount",params:r,result:n,error:e})}}))}getCode(e,t){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const r=yield Object(m.f)({address:this._getAddress(e),blockTag:this._getBlockTag(t)}),n=yield this.perform("getCode",r);try{return Object(d.hexlify)(n)}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"getCode",params:r,result:n,error:e})}}))}getStorageAt(e,t,r){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const n=yield Object(m.f)({address:this._getAddress(e),blockTag:this._getBlockTag(r),position:Promise.resolve(t).then((p=>Object(d.hexValue)(p)))}),o=yield this.perform("getStorageAt",n);try{return Object(d.hexlify)(o)}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"getStorageAt",params:n,result:o,error:e})}}))}_wrapTransaction(e,t){if(null!=t&&32!==Object(d.hexDataLength)(t))throw new Error("invalid response - sendTransaction");const r=e;return null!=t&&e.hash!==t&&B.throwError("Transaction hash mismatch from Provider.sendTransaction.",S.b.errors.UNKNOWN_ERROR,{expectedHash:e.hash,returnedHash:t}),r.wait=t=>P(this,void 0,void 0,(function*(){0!==t&&(this._emitted["t:"+e.hash]="pending");const r=yield this.waitForTransaction(e.hash,t);return null==r&&0===t?null:(this._emitted["t:"+e.hash]=r.blockNumber,0===r.status&&B.throwError("transaction failed",S.b.errors.CALL_EXCEPTION,{transactionHash:e.hash,transaction:e,receipt:r}),r)})),r}sendTransaction(e){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const t=yield Promise.resolve(e).then((e=>Object(d.hexlify)(e))),r=this.formatter.transaction(e);try{const e=yield this.perform("sendTransaction",{signedTransaction:t});return this._wrapTransaction(r,e)}catch(e){throw e.transaction=r,e.transactionHash=r.hash,e}}))}_getTransactionRequest(e){return P(this,void 0,void 0,(function*(){const t=yield e,r={};return["from","to"].forEach((e=>{null!=t[e]&&(r[e]=Promise.resolve(t[e]).then((e=>e?this._getAddress(e):null)))})),["gasLimit","gasPrice","value"].forEach((e=>{null!=t[e]&&(r[e]=Promise.resolve(t[e]).then((e=>e?l.a.from(e):null)))})),["data"].forEach((e=>{null!=t[e]&&(r[e]=Promise.resolve(t[e]).then((e=>e?Object(d.hexlify)(e):null)))})),this.formatter.transactionRequest(yield Object(m.f)(r))}))}_getFilter(filter){return P(this,void 0,void 0,(function*(){filter=yield filter;const e={};return null!=filter.address&&(e.address=this._getAddress(filter.address)),["blockHash","topics"].forEach((t=>{null!=filter[t]&&(e[t]=filter[t])})),["fromBlock","toBlock"].forEach((t=>{null!=filter[t]&&(e[t]=this._getBlockTag(filter[t]))})),this.formatter.filter(yield Object(m.f)(e))}))}call(e,t){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const r=yield Object(m.f)({transaction:this._getTransactionRequest(e),blockTag:this._getBlockTag(t)}),n=yield this.perform("call",r);try{return Object(d.hexlify)(n)}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"call",params:r,result:n,error:e})}}))}estimateGas(e){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const t=yield Object(m.f)({transaction:this._getTransactionRequest(e)}),r=yield this.perform("estimateGas",t);try{return l.a.from(r)}catch(e){return B.throwError("bad result from backend",S.b.errors.SERVER_ERROR,{method:"estimateGas",params:t,result:r,error:e})}}))}_getAddress(e){return P(this,void 0,void 0,(function*(){const address=yield this.resolveName(e);return null==address&&B.throwError("ENS name not configured",S.b.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(e)})`}),address}))}_getBlock(e,t){return P(this,void 0,void 0,(function*(){yield this.getNetwork(),e=yield e;let r=-128;const n={includeTransactions:!!t};if(Object(d.isHexString)(e,32))n.blockHash=e;else try{n.blockTag=this.formatter.blockTag(yield this._getBlockTag(e)),Object(d.isHexString)(n.blockTag)&&(r=parseInt(n.blockTag.substring(2),16))}catch(t){B.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",e)}return Object(T.poll)((()=>P(this,void 0,void 0,(function*(){const e=yield this.perform("getBlock",n);if(null==e)return null!=n.blockHash&&null==this._emitted["b:"+n.blockHash]||null!=n.blockTag&&r>this._emitted.block?null:void 0;if(t){let t=null;for(let i=0;i<e.transactions.length;i++){const r=e.transactions[i];if(null==r.blockNumber)r.confirmations=0;else if(null==r.confirmations){null==t&&(t=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let e=t-r.blockNumber+1;e<=0&&(e=1),r.confirmations=e}}return this.formatter.blockWithTransactions(e)}return this.formatter.block(e)}))),{oncePoll:this})}))}getBlock(e){return this._getBlock(e,!1)}getBlockWithTransactions(e){return this._getBlock(e,!0)}getTransaction(e){return P(this,void 0,void 0,(function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Object(T.poll)((()=>P(this,void 0,void 0,(function*(){const r=yield this.perform("getTransaction",t);if(null==r)return null==this._emitted["t:"+e]?null:void 0;const n=this.formatter.transactionResponse(r);if(null==n.blockNumber)n.confirmations=0;else if(null==n.confirmations){let e=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;e<=0&&(e=1),n.confirmations=e}return this._wrapTransaction(n)}))),{oncePoll:this})}))}getTransactionReceipt(e){return P(this,void 0,void 0,(function*(){yield this.getNetwork(),e=yield e;const t={transactionHash:this.formatter.hash(e,!0)};return Object(T.poll)((()=>P(this,void 0,void 0,(function*(){const r=yield this.perform("getTransactionReceipt",t);if(null==r)return null==this._emitted["t:"+e]?null:void 0;if(null==r.blockHash)return;const n=this.formatter.receipt(r);if(null==n.blockNumber)n.confirmations=0;else if(null==n.confirmations){let e=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;e<=0&&(e=1),n.confirmations=e}return n}))),{oncePoll:this})}))}getLogs(filter){return P(this,void 0,void 0,(function*(){yield this.getNetwork();const e=yield Object(m.f)({filter:this._getFilter(filter)}),t=yield this.perform("getLogs",e);return t.forEach((e=>{null==e.removed&&(e.removed=!1)})),_.arrayOf(this.formatter.filterLog.bind(this.formatter))(t)}))}getEtherPrice(){return P(this,void 0,void 0,(function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})}))}_getBlockTag(e){return P(this,void 0,void 0,(function*(){if("number"==typeof(e=yield e)&&e<0){e%1&&B.throwArgumentError("invalid BlockTag","blockTag",e);let t=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return t+=e,t<0&&(t=0),this.formatter.blockTag(t)}return this.formatter.blockTag(e)}))}getResolver(e){return P(this,void 0,void 0,(function*(){const address=yield this._getResolver(e);return null==address?null:new V(this,address,e)}))}_getResolver(e){return P(this,void 0,void 0,(function*(){const t=yield this.getNetwork();t.ensAddress||B.throwError("network does not support ENS",S.b.errors.UNSUPPORTED_OPERATION,{operation:"ENS",network:t.name});const r={to:t.ensAddress,data:"0x0178b8bf"+Object(f.b)(e).substring(2)};return this.formatter.callAddress(yield this.call(r))}))}resolveName(e){return P(this,void 0,void 0,(function*(){e=yield e;try{return Promise.resolve(this.formatter.address(e))}catch(t){if(Object(d.isHexString)(e))throw t}"string"!=typeof e&&B.throwArgumentError("invalid ENS name","name",e);const t=yield this.getResolver(e);return t?yield t.getAddress():null}))}lookupAddress(address){return P(this,void 0,void 0,(function*(){address=yield address;const e=(address=this.formatter.address(address)).substring(2).toLowerCase()+".addr.reverse",t=yield this._getResolver(e);if(!t)return null;let r=Object(d.arrayify)(yield this.call({to:t,data:"0x691f3431"+Object(f.b)(e).substring(2)}));if(r.length<32||!l.a.from(r.slice(0,32)).eq(32))return null;if(r=r.slice(32),r.length<32)return null;const n=l.a.from(r.slice(0,32)).toNumber();if(r=r.slice(32),n>r.length)return null;const o=Object(v.h)(r.slice(0,n));return(yield this.resolveName(o))!=address?null:o}))}perform(e,t){return B.throwError(e+" not implemented",S.b.errors.NOT_IMPLEMENTED,{operation:e})}_startEvent(e){this.polling=this._events.filter((e=>e.pollable())).length>0}_stopEvent(e){this.polling=this._events.filter((e=>e.pollable())).length>0}_addEventListener(e,t,r){const n=new L(U(e),t,r);return this._events.push(n),this._startEvent(n),this}on(e,t){return this._addEventListener(e,t,!1)}once(e,t){return this._addEventListener(e,t,!0)}emit(e,...t){let r=!1,n=[],o=U(e);return this._events=this._events.filter((e=>e.tag!==o||(setTimeout((()=>{e.listener.apply(this,t)}),0),r=!0,!e.once||(n.push(e),!1)))),n.forEach((e=>{this._stopEvent(e)})),r}listenerCount(e){if(!e)return this._events.length;let t=U(e);return this._events.filter((e=>e.tag===t)).length}listeners(e){if(null==e)return this._events.map((e=>e.listener));let t=U(e);return this._events.filter((e=>e.tag===t)).map((e=>e.listener))}off(e,t){if(null==t)return this.removeAllListeners(e);const r=[];let n=!1,o=U(e);return this._events=this._events.filter((e=>e.tag!==o||e.listener!=t||(!!n||(n=!0,r.push(e),!1)))),r.forEach((e=>{this._stopEvent(e)})),this}removeAllListeners(e){let t=[];if(null==e)t=this._events,this._events=[];else{const r=U(e);this._events=this._events.filter((e=>e.tag!==r||(t.push(e),!1)))}return t.forEach((e=>{this._stopEvent(e)})),this}}var Q=r(397),X=r(3177),Z=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const Y=new S.b(I),ee=["call","estimateGas"];function te(e,t,r){if("call"===e&&t.code===S.b.errors.SERVER_ERROR){const e=t.error;if(e&&e.message.match("reverted")&&Object(d.isHexString)(e.data))return e.data}let n=t.message;t.code===S.b.errors.SERVER_ERROR&&t.error&&"string"==typeof t.error.message?n=t.error.message:"string"==typeof t.body?n=t.body:"string"==typeof t.responseText&&(n=t.responseText),n=(n||"").toLowerCase();const o=r.transaction||r.signedTransaction;throw n.match(/insufficient funds/)&&Y.throwError("insufficient funds for intrinsic transaction cost",S.b.errors.INSUFFICIENT_FUNDS,{error:t,method:e,transaction:o}),n.match(/nonce too low/)&&Y.throwError("nonce has already been used",S.b.errors.NONCE_EXPIRED,{error:t,method:e,transaction:o}),n.match(/replacement transaction underpriced/)&&Y.throwError("replacement fee too low",S.b.errors.REPLACEMENT_UNDERPRICED,{error:t,method:e,transaction:o}),ee.indexOf(e)>=0&&n.match(/gas required exceeds allowance|always failing transaction|execution reverted/)&&Y.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",S.b.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,method:e,transaction:o}),t}function re(e){return new Promise((function(t){setTimeout(t,e)}))}function ne(e){if(e.error){const t=new Error(e.error.message);throw t.code=e.error.code,t.data=e.error.data,t}return e.result}function se(e){return e?e.toLowerCase():e}const ie={};class oe extends Q.Signer{constructor(e,t,r){if(Y.checkNew(new.target,oe),super(),e!==ie)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");Object(m.d)(this,"provider",t),null==r&&(r=0),"string"==typeof r?(Object(m.d)(this,"_address",this.provider.formatter.address(r)),Object(m.d)(this,"_index",null)):"number"==typeof r?(Object(m.d)(this,"_index",r),Object(m.d)(this,"_address",null)):Y.throwArgumentError("invalid address or index","addressOrIndex",r)}connect(e){return Y.throwError("cannot alter JSON-RPC Signer connection",S.b.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new ae(ie,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then((e=>(e.length<=this._index&&Y.throwError("unknown account #"+this._index,S.b.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(e[this._index]))))}sendUncheckedTransaction(e){e=Object(m.g)(e);const t=this.getAddress().then((address=>(address&&(address=address.toLowerCase()),address)));if(null==e.gasLimit){const r=Object(m.g)(e);r.from=t,e.gasLimit=this.provider.estimateGas(r)}return Object(m.f)({tx:Object(m.f)(e),sender:t}).then((({tx:t,sender:r})=>{null!=t.from?t.from.toLowerCase()!==r&&Y.throwArgumentError("from address mismatch","transaction",e):t.from=r;const n=this.provider.constructor.hexlifyTransaction(t,{from:!0});return this.provider.send("eth_sendTransaction",[n]).then((e=>e),(e=>te("sendTransaction",e,n)))}))}signTransaction(e){return Y.throwError("signing transactions is unsupported",S.b.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(e){return this.sendUncheckedTransaction(e).then((e=>Object(T.poll)((()=>this.provider.getTransaction(e).then((t=>{if(null!==t)return this.provider._wrapTransaction(t,e)}))),{onceBlock:this.provider}).catch((t=>{throw t.transactionHash=e,t}))))}signMessage(e){return Z(this,void 0,void 0,(function*(){const data="string"==typeof e?Object(v.f)(e):e,address=yield this.getAddress();return yield this.provider.send("eth_sign",[address.toLowerCase(),Object(d.hexlify)(data)])}))}_signTypedData(e,t,r){return Z(this,void 0,void 0,(function*(){const n=yield X.a.resolveNames(e,t,r,(e=>this.provider.resolveName(e))),address=yield this.getAddress();return yield this.provider.send("eth_signTypedData_v4",[address.toLowerCase(),JSON.stringify(X.a.getPayload(n.domain,t,n.value))])}))}unlock(e){return Z(this,void 0,void 0,(function*(){const t=this.provider,address=yield this.getAddress();return t.send("personal_unlockAccount",[address.toLowerCase(),e,null])}))}}class ae extends oe{sendTransaction(e){return this.sendUncheckedTransaction(e).then((e=>({hash:e,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:t=>this.provider.waitForTransaction(e,t)})))}}const ce={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0};class le extends z{constructor(e,t){Y.checkNew(new.target,le);let r=t;null==r&&(r=new Promise(((e,t)=>{setTimeout((()=>{this.detectNetwork().then((t=>{e(t)}),(e=>{t(e)}))}),0)}))),super(r),e||(e=Object(m.e)(this.constructor,"defaultUrl")()),"string"==typeof e?Object(m.d)(this,"connection",Object.freeze({url:e})):Object(m.d)(this,"connection",Object.freeze(Object(m.g)(e))),this._nextId=42}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return Z(this,void 0,void 0,(function*(){yield re(0);let e=null;try{e=yield this.send("eth_chainId",[])}catch(t){try{e=yield this.send("net_version",[])}catch(e){}}if(null!=e){const t=Object(m.e)(this.constructor,"getNetwork");try{return t(l.a.from(e).toNumber())}catch(t){return Y.throwError("could not detect network",S.b.errors.NETWORK_ERROR,{chainId:e,event:"invalidNetwork",serverError:t})}}return Y.throwError("could not detect network",S.b.errors.NETWORK_ERROR,{event:"noNetwork"})}))}getSigner(e){return new oe(ie,this,e)}getUncheckedSigner(e){return this.getSigner(e).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then((e=>e.map((a=>this.formatter.address(a)))))}send(e,t){const r={method:e,params:t,id:this._nextId++,jsonrpc:"2.0"};return this.emit("debug",{action:"request",request:Object(m.c)(r),provider:this}),Object(T.fetchJson)(this.connection,JSON.stringify(r),ne).then((e=>(this.emit("debug",{action:"response",request:r,response:e,provider:this}),e)),(e=>{throw this.emit("debug",{action:"response",error:e,request:r,provider:this}),e}))}prepareRequest(e,t){switch(e){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[se(t.address),t.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[se(t.address),t.blockTag]];case"getCode":return["eth_getCode",[se(t.address),t.blockTag]];case"getStorageAt":return["eth_getStorageAt",[se(t.address),t.position,t.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[t.signedTransaction]];case"getBlock":return t.blockTag?["eth_getBlockByNumber",[t.blockTag,!!t.includeTransactions]]:t.blockHash?["eth_getBlockByHash",[t.blockHash,!!t.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[t.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[t.transactionHash]];case"call":return["eth_call",[Object(m.e)(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0}),t.blockTag]];case"estimateGas":return["eth_estimateGas",[Object(m.e)(this.constructor,"hexlifyTransaction")(t.transaction,{from:!0})]];case"getLogs":return t.filter&&null!=t.filter.address&&(t.filter.address=se(t.filter.address)),["eth_getLogs",[t.filter]]}return null}perform(e,t){return Z(this,void 0,void 0,(function*(){const r=this.prepareRequest(e,t);null==r&&Y.throwError(e+" not implemented",S.b.errors.NOT_IMPLEMENTED,{operation:e});try{return yield this.send(r[0],r[1])}catch(r){return te(e,r,t)}}))}_startEvent(e){"pending"===e.tag&&this._startPending(),super._startEvent(e)}_startPending(){if(null!=this._pendingFilter)return;const e=this,t=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=t,t.then((function(r){return function n(){e.send("eth_getFilterChanges",[r]).then((function(r){if(e._pendingFilter!=t)return null;let n=Promise.resolve();return r.forEach((function(t){e._emitted["t:"+t.toLowerCase()]="pending",n=n.then((function(){return e.getTransaction(t).then((function(t){return e.emit("pending",t),null}))}))})),n.then((function(){return re(1e3)}))})).then((function(){if(e._pendingFilter==t)return setTimeout((function(){n()}),0),null;e.send("eth_uninstallFilter",[r])})).catch((e=>{}))}(),r})).catch((e=>{}))}_stopEvent(e){"pending"===e.tag&&0===this.listenerCount("pending")&&(this._pendingFilter=null),super._stopEvent(e)}static hexlifyTransaction(e,t){const r=Object(m.g)(ce);if(t)for(const e in t)t[e]&&(r[e]=!0);Object(m.b)(e,r);const n={};return["gasLimit","gasPrice","nonce","value"].forEach((function(t){if(null==e[t])return;const r=Object(d.hexValue)(e[t]);"gasLimit"===t&&(t="gas"),n[t]=r})),["from","to","data"].forEach((function(t){null!=e[t]&&(n[t]=Object(d.hexlify)(e[t]))})),n}}let ue=null;try{if(ue=WebSocket,null==ue)throw new Error("inject please")}catch(e){const t=new S.b(I);ue=function(){t.throwError("WebSockets not supported in this environment",S.b.errors.UNSUPPORTED_OPERATION,{operation:"new WebSocket()"})}}var de=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const he=new S.b(I);let fe=1;class me extends le{constructor(e,t){"any"===t&&he.throwError("WebSocketProvider does not support 'any' network yet",S.b.errors.UNSUPPORTED_OPERATION,{operation:"network:any"}),super(e,t),this._pollingInterval=-1,this._wsReady=!1,Object(m.d)(this,"_websocket",new ue(this.connection.url)),Object(m.d)(this,"_requests",{}),Object(m.d)(this,"_subs",{}),Object(m.d)(this,"_subIds",{}),Object(m.d)(this,"_detectNetwork",super.detectNetwork()),this._websocket.onopen=()=>{this._wsReady=!0,Object.keys(this._requests).forEach((e=>{this._websocket.send(this._requests[e].payload)}))},this._websocket.onmessage=e=>{const data=e.data,t=JSON.parse(data);if(null!=t.id){const e=String(t.id),r=this._requests[e];if(delete this._requests[e],void 0!==t.result)r.callback(null,t.result),this.emit("debug",{action:"response",request:JSON.parse(r.payload),response:t.result,provider:this});else{let e=null;t.error?(e=new Error(t.error.message||"unknown error"),Object(m.d)(e,"code",t.error.code||null),Object(m.d)(e,"response",data)):e=new Error("unknown error"),r.callback(e,void 0),this.emit("debug",{action:"response",error:e,request:JSON.parse(r.payload),provider:this})}}else if("eth_subscription"===t.method){const sub=this._subs[t.params.subscription];sub&&sub.processFunc(t.params.result)}else console.warn("this should not happen")};const r=setInterval((()=>{this.emit("poll")}),1e3);r.unref&&r.unref()}detectNetwork(){return this._detectNetwork}get pollingInterval(){return 0}resetEventsBlock(e){he.throwError("cannot reset events block on WebSocketProvider",S.b.errors.UNSUPPORTED_OPERATION,{operation:"resetEventBlock"})}set pollingInterval(e){he.throwError("cannot set polling interval on WebSocketProvider",S.b.errors.UNSUPPORTED_OPERATION,{operation:"setPollingInterval"})}poll(){return de(this,void 0,void 0,(function*(){return null}))}set polling(e){e&&he.throwError("cannot set polling on WebSocketProvider",S.b.errors.UNSUPPORTED_OPERATION,{operation:"setPolling"})}send(e,t){const r=fe++;return new Promise(((n,o)=>{const c=JSON.stringify({method:e,params:t,id:r,jsonrpc:"2.0"});this.emit("debug",{action:"request",request:JSON.parse(c),provider:this}),this._requests[String(r)]={callback:function(e,t){return e?o(e):n(t)},payload:c},this._wsReady&&this._websocket.send(c)}))}static defaultUrl(){return"ws://localhost:8546"}_subscribe(e,param,t){return de(this,void 0,void 0,(function*(){let r=this._subIds[e];null==r&&(r=Promise.all(param).then((param=>this.send("eth_subscribe",param))),this._subIds[e]=r);const n=yield r;this._subs[n]={tag:e,processFunc:t}}))}_startEvent(e){switch(e.type){case"block":this._subscribe("block",["newHeads"],(e=>{const t=l.a.from(e.number).toNumber();this._emitted.block=t,this.emit("block",t)}));break;case"pending":this._subscribe("pending",["newPendingTransactions"],(e=>{this.emit("pending",e)}));break;case"filter":this._subscribe(e.tag,["logs",this._getFilter(e.filter)],(t=>{null==t.removed&&(t.removed=!1),this.emit(e.filter,this.formatter.filterLog(t))}));break;case"tx":{const t=e=>{const t=e.hash;this.getTransactionReceipt(t).then((e=>{e&&this.emit(t,e)}))};t(e),this._subscribe("tx",["newHeads"],(e=>{this._events.filter((e=>"tx"===e.type)).forEach(t)}));break}case"debug":case"poll":case"willPoll":case"didPoll":case"error":break;default:console.log("unhandled:",e)}}_stopEvent(e){let t=e.tag;if("tx"===e.type){if(this._events.filter((e=>"tx"===e.type)).length)return;t="tx"}else if(this.listenerCount(e.event))return;const r=this._subIds[t];r&&(delete this._subIds[t],r.then((e=>{this._subs[e]&&(delete this._subs[e],this.send("eth_unsubscribe",[e]))})))}destroy(){return de(this,void 0,void 0,(function*(){this._websocket.readyState===ue.CONNECTING&&(yield new Promise((e=>{this._websocket.onopen=function(){e(!0)},this._websocket.onerror=function(){e(!1)}}))),this._websocket.close(1e3)}))}}var pe=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const ge=new S.b(I);class be extends le{detectNetwork(){const e=Object.create(null,{detectNetwork:{get:()=>super.detectNetwork}});return pe(this,void 0,void 0,(function*(){let t=this.network;return null==t&&(t=yield e.detectNetwork.call(this),t||ge.throwError("no network detected",S.b.errors.UNKNOWN_ERROR,{}),null==this._network&&(Object(m.d)(this,"_network",t),this.emit("network",t,null))),t}))}}class ye extends be{constructor(e,t){ge.checkAbstract(new.target,ye),e=Object(m.e)(new.target,"getNetwork")(e),t=Object(m.e)(new.target,"getApiKey")(t);super(Object(m.e)(new.target,"getUrl")(e,t),e),"string"==typeof t?Object(m.d)(this,"apiKey",t):null!=t&&Object.keys(t).forEach((e=>{Object(m.d)(this,e,t[e])}))}_startPending(){ge.warn("WARNING: API provider does not support pending filters")}isCommunityResource(){return!1}getSigner(address){return ge.throwError("API provider does not support signing",S.b.errors.UNSUPPORTED_OPERATION,{operation:"getSigner"})}listAccounts(){return Promise.resolve([])}static getApiKey(e){return e}static getUrl(e,t){return ge.throwError("not implemented; sub-classes must override getUrl",S.b.errors.NOT_IMPLEMENTED,{operation:"getUrl"})}}const ve=new S.b(I),Te="_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC";class we extends me{constructor(e,t){const r=new Ee(e,t);super(r.connection.url.replace(/^http/i,"ws").replace(".alchemyapi.",".ws.alchemyapi."),r.network),Object(m.d)(this,"apiKey",r.apiKey)}isCommunityResource(){return this.apiKey===Te}}class Ee extends ye{static getWebSocketProvider(e,t){return new we(e,t)}static getApiKey(e){return null==e?Te:(e&&"string"!=typeof e&&ve.throwArgumentError("invalid apiKey","apiKey",e),e)}static getUrl(e,t){let r=null;switch(e.name){case"homestead":r="eth-mainnet.alchemyapi.io/v2/";break;case"ropsten":r="eth-ropsten.alchemyapi.io/v2/";break;case"rinkeby":r="eth-rinkeby.alchemyapi.io/v2/";break;case"goerli":r="eth-goerli.alchemyapi.io/v2/";break;case"kovan":r="eth-kovan.alchemyapi.io/v2/";break;default:ve.throwArgumentError("unsupported network","network",arguments[0])}return{allowGzip:!0,url:"https://"+r+t,throttleCallback:(e,r)=>(t===Te&&j(),Promise.resolve(!0))}}isCommunityResource(){return this.apiKey===Te}}var Se=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const Ie=new S.b(I);class ke extends ye{static getApiKey(e){return null!=e&&Ie.throwArgumentError("apiKey not supported for cloudflare","apiKey",e),null}static getUrl(e,t){let r=null;switch(e.name){case"homestead":r="https://cloudflare-eth.com/";break;default:Ie.throwArgumentError("unsupported network","network",arguments[0])}return r}perform(e,t){const r=Object.create(null,{perform:{get:()=>super.perform}});return Se(this,void 0,void 0,(function*(){if("getBlockNumber"===e){return(yield r.perform.call(this,"getBlock",{blockTag:"latest"})).number}return r.perform.call(this,e,t)}))}}var xe=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const Oe=new S.b(I);function Ae(e){const t={};for(let r in e){if(null==e[r])continue;let n=Object(d.hexlify)(e[r]);({gasLimit:!0,gasPrice:!0,nonce:!0,value:!0})[r]&&(n=Object(d.hexValue)(n)),t[r]=n}return t}function _e(e){if(0==e.status&&("No records found"===e.message||"No transactions found"===e.message))return e.result;if(1!=e.status||"OK"!=e.message){const t=new Error("invalid response");throw t.result=JSON.stringify(e),(e.result||"").toLowerCase().indexOf("rate limit")>=0&&(t.throttleRetry=!0),t}return e.result}function Ne(e){if(e&&0==e.status&&"NOTOK"==e.message&&(e.result||"").toLowerCase().indexOf("rate limit")>=0){const t=new Error("throttled response");throw t.result=JSON.stringify(e),t.throttleRetry=!0,t}if("2.0"!=e.jsonrpc){const t=new Error("invalid response");throw t.result=JSON.stringify(e),t}if(e.error){const t=new Error(e.error.message||"unknown error");throw e.error.code&&(t.code=e.error.code),e.error.data&&(t.data=e.error.data),t}return e.result}function Ce(e){if("pending"===e)throw new Error("pending not supported");return"latest"===e?e:parseInt(e.substring(2),16)}const Re="9D13ZE7XSBTJ94N9BNJ2MA33VMAY2YPIRB";function je(e,t,r){if("call"===e&&t.code===S.b.errors.SERVER_ERROR){const e=t.error;if(e&&e.message.match("reverted")&&Object(d.isHexString)(e.data))return e.data}let n=t.message;throw t.code===S.b.errors.SERVER_ERROR&&(t.error&&"string"==typeof t.error.message?n=t.error.message:"string"==typeof t.body?n=t.body:"string"==typeof t.responseText&&(n=t.responseText)),n=(n||"").toLowerCase(),n.match(/insufficient funds/)&&Oe.throwError("insufficient funds for intrinsic transaction cost",S.b.errors.INSUFFICIENT_FUNDS,{error:t,method:e,transaction:r}),n.match(/same hash was already imported|transaction nonce is too low/)&&Oe.throwError("nonce has already been used",S.b.errors.NONCE_EXPIRED,{error:t,method:e,transaction:r}),n.match(/another transaction with same nonce/)&&Oe.throwError("replacement fee too low",S.b.errors.REPLACEMENT_UNDERPRICED,{error:t,method:e,transaction:r}),n.match(/execution failed due to an exception/)&&Oe.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",S.b.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,method:e,transaction:r}),t}class Pe extends z{constructor(e,t){Oe.checkNew(new.target,Pe),super(e);let r="invalid";this.network&&(r=this.network.name);let n=null;switch(r){case"homestead":n="https://api.etherscan.io";break;case"ropsten":n="https://api-ropsten.etherscan.io";break;case"rinkeby":n="https://api-rinkeby.etherscan.io";break;case"kovan":n="https://api-kovan.etherscan.io";break;case"goerli":n="https://api-goerli.etherscan.io";break;default:throw new Error("unsupported network")}Object(m.d)(this,"baseUrl",n),Object(m.d)(this,"apiKey",t||Re)}detectNetwork(){return xe(this,void 0,void 0,(function*(){return this.network}))}perform(e,t){const r=Object.create(null,{perform:{get:()=>super.perform}});return xe(this,void 0,void 0,(function*(){let n=this.baseUrl+"/api",o="";this.apiKey&&(o+="&apikey="+this.apiKey);const c=(e,t,r)=>xe(this,void 0,void 0,(function*(){this.emit("debug",{action:"request",request:e,provider:this});const n={url:e,throttleSlotInterval:1e3,throttleCallback:(e,t)=>(this.isCommunityResource()&&j(),Promise.resolve(!0))};let o=null;t&&(n.headers={"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},o=Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&"));const c=yield Object(T.fetchJson)(n,o,r||Ne);return this.emit("debug",{action:"response",request:e,response:Object(m.c)(c),provider:this}),c}));switch(e){case"getBlockNumber":return n+="?module=proxy&action=eth_blockNumber"+o,c(n,null);case"getGasPrice":return n+="?module=proxy&action=eth_gasPrice"+o,c(n,null);case"getBalance":return n+="?module=account&action=balance&address="+t.address,n+="&tag="+t.blockTag+o,c(n,null,_e);case"getTransactionCount":return n+="?module=proxy&action=eth_getTransactionCount&address="+t.address,n+="&tag="+t.blockTag+o,c(n,null);case"getCode":return n+="?module=proxy&action=eth_getCode&address="+t.address,n+="&tag="+t.blockTag+o,c(n,null);case"getStorageAt":return n+="?module=proxy&action=eth_getStorageAt&address="+t.address,n+="&position="+t.position,n+="&tag="+t.blockTag+o,c(n,null);case"sendTransaction":return c(n,{module:"proxy",action:"eth_sendRawTransaction",hex:t.signedTransaction,apikey:this.apiKey}).catch((e=>je("sendTransaction",e,t.signedTransaction)));case"getBlock":if(t.blockTag)return n+="?module=proxy&action=eth_getBlockByNumber&tag="+t.blockTag,t.includeTransactions?n+="&boolean=true":n+="&boolean=false",n+=o,c(n,null);throw new Error("getBlock by blockHash not implemented");case"getTransaction":return n+="?module=proxy&action=eth_getTransactionByHash&txhash="+t.transactionHash,n+=o,c(n,null);case"getTransactionReceipt":return n+="?module=proxy&action=eth_getTransactionReceipt&txhash="+t.transactionHash,n+=o,c(n,null);case"call":{if("latest"!==t.blockTag)throw new Error("EtherscanProvider does not support blockTag for call");const e=Ae(t.transaction);e.module="proxy",e.action="eth_call",e.apikey=this.apiKey;try{return yield c(n,e)}catch(e){return je("call",e,t.transaction)}}case"estimateGas":{const e=Ae(t.transaction);e.module="proxy",e.action="eth_estimateGas",e.apikey=this.apiKey;try{return yield c(n,e)}catch(e){return je("estimateGas",e,t.transaction)}}case"getLogs":{if(n+="?module=logs&action=getLogs",t.filter.fromBlock&&(n+="&fromBlock="+Ce(t.filter.fromBlock)),t.filter.toBlock&&(n+="&toBlock="+Ce(t.filter.toBlock)),t.filter.address&&(n+="&address="+t.filter.address),t.filter.topics&&t.filter.topics.length>0&&(t.filter.topics.length>1&&Oe.throwError("unsupported topic count",S.b.errors.UNSUPPORTED_OPERATION,{topics:t.filter.topics}),1===t.filter.topics.length)){const e=t.filter.topics[0];"string"==typeof e&&66===e.length||Oe.throwError("unsupported topic format",S.b.errors.UNSUPPORTED_OPERATION,{topic0:e}),n+="&topic0="+e}n+=o;const e=yield c(n,null,_e);let r={};for(let i=0;i<e.length;i++){const t=e[i];if(null==t.blockHash){if(null==r[t.blockNumber]){const e=yield this.getBlock(t.blockNumber);e&&(r[t.blockNumber]=e.hash)}t.blockHash=r[t.blockNumber]}}return e}case"getEtherPrice":return"homestead"!==this.network.name?0:(n+="?module=stats&action=ethprice",n+=o,parseFloat((yield c(n,null,_e)).ethusd))}return r.perform.call(this,e,t)}))}getHistory(e,t,r){let n=this.baseUrl,o="";return this.apiKey&&(o+="&apikey="+this.apiKey),null==t&&(t=0),null==r&&(r=99999999),this.resolveName(e).then((address=>{n+="/api?module=account&action=txlist&address="+address,n+="&startblock="+t,n+="&endblock="+r,n+="&sort=asc"+o,this.emit("debug",{action:"request",request:n,provider:this});const e={url:n,throttleSlotInterval:1e3,throttleCallback:(e,t)=>(this.apiKey===Re&&j(),Promise.resolve(!0))};return Object(T.fetchJson)(e,null,_e).then((e=>{this.emit("debug",{action:"response",request:n,response:Object(m.c)(e),provider:this});let output=[];return e.forEach((e=>{["contractAddress","to"].forEach((function(t){""==e[t]&&delete e[t]})),null==e.creates&&null!=e.contractAddress&&(e.creates=e.contractAddress);let t=this.formatter.transactionResponse(e);e.timeStamp&&(t.timestamp=parseInt(e.timeStamp)),output.push(t)})),output}))}))}isCommunityResource(){return this.apiKey===Re}}var Be=r(933),De=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const Fe=new S.b(I);function Ue(){return(new Date).getTime()}function Me(e){let t=null;for(let i=0;i<e.length;i++){const r=e[i];if(null==r)return null;t?t.name===r.name&&t.chainId===r.chainId&&(t.ensAddress===r.ensAddress||null==t.ensAddress&&null==r.ensAddress)||Fe.throwArgumentError("provider mismatch","networks",e):t=r}return t}function He(e,t){e=e.slice().sort();const r=Math.floor(e.length/2);if(e.length%2)return e[r];const a=e[r-1],b=e[r];return null!=t&&Math.abs(a-b)>t?null:(a+b)/2}function Le(e){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return JSON.stringify(e);if("string"==typeof e)return e;if(l.a.isBigNumber(e))return e.toString();if(Array.isArray(e))return JSON.stringify(e.map((i=>Le(i))));if("object"==typeof e){const t=Object.keys(e);return t.sort(),"{"+t.map((t=>{let r=e[t];return r="function"==typeof r?"[function]":Le(r),JSON.stringify(t)+":"+r})).join(",")+"}"}throw new Error("unknown value type: "+typeof e)}let qe=1;function We(e){let t=null,r=null,n=new Promise((n=>{t=function(){r&&(clearTimeout(r),r=null),n()},r=setTimeout(t,e)}));return{cancel:t,getPromise:function(){return n},wait:e=>(n=n.then(e),n)}}const $e=[S.b.errors.CALL_EXCEPTION,S.b.errors.INSUFFICIENT_FUNDS,S.b.errors.NONCE_EXPIRED,S.b.errors.REPLACEMENT_UNDERPRICED,S.b.errors.UNPREDICTABLE_GAS_LIMIT],Ge=["address","args","errorArgs","errorSignature","method","transaction"];function Ve(e,t){const r={weight:e.weight};return Object.defineProperty(r,"provider",{get:()=>e.provider}),e.start&&(r.start=e.start),t&&(r.duration=t-e.start),e.done&&(e.error?r.error=e.error:r.result=e.result||null),r}function Ke(e,t,r){let n=Le;switch(t){case"getBlockNumber":return function(t){const r=t.map((e=>e.result));let n=He(t.map((e=>e.result)),2);if(null!=n)return n=Math.ceil(n),r.indexOf(n+1)>=0&&n++,n>=e._highestBlockNumber&&(e._highestBlockNumber=n),e._highestBlockNumber};case"getGasPrice":return function(e){const t=e.map((e=>e.result));return t.sort(),t[Math.floor(t.length/2)]};case"getEtherPrice":return function(e){return He(e.map((e=>e.result)))};case"getBalance":case"getTransactionCount":case"getCode":case"getStorageAt":case"call":case"estimateGas":case"getLogs":break;case"getTransaction":case"getTransactionReceipt":n=function(e){return null==e?null:((e=Object(m.g)(e)).confirmations=-1,Le(e))};break;case"getBlock":n=r.includeTransactions?function(e){return null==e?null:((e=Object(m.g)(e)).transactions=e.transactions.map((e=>((e=Object(m.g)(e)).confirmations=-1,e))),Le(e))}:function(e){return null==e?null:Le(e)};break;default:throw new Error("unknown method: "+t)}return function(e,t){return function(r){const n={};r.forEach((t=>{const r=e(t.result);n[r]||(n[r]={count:0,result:t.result}),n[r].count++}));const o=Object.keys(n);for(let i=0;i<o.length;i++){const e=n[o[i]];if(e.count>=t)return e.result}}}(n,e.quorum)}function Je(e,t){return De(this,void 0,void 0,(function*(){const r=e.provider;return null!=r.blockNumber&&r.blockNumber>=t||-1===t?r:Object(T.poll)((()=>new Promise(((n,o)=>{setTimeout((function(){return r.blockNumber>=t?n(r):e.cancelled?n(null):n(void 0)}),0)}))),{oncePoll:r})}))}function ze(e,t,r,n){return De(this,void 0,void 0,(function*(){let o=e.provider;switch(r){case"getBlockNumber":case"getGasPrice":return o[r]();case"getEtherPrice":if(o.getEtherPrice)return o.getEtherPrice();break;case"getBalance":case"getTransactionCount":case"getCode":return n.blockTag&&Object(d.isHexString)(n.blockTag)&&(o=yield Je(e,t)),o[r](n.address,n.blockTag||"latest");case"getStorageAt":return n.blockTag&&Object(d.isHexString)(n.blockTag)&&(o=yield Je(e,t)),o.getStorageAt(n.address,n.position,n.blockTag||"latest");case"getBlock":return n.blockTag&&Object(d.isHexString)(n.blockTag)&&(o=yield Je(e,t)),o[n.includeTransactions?"getBlockWithTransactions":"getBlock"](n.blockTag||n.blockHash);case"call":case"estimateGas":return n.blockTag&&Object(d.isHexString)(n.blockTag)&&(o=yield Je(e,t)),o[r](n.transaction);case"getTransaction":case"getTransactionReceipt":return o[r](n.transactionHash);case"getLogs":{let filter=n.filter;return(filter.fromBlock&&Object(d.isHexString)(filter.fromBlock)||filter.toBlock&&Object(d.isHexString)(filter.toBlock))&&(o=yield Je(e,t)),o.getLogs(filter)}}return Fe.throwError("unknown method error",S.b.errors.UNKNOWN_ERROR,{method:r,params:n})}))}class Qe extends z{constructor(e,t){Fe.checkNew(new.target,Qe),0===e.length&&Fe.throwArgumentError("missing providers","providers",e);const r=e.map(((e,t)=>{if(n.b.isProvider(e)){const t=C(e)?2e3:750,r=1;return Object.freeze({provider:e,weight:1,stallTimeout:t,priority:r})}const r=Object(m.g)(e);null==r.priority&&(r.priority=1),null==r.stallTimeout&&(r.stallTimeout=C(e)?2e3:750),null==r.weight&&(r.weight=1);const o=r.weight;return(o%1||o>512||o<1)&&Fe.throwArgumentError("invalid weight; must be integer in [1, 512]",`providers[${t}].weight`,o),Object.freeze(r)})),o=r.reduce(((e,t)=>e+t.weight),0);null==t?t=o/2:t>o&&Fe.throwArgumentError("quorum will always fail; larger than total weight","quorum",t);let c=Me(r.map((e=>e.provider.network)));null==c&&(c=new Promise(((e,t)=>{setTimeout((()=>{this.detectNetwork().then(e,t)}),0)}))),super(c),Object(m.d)(this,"providerConfigs",Object.freeze(r)),Object(m.d)(this,"quorum",t),this._highestBlockNumber=-1}detectNetwork(){return De(this,void 0,void 0,(function*(){return Me(yield Promise.all(this.providerConfigs.map((e=>e.provider.getNetwork()))))}))}perform(e,t){return De(this,void 0,void 0,(function*(){if("sendTransaction"===e){const e=yield Promise.all(this.providerConfigs.map((e=>e.provider.sendTransaction(t.signedTransaction).then((e=>e.hash),(e=>e)))));for(let i=0;i<e.length;i++){const t=e[i];if("string"==typeof t)return t}throw e[0]}-1===this._highestBlockNumber&&"getBlockNumber"!==e&&(yield this.getBlockNumber());const r=Ke(this,e,t),n=Object(Be.a)(this.providerConfigs.map(m.g));n.sort(((a,b)=>a.priority-b.priority));const o=this._highestBlockNumber;let i=0,c=!0;for(;;){const l=Ue();let d=n.filter((e=>e.runner&&l-e.start<e.stallTimeout)).reduce(((e,t)=>e+t.weight),0);for(;d<this.quorum&&i<n.length;){const r=n[i++],c=qe++;r.start=Ue(),r.staller=We(r.stallTimeout),r.staller.wait((()=>{r.staller=null})),r.runner=ze(r,o,e,t).then((n=>{r.done=!0,r.result=n,this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:c,backend:Ve(r,Ue()),request:{method:e,params:Object(m.c)(t)},provider:this})}),(n=>{r.done=!0,r.error=n,this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:c,backend:Ve(r,Ue()),request:{method:e,params:Object(m.c)(t)},provider:this})})),this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:c,backend:Ve(r,null),request:{method:e,params:Object(m.c)(t)},provider:this}),d+=r.weight}const h=[];n.forEach((e=>{!e.done&&e.runner&&(h.push(e.runner),e.staller&&h.push(e.staller.getPromise()))})),h.length&&(yield Promise.race(h));const f=n.filter((e=>e.done&&null==e.error));if(f.length>=this.quorum){const e=r(f);if(void 0!==e)return n.forEach((e=>{e.staller&&e.staller.cancel(),e.cancelled=!0})),e;c||(yield We(100).getPromise()),c=!1}const y=n.reduce(((e,t)=>{if(!t.done||null==t.error)return e;const code=t.error.code;return $e.indexOf(code)>=0&&(e[code]||(e[code]={error:t.error,weight:0}),e[code].weight+=t.weight),e}),{});if(Object.keys(y).forEach((e=>{const t=y[e];if(t.weight<this.quorum)return;n.forEach((e=>{e.staller&&e.staller.cancel(),e.cancelled=!0}));const r=t.error,o={};Ge.forEach((e=>{null!=r[e]&&(o[e]=r[e])})),Fe.throwError(r.reason||r.message,e,o)})),0===n.filter((e=>!e.done)).length)break}return n.forEach((e=>{e.staller&&e.staller.cancel(),e.cancelled=!0})),Fe.throwError("failed to meet quorum",S.b.errors.SERVER_ERROR,{method:e,params:t,results:n.map((e=>Ve(e))),provider:this})}))}}const Xe=null,Ze=new S.b(I),Ye="84842078b09946638c03157f83405213";class et extends me{constructor(e,t){const r=new tt(e,t),n=r.connection;n.password&&Ze.throwError("INFURA WebSocket project secrets unsupported",S.b.errors.UNSUPPORTED_OPERATION,{operation:"InfuraProvider.getWebSocketProvider()"});super(n.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/"),e),Object(m.d)(this,"apiKey",r.projectId),Object(m.d)(this,"projectId",r.projectId),Object(m.d)(this,"projectSecret",r.projectSecret)}isCommunityResource(){return this.projectId===Ye}}class tt extends ye{static getWebSocketProvider(e,t){return new et(e,t)}static getApiKey(e){const t={apiKey:Ye,projectId:Ye,projectSecret:null};return null==e||("string"==typeof e?t.projectId=e:null!=e.projectSecret?(Ze.assertArgument("string"==typeof e.projectId,"projectSecret requires a projectId","projectId",e.projectId),Ze.assertArgument("string"==typeof e.projectSecret,"invalid projectSecret","projectSecret","[REDACTED]"),t.projectId=e.projectId,t.projectSecret=e.projectSecret):e.projectId&&(t.projectId=e.projectId),t.apiKey=t.projectId),t}static getUrl(e,t){let r=null;switch(e?e.name:"unknown"){case"homestead":r="mainnet.infura.io";break;case"ropsten":r="ropsten.infura.io";break;case"rinkeby":r="rinkeby.infura.io";break;case"kovan":r="kovan.infura.io";break;case"goerli":r="goerli.infura.io";break;default:Ze.throwError("unsupported network",S.b.errors.INVALID_ARGUMENT,{argument:"network",value:e})}const n={allowGzip:!0,url:"https://"+r+"/v3/"+t.projectId,throttleCallback:(e,r)=>(t.projectId===Ye&&j(),Promise.resolve(!0))};return null!=t.projectSecret&&(n.user="",n.password=t.projectSecret),n}isCommunityResource(){return this.projectId===Ye}}const nt=new S.b(I);class st extends ye{static getApiKey(e){return e&&"string"!=typeof e&&nt.throwArgumentError("invalid apiKey","apiKey",e),e||"ETHERS_JS_SHARED"}static getUrl(e,t){nt.warn("NodeSmith will be discontinued on 2019-12-20; please migrate to another platform.");let r=null;switch(e.name){case"homestead":r="https://ethereum.api.nodesmith.io/v1/mainnet/jsonrpc";break;case"ropsten":r="https://ethereum.api.nodesmith.io/v1/ropsten/jsonrpc";break;case"rinkeby":r="https://ethereum.api.nodesmith.io/v1/rinkeby/jsonrpc";break;case"goerli":r="https://ethereum.api.nodesmith.io/v1/goerli/jsonrpc";break;case"kovan":r="https://ethereum.api.nodesmith.io/v1/kovan/jsonrpc";break;default:nt.throwArgumentError("unsupported network","network",arguments[0])}return r+"?apiKey="+t}}const it=new S.b(I),ot={homestead:"6004bcd10040261633ade990",ropsten:"6004bd4d0040261633ade991",rinkeby:"6004bda20040261633ade994",goerli:"6004bd860040261633ade992"};class at extends ye{constructor(e,t){if(null==t){const r=Object(m.e)(new.target,"getNetwork")(e);if(r){const e=ot[r.name];e&&(t={applicationId:e,loadBalancer:!0})}null==t&&it.throwError("unsupported network",S.b.errors.INVALID_ARGUMENT,{argument:"network",value:e})}super(e,t)}static getApiKey(e){null==e&&it.throwArgumentError("PocketProvider.getApiKey does not support null apiKey","apiKey",e);const t={applicationId:null,loadBalancer:!1,applicationSecretKey:null};return"string"==typeof e?t.applicationId=e:null!=e.applicationSecretKey?(it.assertArgument("string"==typeof e.applicationId,"applicationSecretKey requires an applicationId","applicationId",e.applicationId),it.assertArgument("string"==typeof e.applicationSecretKey,"invalid applicationSecretKey","applicationSecretKey","[REDACTED]"),t.applicationId=e.applicationId,t.applicationSecretKey=e.applicationSecretKey,t.loadBalancer=!!e.loadBalancer):e.applicationId?(it.assertArgument("string"==typeof e.applicationId,"apiKey.applicationId must be a string","apiKey.applicationId",e.applicationId),t.applicationId=e.applicationId,t.loadBalancer=!!e.loadBalancer):it.throwArgumentError("unsupported PocketProvider apiKey","apiKey",e),t}static getUrl(e,t){let r=null;switch(e?e.name:"unknown"){case"homestead":r="eth-mainnet.gateway.pokt.network";break;case"ropsten":r="eth-ropsten.gateway.pokt.network";break;case"rinkeby":r="eth-rinkeby.gateway.pokt.network";break;case"goerli":r="eth-goerli.gateway.pokt.network";break;default:it.throwError("unsupported network",S.b.errors.INVALID_ARGUMENT,{argument:"network",value:e})}let n=null;n=t.loadBalancer?`https://${r}/v1/lb/${t.applicationId}`:`https://${r}/v1/${t.applicationId}`;const o={url:n,headers:{}};return null!=t.applicationSecretKey&&(o.user="",o.password=t.applicationSecretKey),o}isCommunityResource(){return this.applicationId===ot[this.network.name]}}const ct=new S.b(I);let lt=1;function ut(e,t){return function(r,n){"eth_sign"==r&&(e.isMetaMask||e.isStatus)&&(r="personal_sign",n=[n[1],n[0]]);const o={method:r,params:n,id:lt++,jsonrpc:"2.0"};return new Promise(((e,r)=>{t(o,(function(t,n){if(t)return r(t);if(n.error){const e=new Error(n.error.message);return e.code=n.error.code,e.data=n.error.data,r(e)}e(n.result)}))}))}}class ht extends le{constructor(e,t){ct.checkNew(new.target,ht),null==e&&ct.throwArgumentError("missing provider","provider",e);let path=null,r=null,n=null;"function"==typeof e?(path="unknown:",r=e):(path=e.host||e.path||"",!path&&e.isMetaMask&&(path="metamask"),n=e,e.request?(""===path&&(path="eip-1193:"),r=function(e){return function(t,r){return null==r&&(r=[]),"eth_sign"==t&&(e.isMetaMask||e.isStatus)&&(t="personal_sign",r=[r[1],r[0]]),e.request({method:t,params:r})}}(e)):e.sendAsync?r=ut(e,e.sendAsync.bind(e)):e.send?r=ut(e,e.send.bind(e)):ct.throwArgumentError("unsupported provider","provider",e),path||(path="unknown:")),super(path,t),Object(m.d)(this,"jsonRpcFetchFunc",r),Object(m.d)(this,"provider",n)}send(e,t){return this.jsonRpcFetchFunc(e,t)}}const ft=new S.b(I);function mt(e,t){if(null==e&&(e="homestead"),"string"==typeof e){const t=e.match(/^(ws|http)s?:/i);if(t)switch(t[1]){case"http":return new le(e);case"ws":return new me(e);default:ft.throwArgumentError("unsupported URL scheme","network",e)}}const r=Object(o.a)(e);return r&&r._defaultProvider||ft.throwError("unsupported getDefaultProvider network",S.b.errors.NETWORK_ERROR,{operation:"getDefaultProvider",network:e}),r._defaultProvider({FallbackProvider:Qe,AlchemyProvider:Ee,CloudflareProvider:ke,EtherscanProvider:Pe,InfuraProvider:tt,JsonRpcProvider:le,NodesmithProvider:st,PocketProvider:at,Web3Provider:ht,IpcProvider:Xe},t)}},1062:function(e,t,r){"use strict";r.r(t),r.d(t,"ConstructorFragment",(function(){return _})),r.d(t,"EventFragment",(function(){return k})),r.d(t,"Fragment",(function(){return I})),r.d(t,"FunctionFragment",(function(){return N})),r.d(t,"ParamType",(function(){return E})),r.d(t,"FormatTypes",(function(){return T})),r.d(t,"AbiCoder",(function(){return ce})),r.d(t,"defaultAbiCoder",(function(){return le})),r.d(t,"Interface",(function(){return be})),r.d(t,"Indexed",(function(){return pe})),r.d(t,"checkResultErrors",(function(){return F})),r.d(t,"LogDescription",(function(){return fe})),r.d(t,"TransactionDescription",(function(){return me}));var n=r(91),o=r(0),c=r(2);const l="abi/5.0.12",d=new c.b(l),h={};let f={calldata:!0,memory:!0,storage:!0},m={calldata:!0,memory:!0};function y(e,t){if("bytes"===e||"string"===e){if(f[t])return!0}else if("address"===e){if("payable"===t)return!0}else if((e.indexOf("[")>=0||"tuple"===e)&&m[t])return!0;return(f[t]||"payable"===t)&&d.throwArgumentError("invalid modifier","name",t),!1}function v(object,e){for(let t in e)Object(o.d)(object,t,e[t])}const T=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),w=new RegExp(/^(.*)\[([0-9]*)\]$/);class E{constructor(e,t){e!==h&&d.throwError("use fromString",c.b.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),v(this,t);let r=this.type.match(w);v(this,r?{arrayLength:parseInt(r[2]||"-1"),arrayChildren:E.fromObject({type:r[1],components:this.components}),baseType:"array"}:{arrayLength:null,arrayChildren:null,baseType:null!=this.components?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=T.sighash),T[e]||d.throwArgumentError("invalid format type","format",e),e===T.json){let t={type:"tuple"===this.baseType?"tuple":this.type,name:this.name||void 0};return"boolean"==typeof this.indexed&&(t.indexed=this.indexed),this.components&&(t.components=this.components.map((t=>JSON.parse(t.format(e))))),JSON.stringify(t)}let t="";return"array"===this.baseType?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):"tuple"===this.baseType?(e!==T.sighash&&(t+=this.type),t+="("+this.components.map((t=>t.format(e))).join(e===T.full?", ":",")+")"):t+=this.type,e!==T.sighash&&(!0===this.indexed&&(t+=" indexed"),e===T.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return"string"==typeof e?E.fromString(e,t):E.fromObject(e)}static fromObject(e){return E.isParamType(e)?e:new E(h,{name:e.name||null,type:C(e.type),indexed:null==e.indexed?null:!!e.indexed,components:e.components?e.components.map(E.fromObject):null})}static fromString(e,t){return r=function(param,e){let t=param;function r(i){d.throwArgumentError(`unexpected character at position ${i}`,"param",param)}function n(t){let r={type:"",name:"",parent:t,state:{allowType:!0}};return e&&(r.indexed=!1),r}param=param.replace(/\s/g," ");let o={type:"",name:"",state:{allowType:!0}},c=o;for(let i=0;i<param.length;i++){let t=param[i];switch(t){case"(":c.state.allowType&&""===c.type?c.type="tuple":c.state.allowParams||r(i),c.state.allowType=!1,c.type=C(c.type),c.components=[n(c)],c=c.components[0];break;case")":delete c.state,"indexed"===c.name&&(e||r(i),c.indexed=!0,c.name=""),y(c.type,c.name)&&(c.name=""),c.type=C(c.type);let o=c;c=c.parent,c||r(i),delete o.parent,c.state.allowParams=!1,c.state.allowName=!0,c.state.allowArray=!0;break;case",":delete c.state,"indexed"===c.name&&(e||r(i),c.indexed=!0,c.name=""),y(c.type,c.name)&&(c.name=""),c.type=C(c.type);let l=n(c.parent);c.parent.components.push(l),delete c.parent,c=l;break;case" ":c.state.allowType&&""!==c.type&&(c.type=C(c.type),delete c.state.allowType,c.state.allowName=!0,c.state.allowParams=!0),c.state.allowName&&""!==c.name&&("indexed"===c.name?(e||r(i),c.indexed&&r(i),c.indexed=!0,c.name=""):y(c.type,c.name)?c.name="":c.state.allowName=!1);break;case"[":c.state.allowArray||r(i),c.type+=t,c.state.allowArray=!1,c.state.allowName=!1,c.state.readArray=!0;break;case"]":c.state.readArray||r(i),c.type+=t,c.state.readArray=!1,c.state.allowArray=!0,c.state.allowName=!0;break;default:c.state.allowType?(c.type+=t,c.state.allowParams=!0,c.state.allowArray=!0):c.state.allowName?(c.name+=t,delete c.state.allowArray):c.state.readArray?c.type+=t:r(i)}}return c.parent&&d.throwArgumentError("unexpected eof","param",param),delete o.state,"indexed"===c.name?(e||r(t.length-7),c.indexed&&r(t.length-7),c.indexed=!0,c.name=""):y(c.type,c.name)&&(c.name=""),o.type=C(o.type),o}(e,!!t),E.fromObject({name:r.name,type:r.type,indexed:r.indexed,components:r.components});var r}static isParamType(e){return!(null==e||!e._isParamType)}}function S(e,t){return function(e){e=e.trim();let t=[],r="",n=0;for(let o=0;o<e.length;o++){let c=e[o];","===c&&0===n?(t.push(r),r=""):(r+=c,"("===c?n++:")"===c&&(n--,-1===n&&d.throwArgumentError("unbalanced parenthesis","value",e)))}r&&t.push(r);return t}(e).map((param=>E.fromString(param,t)))}class I{constructor(e,t){e!==h&&d.throwError("use a static from method",c.b.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),v(this,t),this._isFragment=!0,Object.freeze(this)}static from(e){return I.isFragment(e)?e:"string"==typeof e?I.fromString(e):I.fromObject(e)}static fromObject(e){if(I.isFragment(e))return e;switch(e.type){case"function":return N.fromObject(e);case"event":return k.fromObject(e);case"constructor":return _.fromObject(e);case"fallback":case"receive":return null}return d.throwArgumentError("invalid fragment object","value",e)}static fromString(e){return"event"===(e=(e=(e=e.replace(/\s/g," ")).replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," ")).trim()).split(" ")[0]?k.fromString(e.substring(5).trim()):"function"===e.split(" ")[0]?N.fromString(e.substring(8).trim()):"constructor"===e.split("(")[0].trim()?_.fromString(e.trim()):d.throwArgumentError("unsupported fragment","value",e)}static isFragment(e){return!(!e||!e._isFragment)}}class k extends I{format(e){if(e||(e=T.sighash),T[e]||d.throwArgumentError("invalid format type","format",e),e===T.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((input=>JSON.parse(input.format(e))))});let t="";return e!==T.sighash&&(t+="event "),t+=this.name+"("+this.inputs.map((input=>input.format(e))).join(e===T.full?", ":",")+") ",e!==T.sighash&&this.anonymous&&(t+="anonymous "),t.trim()}static from(e){return"string"==typeof e?k.fromString(e):k.fromObject(e)}static fromObject(e){if(k.isEventFragment(e))return e;"event"!==e.type&&d.throwArgumentError("invalid event object","value",e);const t={name:j(e.name),anonymous:e.anonymous,inputs:e.inputs?e.inputs.map(E.fromObject):[],type:"event"};return new k(h,t)}static fromString(e){let t=e.match(P);t||d.throwArgumentError("invalid event string","value",e);let r=!1;return t[3].split(" ").forEach((e=>{switch(e.trim()){case"anonymous":r=!0;break;case"":break;default:d.warn("unknown modifier: "+e)}})),k.fromObject({name:t[1].trim(),anonymous:r,inputs:S(t[2],!0),type:"event"})}static isEventFragment(e){return e&&e._isFragment&&"event"===e.type}}function x(e,t){t.gas=null;let r=e.split("@");return 1!==r.length?(r.length>2&&d.throwArgumentError("invalid human-readable ABI signature","value",e),r[1].match(/^[0-9]+$/)||d.throwArgumentError("invalid human-readable ABI signature gas","value",e),t.gas=n.a.from(r[1]),r[0]):e}function O(e,t){t.constant=!1,t.payable=!1,t.stateMutability="nonpayable",e.split(" ").forEach((e=>{switch(e.trim()){case"constant":t.constant=!0;break;case"payable":t.payable=!0,t.stateMutability="payable";break;case"nonpayable":t.payable=!1,t.stateMutability="nonpayable";break;case"pure":t.constant=!0,t.stateMutability="pure";break;case"view":t.constant=!0,t.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+e)}}))}function A(e){let t={constant:!1,payable:!0,stateMutability:"payable"};return null!=e.stateMutability?(t.stateMutability=e.stateMutability,t.constant="view"===t.stateMutability||"pure"===t.stateMutability,null!=e.constant&&!!e.constant!==t.constant&&d.throwArgumentError("cannot have constant function with mutability "+t.stateMutability,"value",e),t.payable="payable"===t.stateMutability,null!=e.payable&&!!e.payable!==t.payable&&d.throwArgumentError("cannot have payable function with mutability "+t.stateMutability,"value",e)):null!=e.payable?(t.payable=!!e.payable,null!=e.constant||t.payable||"constructor"===e.type||d.throwArgumentError("unable to determine stateMutability","value",e),t.constant=!!e.constant,t.constant?t.stateMutability="view":t.stateMutability=t.payable?"payable":"nonpayable",t.payable&&t.constant&&d.throwArgumentError("cannot have constant payable function","value",e)):null!=e.constant?(t.constant=!!e.constant,t.payable=!t.constant,t.stateMutability=t.constant?"view":"payable"):"constructor"!==e.type&&d.throwArgumentError("unable to determine stateMutability","value",e),t}class _ extends I{format(e){if(e||(e=T.sighash),T[e]||d.throwArgumentError("invalid format type","format",e),e===T.json)return JSON.stringify({type:"constructor",stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((input=>JSON.parse(input.format(e))))});e===T.sighash&&d.throwError("cannot format a constructor for sighash",c.b.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let t="constructor("+this.inputs.map((input=>input.format(e))).join(e===T.full?", ":",")+") ";return this.stateMutability&&"nonpayable"!==this.stateMutability&&(t+=this.stateMutability+" "),t.trim()}static from(e){return"string"==typeof e?_.fromString(e):_.fromObject(e)}static fromObject(e){if(_.isConstructorFragment(e))return e;"constructor"!==e.type&&d.throwArgumentError("invalid constructor object","value",e);let t=A(e);t.constant&&d.throwArgumentError("constructor cannot be constant","value",e);const r={name:null,type:e.type,inputs:e.inputs?e.inputs.map(E.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?n.a.from(e.gas):null};return new _(h,r)}static fromString(e){let t={type:"constructor"},r=(e=x(e,t)).match(P);return r&&"constructor"===r[1].trim()||d.throwArgumentError("invalid constructor string","value",e),t.inputs=S(r[2].trim(),!1),O(r[3].trim(),t),_.fromObject(t)}static isConstructorFragment(e){return e&&e._isFragment&&"constructor"===e.type}}class N extends _{format(e){if(e||(e=T.sighash),T[e]||d.throwArgumentError("invalid format type","format",e),e===T.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((input=>JSON.parse(input.format(e)))),outputs:this.outputs.map((output=>JSON.parse(output.format(e))))});let t="";return e!==T.sighash&&(t+="function "),t+=this.name+"("+this.inputs.map((input=>input.format(e))).join(e===T.full?", ":",")+") ",e!==T.sighash&&(this.stateMutability?"nonpayable"!==this.stateMutability&&(t+=this.stateMutability+" "):this.constant&&(t+="view "),this.outputs&&this.outputs.length&&(t+="returns ("+this.outputs.map((output=>output.format(e))).join(", ")+") "),null!=this.gas&&(t+="@"+this.gas.toString()+" ")),t.trim()}static from(e){return"string"==typeof e?N.fromString(e):N.fromObject(e)}static fromObject(e){if(N.isFunctionFragment(e))return e;"function"!==e.type&&d.throwArgumentError("invalid function object","value",e);let t=A(e);const r={type:e.type,name:j(e.name),constant:t.constant,inputs:e.inputs?e.inputs.map(E.fromObject):[],outputs:e.outputs?e.outputs.map(E.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?n.a.from(e.gas):null};return new N(h,r)}static fromString(e){let t={type:"function"},r=(e=x(e,t)).split(" returns ");r.length>2&&d.throwArgumentError("invalid function string","value",e);let n=r[0].match(P);if(n||d.throwArgumentError("invalid function signature","value",e),t.name=n[1].trim(),t.name&&j(t.name),t.inputs=S(n[2],!1),O(n[3].trim(),t),r.length>1){let n=r[1].match(P);""==n[1].trim()&&""==n[3].trim()||d.throwArgumentError("unexpected tokens","value",e),t.outputs=S(n[2],!1)}else t.outputs=[];return N.fromObject(t)}static isFunctionFragment(e){return e&&e._isFragment&&"function"===e.type}}function C(e){return e.match(/^uint($|[^1-9])/)?e="uint256"+e.substring(4):e.match(/^int($|[^1-9])/)&&(e="int256"+e.substring(3)),e}const R=new RegExp("^[A-Za-z_][A-Za-z0-9_]*$");function j(e){return e&&e.match(R)||d.throwArgumentError(`invalid identifier "${e}"`,"value",e),e}const P=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");var B=r(11);const D=new c.b(l);function F(e){const t=[],r=function(path,object){if(Array.isArray(object))for(let e in object){const n=path.slice();n.push(e);try{r(n,object[e])}catch(e){t.push({path:n,error:e})}}};return r([],e),t}class U{constructor(e,t,r,n){this.name=e,this.type=t,this.localName=r,this.dynamic=n}_throwError(e,t){D.throwArgumentError(e,this.localName,t)}}class M{constructor(e){Object(o.d)(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return Object(B.hexConcat)(this._data)}get length(){return this._dataLength}_writeData(data){return this._data.push(data),this._dataLength+=data.length,data.length}appendWriter(e){return this._writeData(Object(B.concat)(e._data))}writeBytes(e){let t=Object(B.arrayify)(e);const r=t.length%this.wordSize;return r&&(t=Object(B.concat)([t,this._padding.slice(r)])),this._writeData(t)}_getValue(e){let t=Object(B.arrayify)(n.a.from(e));return t.length>this.wordSize&&D.throwError("value out-of-bounds",c.b.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=Object(B.concat)([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class H{constructor(data,e,t,r){Object(o.d)(this,"_data",Object(B.arrayify)(data)),Object(o.d)(this,"wordSize",e||32),Object(o.d)(this,"_coerceFunc",t),Object(o.d)(this,"allowLoose",r),this._offset=0}get data(){return Object(B.hexlify)(this._data)}get consumed(){return this._offset}static coerce(e,t){let r=e.match("^u?int([0-9]+)$");return r&&parseInt(r[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):H.coerce(e,t)}_peekBytes(e,t,r){let n=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+n>this._data.length&&(this.allowLoose&&r&&this._offset+t<=this._data.length?n=t:D.throwError("data out-of-bounds",c.b.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+n})),this._data.slice(this._offset,this._offset+n)}subReader(e){return new H(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let r=this._peekBytes(0,e,!!t);return this._offset+=r.length,r.slice(0,e)}readValue(){return n.a.from(this.readBytes(this.wordSize))}}var L=r(118);class W extends U{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{Object(L.getAddress)(t)}catch(e){this._throwError(e.message,t)}return e.writeValue(t)}decode(e){return Object(L.getAddress)(Object(B.hexZeroPad)(e.readValue().toHexString(),20))}}class $ extends U{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const G=new c.b(l);function V(e,t,r){let n=null;if(Array.isArray(r))n=r;else if(r&&"object"==typeof r){let e={};n=t.map((t=>{const n=t.localName;return n||G.throwError("cannot encode object for signature with missing names",c.b.errors.INVALID_ARGUMENT,{argument:"values",coder:t,value:r}),e[n]&&G.throwError("cannot encode object for signature with duplicate names",c.b.errors.INVALID_ARGUMENT,{argument:"values",coder:t,value:r}),e[n]=!0,r[n]}))}else G.throwArgumentError("invalid tuple value","tuple",r);t.length!==n.length&&G.throwArgumentError("types/value length mismatch","tuple",r);let o=new M(e.wordSize),l=new M(e.wordSize),d=[];t.forEach(((e,t)=>{let r=n[t];if(e.dynamic){let t=l.length;e.encode(l,r);let n=o.writeUpdatableValue();d.push((e=>{n(e+t)}))}else e.encode(o,r)})),d.forEach((e=>{e(o.length)}));let h=e.appendWriter(o);return h+=e.appendWriter(l),h}function K(e,t){let r=[],n=e.subReader(0);t.forEach((t=>{let o=null;if(t.dynamic){let r=e.readValue(),l=n.subReader(r.toNumber());try{o=t.decode(l)}catch(e){if(e.code===c.b.errors.BUFFER_OVERRUN)throw e;o=e,o.baseType=t.name,o.name=t.localName,o.type=t.type}}else try{o=t.decode(e)}catch(e){if(e.code===c.b.errors.BUFFER_OVERRUN)throw e;o=e,o.baseType=t.name,o.name=t.localName,o.type=t.type}null!=o&&r.push(o)}));const o=t.reduce(((e,t)=>{const r=t.localName;return r&&(e[r]||(e[r]=0),e[r]++),e}),{});t.forEach(((e,t)=>{let n=e.localName;if(!n||1!==o[n])return;if("length"===n&&(n="_length"),null!=r[n])return;const c=r[t];c instanceof Error?Object.defineProperty(r,n,{get:()=>{throw c}}):r[n]=c}));for(let i=0;i<r.length;i++){const e=r[i];e instanceof Error&&Object.defineProperty(r,i,{get:()=>{throw e}})}return Object.freeze(r)}class J extends U{constructor(e,t,r){super("array",e.type+"["+(t>=0?t:"")+"]",r,-1===t||e.dynamic),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let i=0;i<this.length;i++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let r=this.length;-1===r&&(r=t.length,e.writeValue(t.length)),G.checkArgumentCount(t.length,r,"coder array"+(this.localName?" "+this.localName:""));let n=[];for(let i=0;i<t.length;i++)n.push(this.coder);return V(e,n,t)}decode(e){let t=this.length;-1===t&&(t=e.readValue().toNumber());let r=[];for(let i=0;i<t;i++)r.push(new $(this.coder));return e.coerce(this.name,K(e,r))}}class z extends U{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class Q extends U{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Object(B.arrayify)(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class X extends Q{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,Object(B.hexlify)(super.decode(e)))}}class Z extends U{constructor(e,t){let r="bytes"+String(e);super(r,r,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(e,t){let data=Object(B.arrayify)(t);return data.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(data)}decode(e){return e.coerce(this.name,Object(B.hexlify)(e.readBytes(this.size)))}}class Y extends U{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return null!=t&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}var ee=r(278);class te extends U{constructor(e,t,r){const n=(t?"int":"uint")+8*e;super(n,n,r,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let r=n.a.from(t),o=ee.a.mask(8*e.wordSize);if(this.signed){let e=o.mask(8*this.size-1);(r.gt(e)||r.lt(e.add(ee.c).mul(ee.b)))&&this._throwError("value out-of-bounds",t)}else(r.lt(ee.f)||r.gt(o.mask(8*this.size)))&&this._throwError("value out-of-bounds",t);return r=r.toTwos(8*this.size).mask(8*this.size),this.signed&&(r=r.fromTwos(8*this.size).toTwos(8*e.wordSize)),e.writeValue(r)}decode(e){let t=e.readValue().mask(8*this.size);return this.signed&&(t=t.fromTwos(8*this.size)),e.coerce(this.name,t)}}var re=r(119);class ne extends Q{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Object(re.f)(t))}decode(e){return Object(re.h)(super.decode(e))}}class se extends U{constructor(e,t){let r=!1;const n=[];e.forEach((e=>{e.dynamic&&(r=!0),n.push(e.type)}));super("tuple","tuple("+n.join(",")+")",t,r),this.coders=e}defaultValue(){const e=[];this.coders.forEach((t=>{e.push(t.defaultValue())}));const t=this.coders.reduce(((e,t)=>{const r=t.localName;return r&&(e[r]||(e[r]=0),e[r]++),e}),{});return this.coders.forEach(((r,n)=>{let o=r.localName;o&&1===t[o]&&("length"===o&&(o="_length"),null==e[o]&&(e[o]=e[n]))})),Object.freeze(e)}encode(e,t){return V(e,this.coders,t)}decode(e){return e.coerce(this.name,K(e,this.coders))}}const ie=new c.b(l),oe=new RegExp(/^bytes([0-9]*)$/),ae=new RegExp(/^(u?int)([0-9]*)$/);class ce{constructor(e){ie.checkNew(new.target,ce),Object(o.d)(this,"coerceFunc",e||null)}_getCoder(param){switch(param.baseType){case"address":return new W(param.name);case"bool":return new z(param.name);case"string":return new ne(param.name);case"bytes":return new X(param.name);case"array":return new J(this._getCoder(param.arrayChildren),param.arrayLength,param.name);case"tuple":return new se((param.components||[]).map((component=>this._getCoder(component))),param.name);case"":return new Y(param.name)}let e=param.type.match(ae);if(e){let t=parseInt(e[2]||"256");return(0===t||t>256||t%8!=0)&&ie.throwArgumentError("invalid "+e[1]+" bit length","param",param),new te(t/8,"int"===e[1],param.name)}if(e=param.type.match(oe),e){let t=parseInt(e[1]);return(0===t||t>32)&&ie.throwArgumentError("invalid bytes length","param",param),new Z(t,param.name)}return ie.throwArgumentError("invalid type","type",param.type)}_getWordSize(){return 32}_getReader(data,e){return new H(data,this._getWordSize(),this.coerceFunc,e)}_getWriter(){return new M(this._getWordSize())}getDefaultValue(e){const t=e.map((e=>this._getCoder(E.from(e))));return new se(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&ie.throwError("types/values length mismatch",c.b.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const r=e.map((e=>this._getCoder(E.from(e)))),n=new se(r,"_"),o=this._getWriter();return n.encode(o,t),o.data}decode(e,data,t){const r=e.map((e=>this._getCoder(E.from(e))));return new se(r,"_").decode(this._getReader(Object(B.arrayify)(data),t))}}const le=new ce;var ue=r(297),de=r(26);const he=new c.b(l);class fe extends o.a{}class me extends o.a{}class pe extends o.a{static isIndexed(e){return!(!e||!e._isIndexed)}}function ge(e,t){const r=new Error(`deferred error during ABI decoding triggered accessing ${e}`);return r.error=t,r}class be{constructor(e){he.checkNew(new.target,be);let t=[];t="string"==typeof e?JSON.parse(e):e,Object(o.d)(this,"fragments",t.map((e=>I.from(e))).filter((e=>null!=e))),Object(o.d)(this,"_abiCoder",Object(o.e)(new.target,"getAbiCoder")()),Object(o.d)(this,"functions",{}),Object(o.d)(this,"errors",{}),Object(o.d)(this,"events",{}),Object(o.d)(this,"structs",{}),this.fragments.forEach((e=>{let t=null;switch(e.type){case"constructor":return this.deploy?void he.warn("duplicate definition - constructor"):void Object(o.d)(this,"deploy",e);case"function":t=this.functions;break;case"event":t=this.events;break;default:return}let r=e.format();t[r]?he.warn("duplicate definition - "+r):t[r]=e})),this.deploy||Object(o.d)(this,"deploy",_.from({payable:!1,type:"constructor"})),Object(o.d)(this,"_isInterface",!0)}format(e){e||(e=T.full),e===T.sighash&&he.throwArgumentError("interface does not support formatting sighash","format",e);const t=this.fragments.map((t=>t.format(e)));return e===T.json?JSON.stringify(t.map((e=>JSON.parse(e)))):t}static getAbiCoder(){return le}static getAddress(address){return Object(L.getAddress)(address)}static getSighash(e){return Object(B.hexDataSlice)(Object(ue.a)(e.format()),0,4)}static getEventTopic(e){return Object(ue.a)(e.format())}getFunction(e){if(Object(B.isHexString)(e)){for(const t in this.functions)if(e===this.getSighash(t))return this.functions[t];he.throwArgumentError("no matching function","sighash",e)}if(-1===e.indexOf("(")){const t=e.trim(),r=Object.keys(this.functions).filter((e=>e.split("(")[0]===t));return 0===r.length?he.throwArgumentError("no matching function","name",t):r.length>1&&he.throwArgumentError("multiple matching functions","name",t),this.functions[r[0]]}const t=this.functions[N.fromString(e).format()];return t||he.throwArgumentError("no matching function","signature",e),t}getEvent(e){if(Object(B.isHexString)(e)){const t=e.toLowerCase();for(const e in this.events)if(t===this.getEventTopic(e))return this.events[e];he.throwArgumentError("no matching event","topichash",t)}if(-1===e.indexOf("(")){const t=e.trim(),r=Object.keys(this.events).filter((e=>e.split("(")[0]===t));return 0===r.length?he.throwArgumentError("no matching event","name",t):r.length>1&&he.throwArgumentError("multiple matching events","name",t),this.events[r[0]]}const t=this.events[k.fromString(e).format()];return t||he.throwArgumentError("no matching event","signature",e),t}getSighash(e){return"string"==typeof e&&(e=this.getFunction(e)),Object(o.e)(this.constructor,"getSighash")(e)}getEventTopic(e){return"string"==typeof e&&(e=this.getEvent(e)),Object(o.e)(this.constructor,"getEventTopic")(e)}_decodeParams(e,data){return this._abiCoder.decode(e,data)}_encodeParams(e,t){return this._abiCoder.encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeFunctionData(e,data){"string"==typeof e&&(e=this.getFunction(e));const t=Object(B.arrayify)(data);return Object(B.hexlify)(t.slice(0,4))!==this.getSighash(e)&&he.throwArgumentError(`data signature does not match function ${e.name}.`,"data",Object(B.hexlify)(t)),this._decodeParams(e.inputs,t.slice(4))}encodeFunctionData(e,t){return"string"==typeof e&&(e=this.getFunction(e)),Object(B.hexlify)(Object(B.concat)([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionResult(e,data){"string"==typeof e&&(e=this.getFunction(e));let t=Object(B.arrayify)(data),r=null,n=null;switch(t.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(e.outputs,t)}catch(e){}break;case 4:"0x08c379a0"===Object(B.hexlify)(t.slice(0,4))&&(n="Error(string)",r=this._abiCoder.decode(["string"],t.slice(4))[0])}return he.throwError("call revert exception",c.b.errors.CALL_EXCEPTION,{method:e.format(),errorSignature:n,errorArgs:[r],reason:r})}encodeFunctionResult(e,t){return"string"==typeof e&&(e=this.getFunction(e)),Object(B.hexlify)(this._abiCoder.encode(e.outputs,t||[]))}encodeFilterTopics(e,t){"string"==typeof e&&(e=this.getEvent(e)),t.length>e.inputs.length&&he.throwError("too many arguments for "+e.format(),c.b.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:t});let r=[];e.anonymous||r.push(this.getEventTopic(e));const n=(param,e)=>"string"===param.type?Object(ue.a)(e):"bytes"===param.type?Object(de.keccak256)(Object(B.hexlify)(e)):("address"===param.type&&this._abiCoder.encode(["address"],[e]),Object(B.hexZeroPad)(Object(B.hexlify)(e),32));for(t.forEach(((t,o)=>{let param=e.inputs[o];param.indexed?null==t?r.push(null):"array"===param.baseType||"tuple"===param.baseType?he.throwArgumentError("filtering with tuples or arrays not supported","contract."+param.name,t):Array.isArray(t)?r.push(t.map((e=>n(param,e)))):r.push(n(param,t)):null!=t&&he.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+param.name,t)}));r.length&&null===r[r.length-1];)r.pop();return r}encodeEventLog(e,t){"string"==typeof e&&(e=this.getEvent(e));const r=[],n=[],o=[];return e.anonymous||r.push(this.getEventTopic(e)),t.length!==e.inputs.length&&he.throwArgumentError("event arguments/values mismatch","values",t),e.inputs.forEach(((param,e)=>{const c=t[e];if(param.indexed)if("string"===param.type)r.push(Object(ue.a)(c));else if("bytes"===param.type)r.push(Object(de.keccak256)(c));else{if("tuple"===param.baseType||"array"===param.baseType)throw new Error("not implemented");r.push(this._abiCoder.encode([param.type],[c]))}else n.push(param),o.push(c)})),{data:this._abiCoder.encode(n,o),topics:r}}decodeEventLog(e,data,t){if("string"==typeof e&&(e=this.getEvent(e)),null!=t&&!e.anonymous){let r=this.getEventTopic(e);Object(B.isHexString)(t[0],32)&&t[0].toLowerCase()===r||he.throwError("fragment/topic mismatch",c.b.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:r,value:t[0]}),t=t.slice(1)}let r=[],n=[],o=[];e.inputs.forEach(((param,e)=>{param.indexed?"string"===param.type||"bytes"===param.type||"tuple"===param.baseType||"array"===param.baseType?(r.push(E.fromObject({type:"bytes32",name:param.name})),o.push(!0)):(r.push(param),o.push(!1)):(n.push(param),o.push(!1))}));let l=null!=t?this._abiCoder.decode(r,Object(B.concat)(t)):null,d=this._abiCoder.decode(n,data,!0),h=[],f=0,m=0;e.inputs.forEach(((param,e)=>{if(param.indexed)if(null==l)h[e]=new pe({_isIndexed:!0,hash:null});else if(o[e])h[e]=new pe({_isIndexed:!0,hash:l[m++]});else try{h[e]=l[m++]}catch(t){h[e]=t}else try{h[e]=d[f++]}catch(t){h[e]=t}if(param.name&&null==h[param.name]){const t=h[e];t instanceof Error?Object.defineProperty(h,param.name,{get:()=>{throw ge(`property ${JSON.stringify(param.name)}`,t)}}):h[param.name]=t}}));for(let i=0;i<h.length;i++){const e=h[i];e instanceof Error&&Object.defineProperty(h,i,{get:()=>{throw ge(`index ${i}`,e)}})}return Object.freeze(h)}parseTransaction(e){let t=this.getFunction(e.data.substring(0,10).toLowerCase());return t?new me({args:this._abiCoder.decode(t.inputs,"0x"+e.data.substring(10)),functionFragment:t,name:t.name,signature:t.format(),sighash:this.getSighash(t),value:n.a.from(e.value||"0")}):null}parseLog(e){let t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new fe({eventFragment:t,name:t.name,signature:t.format(),topic:this.getEventTopic(t),args:this.decodeEventLog(t,e.data,e.topics)})}static isInterface(e){return!(!e||!e._isInterface)}}},1070:function(e,t,r){"use strict";r.r(t),r.d(t,"commify",(function(){return l})),r.d(t,"formatUnits",(function(){return d})),r.d(t,"parseUnits",(function(){return h})),r.d(t,"formatEther",(function(){return f})),r.d(t,"parseEther",(function(){return m}));var n=r(374);const o=new(r(2).b)("units/5.0.10"),c=["wei","kwei","mwei","gwei","szabo","finney","ether"];function l(e){const t=String(e).split(".");(t.length>2||!t[0].match(/^-?[0-9]*$/)||t[1]&&!t[1].match(/^[0-9]*$/)||"."===e||"-."===e)&&o.throwArgumentError("invalid value","value",e);let r=t[0],n="";for("-"===r.substring(0,1)&&(n="-",r=r.substring(1));"0"===r.substring(0,1);)r=r.substring(1);""===r&&(r="0");let c="";for(2===t.length&&(c="."+(t[1]||"0"));c.length>2&&"0"===c[c.length-1];)c=c.substring(0,c.length-1);const l=[];for(;r.length;){if(r.length<=3){l.unshift(r);break}{const e=r.length-3;l.unshift(r.substring(e)),r=r.substring(0,e)}}return n+l.join(",")+c}function d(e,t){if("string"==typeof t){const e=c.indexOf(t);-1!==e&&(t=3*e)}return Object(n.c)(e,null!=t?t:18)}function h(e,t){if("string"!=typeof e&&o.throwArgumentError("value must be a string","value",e),"string"==typeof t){const e=c.indexOf(t);-1!==e&&(t=3*e)}return Object(n.d)(e,null!=t?t:18)}function f(e){return d(e,18)}function m(e){return h(e,18)}},1091:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="random/5.0.8"},11:function(e,t,r){"use strict";r.r(t),r.d(t,"isBytesLike",(function(){return l})),r.d(t,"isBytes",(function(){return d})),r.d(t,"arrayify",(function(){return h})),r.d(t,"concat",(function(){return f})),r.d(t,"stripZeros",(function(){return m})),r.d(t,"zeroPad",(function(){return y})),r.d(t,"isHexString",(function(){return v})),r.d(t,"hexlify",(function(){return w})),r.d(t,"hexDataLength",(function(){return E})),r.d(t,"hexDataSlice",(function(){return S})),r.d(t,"hexConcat",(function(){return I})),r.d(t,"hexValue",(function(){return k})),r.d(t,"hexStripZeros",(function(){return x})),r.d(t,"hexZeroPad",(function(){return O})),r.d(t,"splitSignature",(function(){return A})),r.d(t,"joinSignature",(function(){return _}));const n=new(r(2).b)("bytes/5.0.10");function o(e){return!!e.toHexString}function c(e){return e.slice||(e.slice=function(){const t=Array.prototype.slice.call(arguments);return c(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function l(e){return v(e)&&!(e.length%2)||d(e)}function d(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"==typeof e)return!1;if(null==e.length)return!1;for(let i=0;i<e.length;i++){const t=e[i];if("number"!=typeof t||t<0||t>=256||t%1)return!1}return!0}function h(e,t){if(t||(t={}),"number"==typeof e){n.checkSafeUint53(e,"invalid arrayify value");const t=[];for(;e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),c(new Uint8Array(t))}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),o(e)&&(e=e.toHexString()),v(e)){let r=e.substring(2);r.length%2&&("left"===t.hexPad?r="0x0"+r.substring(2):"right"===t.hexPad?r+="0":n.throwArgumentError("hex data is odd-length","value",e));const o=[];for(let i=0;i<r.length;i+=2)o.push(parseInt(r.substring(i,i+2),16));return c(new Uint8Array(o))}return d(e)?c(new Uint8Array(e)):n.throwArgumentError("invalid arrayify value","value",e)}function f(e){const t=e.map((e=>h(e))),r=t.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(r);return t.reduce(((e,object)=>(n.set(object,e),e+object.length)),0),c(n)}function m(e){let t=h(e);if(0===t.length)return t;let r=0;for(;r<t.length&&0===t[r];)r++;return r&&(t=t.slice(r)),t}function y(e,t){(e=h(e)).length>t&&n.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(t);return r.set(e,t-e.length),c(r)}function v(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}const T="0123456789abcdef";function w(e,t){if(t||(t={}),"number"==typeof e){n.checkSafeUint53(e,"invalid hexlify value");let t="";for(;e;)t=T[15&e]+t,e=Math.floor(e/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),o(e))return e.toHexString();if(v(e))return e.length%2&&("left"===t.hexPad?e="0x0"+e.substring(2):"right"===t.hexPad?e+="0":n.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(d(e)){let t="0x";for(let i=0;i<e.length;i++){let r=e[i];t+=T[(240&r)>>4]+T[15&r]}return t}return n.throwArgumentError("invalid hexlify value","value",e)}function E(data){if("string"!=typeof data)data=w(data);else if(!v(data)||data.length%2)return null;return(data.length-2)/2}function S(data,e,t){return"string"!=typeof data?data=w(data):(!v(data)||data.length%2)&&n.throwArgumentError("invalid hexData","value",data),e=2+2*e,null!=t?"0x"+data.substring(e,2+2*t):"0x"+data.substring(e)}function I(e){let t="0x";return e.forEach((e=>{t+=w(e).substring(2)})),t}function k(e){const t=x(w(e,{hexPad:"left"}));return"0x"===t?"0x0":t}function x(e){"string"!=typeof e&&(e=w(e)),v(e)||n.throwArgumentError("invalid hex string","value",e),e=e.substring(2);let t=0;for(;t<e.length&&"0"===e[t];)t++;return"0x"+e.substring(t)}function O(e,t){for("string"!=typeof e?e=w(e):v(e)||n.throwArgumentError("invalid hex string","value",e),e.length>2*t+2&&n.throwArgumentError("value out of range","value",arguments[1]);e.length<2*t+2;)e="0x0"+e.substring(2);return e}function A(e){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0};if(l(e)){const r=h(e);65!==r.length&&n.throwArgumentError("invalid signature string; must be 65 bytes","signature",e),t.r=w(r.slice(0,32)),t.s=w(r.slice(32,64)),t.v=r[64],t.v<27&&(0===t.v||1===t.v?t.v+=27:n.throwArgumentError("signature invalid v byte","signature",e)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(r[32]|=128),t._vs=w(r.slice(32,64))}else{if(t.r=e.r,t.s=e.s,t.v=e.v,t.recoveryParam=e.recoveryParam,t._vs=e._vs,null!=t._vs){const r=y(h(t._vs),32);t._vs=w(r);const o=r[0]>=128?1:0;null==t.recoveryParam?t.recoveryParam=o:t.recoveryParam!==o&&n.throwArgumentError("signature recoveryParam mismatch _vs","signature",e),r[0]&=127;const s=w(r);null==t.s?t.s=s:t.s!==s&&n.throwArgumentError("signature v mismatch _vs","signature",e)}null==t.recoveryParam?null==t.v?n.throwArgumentError("signature missing v and recoveryParam","signature",e):t.recoveryParam=1-t.v%2:null==t.v?t.v=27+t.recoveryParam:t.recoveryParam!==1-t.v%2&&n.throwArgumentError("signature recoveryParam mismatch v","signature",e),null!=t.r&&v(t.r)?t.r=O(t.r,32):n.throwArgumentError("signature missing or invalid r","signature",e),null!=t.s&&v(t.s)?t.s=O(t.s,32):n.throwArgumentError("signature missing or invalid s","signature",e);const r=h(t.s);r[0]>=128&&n.throwArgumentError("signature s out of range","signature",e),t.recoveryParam&&(r[0]|=128);const o=w(r);t._vs&&(v(t._vs)||n.throwArgumentError("signature invalid _vs","signature",e),t._vs=O(t._vs,32)),null==t._vs?t._vs=o:t._vs!==o&&n.throwArgumentError("signature _vs mismatch v and s","signature",e)}return t}function _(e){return w(f([(e=A(e)).r,e.s,e.recoveryParam?"0x1c":"0x1b"]))}},118:function(e,t,r){"use strict";r.r(t),r.d(t,"getAddress",(function(){return T})),r.d(t,"isAddress",(function(){return w})),r.d(t,"getIcapAddress",(function(){return E})),r.d(t,"getContractAddress",(function(){return S})),r.d(t,"getCreate2Address",(function(){return I}));var n=r(11),o=r(91),c=r(26),l=r(146);const d=new(r(2).b)("address/5.0.10");function h(address){Object(n.isHexString)(address,20)||d.throwArgumentError("invalid address","address",address);const e=(address=address.toLowerCase()).substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const r=Object(n.arrayify)(Object(c.keccak256)(t));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(15&r[i>>1])>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const f={};for(let i=0;i<10;i++)f[String(i)]=String(i);for(let i=0;i<26;i++)f[String.fromCharCode(65+i)]=String(10+i);const m=Math.floor((y=9007199254740991,Math.log10?Math.log10(y):Math.log(y)/Math.LN10));var y;function v(address){let e=(address=(address=address.toUpperCase()).substring(4)+address.substring(0,2)+"00").split("").map((e=>f[e])).join("");for(;e.length>=m;){let t=e.substring(0,m);e=parseInt(t,10)%97+e.substring(t.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}function T(address){let e=null;if("string"!=typeof address&&d.throwArgumentError("invalid address","address",address),address.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==address.substring(0,2)&&(address="0x"+address),e=h(address),address.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==address&&d.throwArgumentError("bad address checksum","address",address);else if(address.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(address.substring(2,4)!==v(address)&&d.throwArgumentError("bad icap checksum","address",address),e=Object(o.c)(address.substring(4));e.length<40;)e="0"+e;e=h("0x"+e)}else d.throwArgumentError("invalid address","address",address);return e}function w(address){try{return T(address),!0}catch(e){}return!1}function E(address){let e=Object(o.b)(T(address).substring(2)).toUpperCase();for(;e.length<30;)e="0"+e;return"XE"+v("XE00"+e)+e}function S(e){let t=null;try{t=T(e.from)}catch(t){d.throwArgumentError("missing from address","transaction",e)}const r=Object(n.stripZeros)(Object(n.arrayify)(o.a.from(e.nonce).toHexString()));return T(Object(n.hexDataSlice)(Object(c.keccak256)(Object(l.encode)([t,r])),12))}function I(e,t,r){return 32!==Object(n.hexDataLength)(t)&&d.throwArgumentError("salt must be 32 bytes","salt",t),32!==Object(n.hexDataLength)(r)&&d.throwArgumentError("initCodeHash must be 32 bytes","initCodeHash",r),T(Object(n.hexDataSlice)(Object(c.keccak256)(Object(n.concat)(["0xff",T(e),t,r])),12))}},119:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return h})),r.d(t,"f",(function(){return m})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return T})),r.d(t,"h",(function(){return w})),r.d(t,"g",(function(){return E}));var n=r(11);const o=new(r(2).b)("strings/5.0.9");var c,l;function d(e,t,r,output,n){if(e===l.BAD_PREFIX||e===l.UNEXPECTED_CONTINUE){let i=0;for(let e=t+1;e<r.length&&r[e]>>6==2;e++)i++;return i}return e===l.OVERRUN?r.length-t-1:0}!function(e){e.current="",e.NFC="NFC",e.NFD="NFD",e.NFKC="NFKC",e.NFKD="NFKD"}(c||(c={})),function(e){e.UNEXPECTED_CONTINUE="unexpected continuation byte",e.BAD_PREFIX="bad codepoint prefix",e.OVERRUN="string overrun",e.MISSING_CONTINUE="missing continuation byte",e.OUT_OF_RANGE="out of UTF-8 range",e.UTF16_SURROGATE="UTF-16 surrogate",e.OVERLONG="overlong representation"}(l||(l={}));const h=Object.freeze({error:function(e,t,r,output,n){return o.throwArgumentError(`invalid codepoint at offset ${t}; ${e}`,"bytes",r)},ignore:d,replace:function(e,t,r,output,n){return e===l.OVERLONG?(output.push(n),0):(output.push(65533),d(e,t,r))}});function f(e,t){null==t&&(t=h.error),e=Object(n.arrayify)(e);const r=[];let i=0;for(;i<e.length;){const n=e[i++];if(n>>7==0){r.push(n);continue}let o=null,c=null;if(192==(224&n))o=1,c=127;else if(224==(240&n))o=2,c=2047;else{if(240!=(248&n)){i+=t(128==(192&n)?l.UNEXPECTED_CONTINUE:l.BAD_PREFIX,i-1,e,r);continue}o=3,c=65535}if(i-1+o>=e.length){i+=t(l.OVERRUN,i-1,e,r);continue}let d=n&(1<<8-o-1)-1;for(let n=0;n<o;n++){let n=e[i];if(128!=(192&n)){i+=t(l.MISSING_CONTINUE,i,e,r),d=null;break}d=d<<6|63&n,i++}null!==d&&(d>1114111?i+=t(l.OUT_OF_RANGE,i-1-o,e,r,d):d>=55296&&d<=57343?i+=t(l.UTF16_SURROGATE,i-1-o,e,r,d):d<=c?i+=t(l.OVERLONG,i-1-o,e,r,d):r.push(d))}return r}function m(e,form=c.current){form!=c.current&&(o.checkNormalize(),e=e.normalize(form));let t=[];for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(r<128)t.push(r);else if(r<2048)t.push(r>>6|192),t.push(63&r|128);else if(55296==(64512&r)){i++;const n=e.charCodeAt(i);if(i>=e.length||56320!=(64512&n))throw new Error("invalid utf-8 string");const o=65536+((1023&r)<<10)+(1023&n);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(63&o|128)}else t.push(r>>12|224),t.push(r>>6&63|128),t.push(63&r|128)}return Object(n.arrayify)(t)}function y(e){const t="0000"+e.toString(16);return"\\u"+t.substring(t.length-4)}function v(e,t){return'"'+f(e,t).map((e=>{if(e<256){switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 13:return"\\r";case 34:return'\\"';case 92:return"\\\\"}if(e>=32&&e<127)return String.fromCharCode(e)}return e<=65535?y(e):y(55296+((e-=65536)>>10&1023))+y(56320+(1023&e))})).join("")+'"'}function T(e){return e.map((e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10&1023),56320+(1023&e))))).join("")}function w(e,t){return T(f(e,t))}function E(e,form=c.current){return f(m(e,form))}},220:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));r(11);var n=r(0);const o=new(r(2).b)("abstract-provider/5.0.9");class c extends n.a{static isForkEvent(e){return!(!e||!e._isForkEvent)}}class l{constructor(){o.checkAbstract(new.target,l),Object(n.d)(this,"_isProvider",!0)}addListener(e,t){return this.on(e,t)}removeListener(e,t){return this.off(e,t)}static isProvider(e){return!(!e||!e._isProvider)}}},233:function(e,t,r){"use strict";r.r(t),r.d(t,"AddressZero",(function(){return n.a})),r.d(t,"NegativeOne",(function(){return o.b})),r.d(t,"Zero",(function(){return o.f})),r.d(t,"One",(function(){return o.c})),r.d(t,"Two",(function(){return o.d})),r.d(t,"WeiPerEther",(function(){return o.e})),r.d(t,"MaxUint256",(function(){return o.a})),r.d(t,"HashZero",(function(){return c.a})),r.d(t,"EtherSymbol",(function(){return l}));var n=r(927),o=r(278),c=r(928);const l=""},2540:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAssetDecimals=t.getMainnetEquivalent=t.getAssetName=t.getChainInfo=t.CHAIN_INFO_URL=void 0;const c=r(58),l=r(27),d=r(235),h=r(233),f=o(r(2541)),m=r(118);t.CHAIN_INFO_URL="https://chainid.network/chains.json";t.getChainInfo=e=>n(void 0,void 0,void 0,(function*(){let r=f.default[0];try{if(r=f.default.find((t=>t.chainId===e)),0===r.chainId){r=(yield c.fetchJson(t.CHAIN_INFO_URL)).find((t=>t.chainId===e))}}catch(e){}return r}));t.getAssetName=(e,t)=>{var r,n;const o=f.default.find((t=>t.chainId===e));return o&&null!==(n=null===(r=o.assetId[t])||void 0===r?void 0:r.symbol)&&void 0!==n?n:"Token"};t.getMainnetEquivalent=(e,t)=>{var r;const n=f.default.find((t=>t.chainId===e));if(!n)return l.Result.fail(new Error(`Chain info not found for ${e}`));const o=null===(r=n.assetId[m.getAddress(t)])||void 0===r?void 0:r.mainnetEquivalent;return o?l.Result.ok(m.getAddress(o)):l.Result.fail(new Error(`Mainnet equivalent not found for ${t} on ${e}`))};t.getAssetDecimals=(e,t)=>n(void 0,void 0,void 0,(function*(){let r=18;if(e!==h.AddressZero)try{const n=new d.Contract(e,l.ERC20Abi,t);r=yield n.decimals()}catch(t){console.warn(`Error detecting decimals, unsafely falling back to 18 decimals for ${e}`)}return r}))},2541:function(e){e.exports=JSON.parse('[{"name":"","chainId":0,"shortName":"","chain":"","network":"","networkId":0,"nativeCurrency":{"name":"","symbol":"","decimals":18},"assetId":{},"rpc":[],"faucets":[],"infoURL":""},{"name":"Ethereum Mainnet","chainId":1,"shortName":"eth","chain":"ETH","network":"mainnet","networkId":1,"nativeCurrency":{"name":"Ether","symbol":"ETH","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"ETH","mainnetEquivalent":"0x0000000000000000000000000000000000000000"},"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48":{"symbol":"USDC","mainnetEquivalent":"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0":{"symbol":"MATIC","mainnetEquivalent":"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0"},"0x0F5D2fB29fb7d3CFeE444a200298f468908cC942":{"symbol":"MANA","mainnetEquivalent":"0x0F5D2fB29fb7d3CFeE444a200298f468908cC942"},"0x6B175474E89094C44Da98b954EedeAC495271d0F":{"symbol":"DAI","mainnetEquivalent":"0x6B175474E89094C44Da98b954EedeAC495271d0F"},"0xdAC17F958D2ee523a2206206994597C13D831ec7":{"symbol":"USDT","mainnetEquivalent":"0xdAC17F958D2ee523a2206206994597C13D831ec7"},"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984":{"symbol":"UNI","mainnetEquivalent":"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984"},"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2":{"symbol":"WETH","mainnetEquivalent":"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"},"0xB8c77482e45F1F44dE1745F52C74426C631bDD52":{"symbol":"BNB","mainnetEquivalent":"0xB8c77482e45F1F44dE1745F52C74426C631bDD52"}},"rpc":["https://mainnet.infura.io/v3/${INFURA_API_KEY}","wss://mainnet.infura.io/ws/v3/${INFURA_API_KEY}","https://api.mycryptoapi.com/eth","https://cloudflare-eth.com"],"faucets":[],"infoURL":"https://ethereum.org"},{"name":"Matic Mainnet","chainId":137,"shortName":"matic","chain":"Matic","network":"mainnet","networkId":137,"nativeCurrency":{"name":"Matic","symbol":"MATIC","decimals":18},"assetId":{"0x0000000000000000000000000000000000001010":{"symbol":"MATIC","mainnetEquivalent":"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0"},"0x0000000000000000000000000000000000000000":{"symbol":"MATIC","mainnetEquivalent":"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0"},"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174":{"symbol":"USDC","mainnetEquivalent":"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},"0xA1c57f48F0Deb89f569dFbE6E2B7f46D33606fD4":{"symbol":"MANA","mainnetEquivalent":"0x0F5D2fB29fb7d3CFeE444a200298f468908cC942"},"0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063":{"symbol":"DAI","mainnetEquivalent":"0x6B175474E89094C44Da98b954EedeAC495271d0F"},"0xb33EaAd8d922B1083446DC23f610c2567fB5180f":{"symbol":"UNI","mainnetEquivalent":"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984"},"0xc2132D05D31c914a87C6611C10748AEb04B58e8F":{"symbol":"USDT","mainnetEquivalent":"0xdAC17F958D2ee523a2206206994597C13D831ec7"},"0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619":{"symbol":"WETH (PoS)","mainnetEquivalent":"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"}},"rpc":["https://rpc-mainnet.matic.network","wss://ws-mainnet.matic.network"],"faucets":[],"infoURL":"https://matic.network/"},{"name":"Matic Testnet Mumbai","chainId":80001,"shortName":"maticmum","chain":"Matic","network":"testnet","networkId":80001,"nativeCurrency":{"name":"Matic","symbol":"tMATIC","decimals":18},"assetId":{"0x0000000000000000000000000000000000001010":{"symbol":"MATIC","mainnetEquivalent":"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0"}},"rpc":["https://rpc-mumbai.matic.today","wss://ws-mumbai.matic.today"],"faucets":["https://faucet.matic.network/"],"infoURL":"https://matic.network/"},{"name":"Ethereum Testnet Kovan","chainId":42,"shortName":"kov","chain":"ETH","network":"kovan","networkId":42,"nativeCurrency":{"name":"Kovan Ether","symbol":"KOV","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"ETH","mainnetEquivalent":"0x0000000000000000000000000000000000000000"}},"rpc":["https://kovan.poa.network","http://kovan.poa.network:8545","https://kovan.infura.io/v3/${INFURA_API_KEY}","wss://kovan.infura.io/ws/v3/${INFURA_API_KEY}","ws://kovan.poa.network:8546"],"faucets":["https://faucet.kovan.network","https://gitter.im/kovan-testnet/faucet"],"infoURL":"https://kovan-testnet.github.io/website"},{"name":"Ethereum Testnet Grli","chainId":5,"shortName":"gor","chain":"ETH","network":"goerli","networkId":5,"nativeCurrency":{"name":"Grli Ether","symbol":"GOR","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"ETH","mainnetEquivalent":"0x0000000000000000000000000000000000000000"}},"rpc":["https://rpc.goerli.mudit.blog/","https://rpc.slock.it/goerli ","https://goerli.prylabs.net/"],"faucets":["https://goerli-faucet.slock.it/?address=${ADDRESS}","https://faucet.goerli.mudit.blog"],"infoURL":"https://goerli.net/#about"},{"name":"Ethereum Testnet Rinkeby","chainId":4,"shortName":"rin","chain":"ETH","network":"rinkeby","networkId":4,"nativeCurrency":{"name":"Rinkeby Ether","symbol":"RIN","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"ETH","mainnetEquivalent":"0x0000000000000000000000000000000000000000"}},"rpc":["https://rinkeby.infura.io/v3/${INFURA_API_KEY}","wss://rinkeby.infura.io/ws/v3/${INFURA_API_KEY}"],"faucets":["https://faucet.rinkeby.io"],"infoURL":"https://www.rinkeby.io"},{"name":"Arbitrum Testnet V3","chainId":79377087078960,"shortName":"ArbTV3","chain":"Arb","network":"arbitrum","networkId":79377087078960,"nativeCurrency":{"name":"Arbitrum Ether","symbol":"tETH","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"ETH","mainnetEquivalent":"0x0000000000000000000000000000000000000000"}},"rpc":["https://kovan3.arbitrum.io/rpc"],"faucets":[],"infoURL":""},{"name":"Binance Smart Chain Mainnet","chainId":56,"shortName":"bnb","chain":"BSC","network":"mainnet","networkId":56,"nativeCurrency":{"name":"Binance Chain Native Token","symbol":"BNB","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"BNB","mainnetEquivalent":"0xB8c77482e45F1F44dE1745F52C74426C631bDD52"},"0x55d398326f99059fF775485246999027B3197955":{"symbol":"USDT","mainnetEquivalent":"0xdAC17F958D2ee523a2206206994597C13D831ec7"},"0xBf5140A22578168FD562DCcF235E5D43A02ce9B1":{"symbol":"UNI","mainnetEquivalent":"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984"},"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d":{"symbol":"USDC","mainnetEquivalent":"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},"0x1AF3F329e8BE154074D8769D1FFa4eE058B1DBc3":{"symbol":"DAI","mainnetEquivalent":"0x6B175474E89094C44Da98b954EedeAC495271d0F"}},"rpc":["https://bsc-dataseed1.binance.org","https://bsc-dataseed2.binance.org","https://bsc-dataseed3.binance.org","https://bsc-dataseed4.binance.org","https://bsc-dataseed1.defibit.io","https://bsc-dataseed2.defibit.io","https://bsc-dataseed3.defibit.io","https://bsc-dataseed4.defibit.io","https://bsc-dataseed1.ninicoin.io","https://bsc-dataseed2.ninicoin.io","https://bsc-dataseed3.ninicoin.io","https://bsc-dataseed4.ninicoin.io","wss://bsc-ws-node.nariox.org"],"faucets":[],"infoURL":"https://www.binance.org"},{"name":"xDAI Chain","chainId":100,"shortName":"xdai","chain":"XDAI","network":"mainnet","networkId":100,"nativeCurrency":{"name":"xDAI","symbol":"xDAI","decimals":18},"assetId":{"0x0000000000000000000000000000000000000000":{"symbol":"XDAI","mainnetEquivalent":"0x6B175474E89094C44Da98b954EedeAC495271d0F"},"0x4ECaBa5870353805a9F068101A40E0f32ed605C6":{"symbol":"USDT","mainnetEquivalent":"0xdAC17F958D2ee523a2206206994597C13D831ec7"},"0x4537e328Bf7e4eFA29D05CAeA260D7fE26af9D74":{"symbol":"UNI","mainnetEquivalent":"0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984"},"0xDDAfbb505ad214D7b80b1f830fcCc89B60fb7A83":{"symbol":"USDC","mainnetEquivalent":"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},"0x44fA8E6f47987339850636F88629646662444217":{"symbol":"DAI","mainnetEquivalent":"0x6B175474E89094C44Da98b954EedeAC495271d0F"}},"rpc":["https://rpc.xdaichain.com","https://xdai.poanetwork.dev","wss://rpc.xdaichain.com/wss","wss://xdai.poanetwork.dev/wss","http://xdai.poanetwork.dev","https://dai.poa.network","ws://xdai.poanetwork.dev:8546"],"faucets":[],"infoURL":"https://forum.poa.network/c/xdai-chain"}]')},2548:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelSigner=t.getRandomChannelSigner=void 0;const o=r(397),c=r(1061),l=r(3161),d=r(376),h=r(617),f=r(918);t.getRandomChannelSigner=e=>new m(d.getRandomPrivateKey(),e);class m extends o.Signer{constructor(e,t){super(),this.privateKey=e,this._ethersType="Signer",this.encrypt=d.encrypt,this.privateKey=e,this.publicKey=d.getPublicKeyFromPrivateKey(e),this.address=d.getAddressFromPublicKey(this.publicKey),this.publicIdentifier=h.getPublicIdentifierFromPublicKey(this.publicKey),this.connectProvider(t)}getAddress(){return n(this,void 0,void 0,(function*(){return this.address}))}connectProvider(e){return n(this,void 0,void 0,(function*(){this.provider="string"==typeof e?new c.JsonRpcProvider(e,yield f.getChainId(e)):e}))}connect(e){return this.provider=e,this}decrypt(e){return n(this,void 0,void 0,(function*(){return d.decrypt(e,this.privateKey)}))}signMessage(e){return n(this,void 0,void 0,(function*(){return d.signChannelMessage(e,this.privateKey)}))}signUtilityMessage(e){return n(this,void 0,void 0,(function*(){return d.signUtilityMessage(e,this.privateKey)}))}signTransaction(e){return n(this,void 0,void 0,(function*(){if(!this.provider)throw new Error("ChannelSigner can't send transactions without being connected to a provider");return new l.Wallet(this.privateKey,this.provider).signTransaction(e)}))}sendTransaction(e){return n(this,void 0,void 0,(function*(){if(!this.provider)throw new Error("ChannelSigner can't send transactions without being connected to a provider");return new l.Wallet(this.privateKey,this.provider).sendTransaction(e)}))}}t.ChannelSigner=m},2568:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LimitedCache=void 0;t.LimitedCache=class{constructor(e){this.length=0,this.head=null,this.tail=null,this.cache={},this.maxLength=e}set(e,t){const r=!!this.cache[e];if(this.cache[e]=t,r)return;const n={next:null,key:e};if(!this.tail)return this.cache[e]=t,this.head=this.tail=n,void this.length++;if(this.tail.next=n,this.tail=n,this.length===this.maxLength){const head=this.head;return delete this.cache[head.key],void(this.head=head.next)}this.length++}get(e){const t=this.cache[e];return t||null}}},2569:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notNegative=t.notPositive=t.notLessThanOrEqualTo=t.notLessThan=t.notGreaterThanOrEqualTo=t.notGreaterThan=t.notBigNumberish=void 0;const n=r(96),o=r(615);t.notBigNumberish=o.getBigNumberishError;t.notGreaterThan=(e,r)=>t.notBigNumberish(e)?t.notBigNumberish(e):n.BigNumber.from(e).gt(n.BigNumber.from(r))?void 0:`Value (${e.toString()}) is not greater than ${r.toString()}`;t.notGreaterThanOrEqualTo=(e,r)=>t.notBigNumberish(e)?t.notBigNumberish(e):n.BigNumber.from(e).gte(r)?void 0:`Value (${e.toString()}) is not greater than or equal to ${r.toString()}`;t.notLessThan=(e,r)=>t.notBigNumberish(e)?t.notBigNumberish(e):n.BigNumber.from(e).lt(r)?void 0:`Value (${e.toString()}) is not less than ${r.toString()}`;t.notLessThanOrEqualTo=(e,r)=>t.notBigNumberish(e)?t.notBigNumberish(e):n.BigNumber.from(e).lte(r)?void 0:`Value (${e.toString()}) is not less than or equal to ${r.toString()}`;t.notPositive=e=>t.notGreaterThanOrEqualTo(e,0);t.notNegative=e=>{if(t.notLessThan(0,e))return`Value ${e.toString()} is negative.`}},2570:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getCreate2MultisigAddress=t.getMinimalProxyInitCode=void 0;const o=r(451),c=r(118),l=r(27),d=r(617);t.getMinimalProxyInitCode=e=>`0x3d602d80600a3d3981f3363d3d373d3d3d363d73${e.toLowerCase().replace(/^0x/,"")}5af43d82803e903d91602b57fd5bf3`;t.getCreate2MultisigAddress=(e,r,h,f,m)=>n(void 0,void 0,void 0,(function*(){const n=yield m.getChannelMastercopyAddress(f,h);if(n.isError)return n;try{return l.Result.ok(c.getCreate2Address(f,o.keccak256(["address","address","uint256"],[d.getSignerAddressFromPublicIdentifier(e),d.getSignerAddressFromPublicIdentifier(r),h]),o.keccak256(["bytes"],[t.getMinimalProxyInitCode(n.getValue())])))}catch(e){return l.Result.fail(e)}}))},2571:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Currency=void 0;const n=r(233),o=r(96),c=r(1070);class l{constructor(e,t,r){this.typeToSymbol={DAI:"$",DEI:"DEI ",ETH:n.EtherSymbol,FIN:"FIN ",WEI:"WEI "},this.defaultOptions={DAI:{commas:!1,decimals:2,symbol:!0,round:!0},DEI:{commas:!1,decimals:0,symbol:!1,round:!0},ETH:{commas:!1,decimals:3,symbol:!0,round:!0},FIN:{commas:!1,decimals:3,symbol:!1,round:!0},WEI:{commas:!1,decimals:0,symbol:!1,round:!0}},this.getRate=e=>{const t={DAI:this.toRay(this.daiRate),DEI:this.toRay(c.parseUnits(this.daiRate,18).toString()),ETH:this.toRay("1"),FIN:this.toRay(c.parseUnits("1",3).toString()),GWEI:this.toRay(c.parseUnits("1",9).toString()),WEI:this.toRay(c.parseUnits("1",18).toString())};return this.isEthType()&&this.isEthType(e)||this.isTokenType()&&this.isTokenType(e)||this.daiRateGiven||(console.warn(`Provide DAI:ETH rate for accurate ${this.type} -> ${e} conversions`),console.warn(`Using default eth price of $${this.daiRate} (amount: ${this.amount})`)),t[e]},this.toDAI=e=>this._convert("DAI",e),this.toDEI=e=>this._convert("DEI",e),this.toETH=e=>this._convert("ETH",e),this.toFIN=e=>this._convert("FIN",e),this.toWEI=e=>this._convert("WEI",e),this.toGWEI=e=>this._convert("GWEI",e),this._convert=(e,t)=>{t&&(this.daiRate=t,this.daiRateGiven=!0);const r=this.toRay(this.getRate(e)).div(this.getRate(this.type)),n=this.fromRay(this.fromRoundRay(this.ray.mul(r)));return new l(e,n.toString(),this.daiRateGiven?this.daiRate:void 0)},this._round=e=>this._floor(this.fromWad(this.toWad(e).add(this.toWad("0.5"))).toString()),this._floor=e=>e.substring(0,e.indexOf(".")),this.toWad=e=>c.parseUnits(e.toString(),18),this.toRay=e=>this.toWad(this.toWad(e.toString())),this.fromWad=e=>c.formatUnits(e.toString(),18),this.fromRoundRay=e=>this._round(this.fromRay(e)),this.fromRay=e=>this.fromWad(this._round(this.fromWad(e.toString()))),this.type=e,this.daiRate=void 0!==r?r:"1",this.daiRateGiven=!!r;try{this.wad=this.toWad(t._hex?o.BigNumber.from(t._hex):t),this.ray=this.toRay(t._hex?o.BigNumber.from(t._hex):t)}catch(e){throw new Error(`Invalid currency amount (${t}): ${e}`)}}get amount(){return this.fromWad(this.wad)}get currency(){return{amount:this.amount,type:this.type}}get symbol(){return this.typeToSymbol[this.type]}get floor(){return this._floor(this.amount)}toString(){return this.amount.slice(0,this.amount.indexOf("."))}isEthType(e){return["ETH","FIN","WEI"].includes(e||this.type)}isTokenType(e){return["DAI","DEI"].includes(e||this.type)}toBN(){return o.BigNumber.from(this._round(this.amount))}format(e){const t=this.amount,r=Object.assign(Object.assign({},this.defaultOptions[this.type]),e||{}),symbol=r.symbol?`${this.symbol}`:"",n=t.length-t.indexOf(".")-1,o=r.round?this.round(r.decimals):r.decimals>n?t+"0".repeat(r.decimals-n):r.decimals<n?t.substring(0,t.indexOf(".")+r.decimals+1):t;return`${symbol}${r.commas?c.commify(o):o}`}round(e){const t=this.amount,r=t.length-t.indexOf(".")-1;if("number"==typeof e&&e>r)return t+"0".repeat(e-r);if("number"==typeof e&&e<r){const n=o.BigNumber.from(`5${"0".repeat(18-e-1)}`);return this.fromWad(this.wad.add(n)).slice(0,t.length-(r-e)).replace(/\.$/,"")}return this.amount}}t.Currency=l,l.DAI=(e,t)=>new l("DAI",e,t),l.DEI=(e,t)=>new l("DEI",e,t),l.ETH=(e,t)=>new l("ETH",e,t),l.FIN=(e,t)=>new l("FIN",e,t),l.WEI=(e,t)=>new l("WEI",e,t)},2572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayAndThrow=t.delay=void 0;t.delay=e=>new Promise((t=>setTimeout(t,e)));t.delayAndThrow=(e,t="")=>new Promise(((r,n)=>setTimeout((()=>n(new Error(t))),e)))},2573:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateProviders=t.getGasPrice=t.getEthProvider=void 0;const o=r(96),c=r(1061),l=["https://www.ethercluster.com/etc"],d=[61],h=o.BigNumber.from(1e3);t.getEthProvider=(e,t)=>new c.JsonRpcProvider(e,l.includes(e)||d.includes(t)?"classic":void 0);t.getGasPrice=(e,t)=>n(void 0,void 0,void 0,(function*(){var r;const n=t||(null===(r=yield e.getNetwork())||void 0===r?void 0:r.chainId),o=yield e.getGasPrice();return 100===n&&o.lt(h)?h:o}));t.hydrateProviders=e=>{const t={};return Object.entries(e).map((([e,r])=>{t[e]=new c.JsonRpcProvider(r,parseInt(e))})),t}},2574:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isDirectory=void 0;const c=o(r(948));t.isDirectory=path=>n(void 0,void 0,void 0,(function*(){try{return c.default.statSync(path).isDirectory()}catch(e){return!1}}))},2575:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getExchangeRateInEth=t.normalizeFee=t.TESTNETS_WITH_FEES=t.FeeCalculationError=void 0;const c=r(27),l=r(96),d=r(233),h=o(r(450)),f=r(947),m=r(319),y=r(952);class v extends c.VectorError{constructor(e,t={}){super(e,t,v.type),this.message=e}}t.FeeCalculationError=v,v.type="FeeCalculationError",v.reasons={ChainError:"Error reading the chain",ExchangeRateError:"Error getting exchange rate"},t.TESTNETS_WITH_FEES=[4,5,42,80001,1337,1338];t.normalizeFee=(e,r,o,h,f,T,w,E)=>n(void 0,void 0,void 0,(function*(){const n="normalizeFee",S=m.getRandomBytes32();if(w.info({method:n,methodId:S,fee:e.toString(),toAssetId:o,toChainId:f},"Method start"),1!==f&&!t.TESTNETS_WITH_FEES.includes(f))return c.Result.fail(new v(v.reasons.ChainError,{message:"Cannot get normalize fees that are not going to mainnet",toAssetId:o,toChainId:f,fee:e.toString()}));let I=E;if(!E){const e=yield T.getGasPrice(f);if(e.isError)return c.Result.fail(new v(v.reasons.ChainError,{getGasPriceError:c.jsonifyError(e.getError())}));I=e.getValue()}const k=e.mul(I);if(o===d.AddressZero)return w.info({method:n,methodId:S},"Eth detected, exchange rate not required"),c.Result.ok(k);const x=t.TESTNETS_WITH_FEES.includes(f)?c.Result.ok(.01):yield t.getExchangeRateInEth(o,w);if(x.isError)return c.Result.fail(x.getError());const O=x.getValue(),A=y.inverse(O.toString()),_=y.calculateExchangeWad(k,r,A,h);return c.Result.ok(l.BigNumber.from(_))}));t.getExchangeRateInEth=(e,t)=>n(void 0,void 0,void 0,(function*(){var r,n,o,l,m;if(e===d.AddressZero)return c.Result.ok(1);const y=`https://api.coingecko.com/api/v3/simple/token_price/ethereum?contract_addresses=${e}&vs_currencies=eth`;t.info({uri:y},"Getting exchange rate");try{const d=yield h.default.get(y);return t.info({uri:y,response:d.data},"Got exchange rate"),(null===(r=d.data[e])||void 0===r?void 0:r.eth)||(null===(n=d.data[e.toLowerCase()])||void 0===n?void 0:n.eth)?c.Result.ok(null!==(l=null===(o=d.data[e])||void 0===o?void 0:o.eth)&&void 0!==l?l:null===(m=d.data[e.toLowerCase()])||void 0===m?void 0:m.eth):c.Result.fail(new v(v.reasons.ExchangeRateError,{message:"Could not find rate in response",response:d.data,tokenAddress:e}))}catch(r){return f.logAxiosError(t,r),c.Result.fail(new v(v.reasons.ExchangeRateError,{message:"Could not get exchange rate",tokenAddress:e,error:r.message}))}}))},2576:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateMerkleTreeData=void 0;const n=r(233),o=r(26),c=r(953),l=r(376),d=r(621);t.generateMerkleTreeData=(e,t)=>{const r=e.sort(((a,b)=>a.transferId.localeCompare(b.transferId))).map((e=>l.bufferify(d.hashCoreTransferState(e)))),h=new c.MerkleTree(r,o.keccak256),f=t?h.getHexProof(l.bufferify(d.hashCoreTransferState(t))):void 0,m=h.getHexRoot();return{root:"0x"===m?n.HashZero:m,proof:f}}},2604:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NatsMessagingService=t.NatsBasicMessagingService=t.getBearerToken=t.AuthService=void 0;const c=r(27),l=o(r(450)),d=o(r(455)),h=r(622),f=r(946),m=r(949);var y=r(622);Object.defineProperty(t,"AuthService",{enumerable:!0,get:function(){return y.AuthService}});t.getBearerToken=(e,t)=>()=>n(void 0,void 0,void 0,(function*(){const r=(yield l.default.get(`${e}/auth/${t.publicIdentifier}`)).data,n=yield t.signMessage(r);return(yield l.default.post(`${e}/auth`,{sig:n,userIdentifier:t.publicIdentifier})).data}));class v{constructor(e){if(this.log=e.logger||d.default(),e.messagingUrl)this.authUrl=e.messagingUrl,f.isNode()?this.natsUrl=`nats://${e.messagingUrl.replace(/^.*:\/\//,"").replace(/\//,"").replace(/:[0-9]+/,"")}:4222`:this.natsUrl=`${e.messagingUrl.replace(/:\/\/.*/,"").replace("http","ws")}://${e.messagingUrl.replace(/^.*:\/\//,"").replace(/\//,"")}/ws-nats`,this.log.info(`Derived natsUrl=${this.natsUrl} from messagingUrl=${e.messagingUrl}`);else if(!e.authUrl||!e.natsUrl)throw new Error("Either a messagingUrl or both an authUrl + natsUrl must be provided");if(e.authUrl&&(this.authUrl=e.authUrl),e.natsUrl&&(this.natsUrl=e.natsUrl),e.bearerToken)this.bearerToken=e.bearerToken;else{if(!e.signer)throw new Error("Either a bearerToken or signer must be provided");this.signer=e.signer}}isConnected(){var e;return!!(null===(e=this.connection)||void 0===e?void 0:e.isConnected())}assertConnected(){if(!this.isConnected())throw new Error("No connection detected, use connect() method")}connect(){return n(this,void 0,void 0,(function*(){if(!this.bearerToken){const e=(yield l.default.get(`${this.authUrl}/auth/${this.signer.publicIdentifier}`)).data,t=yield this.signer.signMessage(e),r=yield l.default.post(`${this.authUrl}/auth`,{sig:t,userIdentifier:this.signer.publicIdentifier});this.bearerToken=r.data}const e=h.natsServiceFactory({bearerToken:this.bearerToken,natsServers:[this.natsUrl]},this.log.child({module:"Messaging-Nats"})),t=yield e.connect();this.connection=e,this.log.debug("Connected!"),"function"==typeof t.addEventListener?t.addEventListener("close",(()=>n(this,void 0,void 0,(function*(){this.bearerToken=void 0,yield this.connect()})))):t.on("close",(()=>n(this,void 0,void 0,(function*(){this.bearerToken=void 0,yield this.connect()}))))}))}disconnect(){var e;return n(this,void 0,void 0,(function*(){null===(e=this.connection)||void 0===e||e.disconnect()}))}publish(e,data){return n(this,void 0,void 0,(function*(){this.assertConnected();const t=m.safeJsonStringify(data);this.log.debug({subject:e,data:data},"Publishing"),yield this.connection.publish(e,t)}))}request(e,t,data){return n(this,void 0,void 0,(function*(){this.assertConnected(),this.log.debug(`Requesting ${e} with data: ${JSON.stringify(data)}`);const r=yield this.connection.request(e,t,JSON.stringify(data));return this.log.debug(`Request for ${e} returned: ${JSON.stringify(r)}`),r}))}subscribe(e,t){return n(this,void 0,void 0,(function*(){this.assertConnected(),yield this.connection.subscribe(e,((e,r)=>{const n="string"==typeof e?JSON.parse(e):e,o="string"==typeof e.data?JSON.parse(e.data):e.data;n.data=o,t(e,r)})),this.log.debug({subject:e},"Subscription created")}))}unsubscribe(e){return n(this,void 0,void 0,(function*(){this.assertConnected();this.getSubjectsToUnsubscribeFrom(e).forEach((sub=>{this.connection.unsubscribe(sub)}))}))}flush(){return n(this,void 0,void 0,(function*(){yield this.connection.flush()}))}getSubjectsToUnsubscribeFrom(e){const t=this.connection.getSubscribedSubjects(),r=[],n=e.split(">")[0].split("*");return t.forEach((e=>{let t=!0;n.forEach((r=>{(null!=e?e:"").includes(r)||""===r||(t=!1)})),t&&r.push(e)})),r}respondToMessage(e,t,r){return n(this,void 0,void 0,(function*(){this.log.debug({method:r,inbox:e},"Sending response"),yield this.publish(e,t.toJson())}))}registerCallback(e,t,r){return n(this,void 0,void 0,(function*(){yield this.subscribe(e,((e,n)=>{this.log.debug({method:r,msg:e},"Received message");const o=e.subject.split(".")[1];if(n)return void t(c.Result.fail(new c.MessagingError(n)),o,e.reply);const{result:l,parsed:d}=this.parseIncomingMessage(e);d.reply&&t(l,o,e.reply)})),this.log.debug({method:r,subject:e},"Subscription created")}))}sendMessage(data,e,t,r,o,l){var d,h,f,y;return n(this,void 0,void 0,(function*(){this.assertConnected();const n=`${t}.${r}.${e}`,v=m.safeJsonStringify(data.toJson());try{this.log.debug({method:l,msgBody:v},"Sending message");const e=yield this.request(n,o,v);this.log.debug({method:l,msg:e},"Received response");const{result:t}=this.parseIncomingMessage(e);return t}catch(t){this.log.error({error:null!==(d=t.message)&&void 0!==d?d:t,subject:e,data:v,method:l},"Sending message failed");const r=null!==(f=null!==(h=t.message)&&void 0!==h?h:t)&&void 0!==f?f:"";return c.Result.fail(new c.MessagingError(r.includes("Request timed out")||r.includes("timeout")?c.MessagingError.reasons.Timeout:c.MessagingError.reasons.Unknown,{messagingError:null!==(y=t.message)&&void 0!==y?y:t,subject:n,data:data.toJson(),method:l}))}}))}sendMessageWithRetries(data,e,t,r,o,c,l){return n(this,void 0,void 0,(function*(){return yield this.sendMessage(data,e,t,r,o,l)}))}parseIncomingMessage(e){const t="string"==typeof e?m.safeJsonParse(e):e,r="string"==typeof e.data?m.safeJsonParse(e.data):e.data;return t.data=r,{result:c.Result.fromJson(t.data),parsed:t}}}t.NatsBasicMessagingService=v;t.NatsMessagingService=class extends v{constructor(e){var t;super(e),this.config=e,this.logger=null!==(t=e.logger)&&void 0!==t?t:d.default()}sendProtocolMessage(e,t,r=3e4,o=0){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(c.Result.ok({update:e,previousUpdate:t}),"protocol",e.toIdentifier,e.fromIdentifier,r,o,"sendProtocolMessage")}))}onReceiveProtocolMessage(e,t){return n(this,void 0,void 0,(function*(){return this.registerCallback(`${e}.*.protocol`,t,"onReceiveProtocolMessage")}))}respondToProtocolMessage(e,t,r){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,c.Result.ok({update:t,previousUpdate:r}),"respondToProtocolMessage")}))}respondWithProtocolError(e,t){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,c.Result.fail(t),"respondWithProtocolError")}))}sendRestoreStateMessage(e,t,r,o=3e4,c){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(e,"restore",t,r,o,c,"sendRestoreStateMessage")}))}onReceiveRestoreStateMessage(e,t){return n(this,void 0,void 0,(function*(){yield this.registerCallback(`${e}.*.restore`,t,"onReceiveRestoreStateMessage")}))}respondToRestoreStateMessage(e,t){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,t,"respondToRestoreStateMessage")}))}sendSetupMessage(e,t,r,o=3e4,c=0){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(e,"setup",t,r,o,c,"sendSetupMessage")}))}onReceiveSetupMessage(e,t){return n(this,void 0,void 0,(function*(){yield this.registerCallback(`${e}.*.setup`,t,"onReceiveSetupMessage")}))}respondToSetupMessage(e,t){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,t,"respondToSetupMessage")}))}sendRequestCollateralMessage(e,t,r,o=3e4,c=0){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(e,"request-collateral",t,r,o,c,"sendRequestCollateralMessage")}))}onReceiveRequestCollateralMessage(e,t){return n(this,void 0,void 0,(function*(){return this.registerCallback(`${e}.*.request-collateral`,t,"onReceiveRequestCollateralMessage")}))}respondToRequestCollateralMessage(e,t){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,t,"respondToRequestCollateralMessage")}))}sendLockMessage(e,t,r,o=3e4,c=0){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(e,"lock",t,r,o,c,"sendLockMessage")}))}onReceiveLockMessage(e,t){return n(this,void 0,void 0,(function*(){return this.registerCallback(`${e}.*.lock`,t,"onReceiveLockMessage")}))}respondToLockMessage(e,t){return n(this,void 0,void 0,(function*(){return this.respondToMessage(e,t,"respondToLockMessage")}))}sendIsAliveMessage(e,t,r,n=3e4,o){return this.sendMessageWithRetries(e,"isalive",t,r,n,o,"sendIsAliveMessage")}onReceiveIsAliveMessage(e,t){return this.registerCallback(`${e}.*.isalive`,t,"onReceiveIsAliveMessage")}respondToIsAliveMessage(e,t){return this.respondToMessage(e,t,"respondToIsAliveMessage")}sendRouterConfigMessage(e,t,r,o=3e4,c){return n(this,void 0,void 0,(function*(){return this.sendMessageWithRetries(e,"config",t,r,o,c,"sendRouterConfigMessage")}))}sendTransferQuoteMessage(e,t,r,n=3e4,o){return this.sendMessageWithRetries(e,"transfer-quote",t,r,n,o,"sendTransferQuoteMessage")}sendWithdrawalQuoteMessage(e,t,r,n=3e4,o){return this.sendMessageWithRetries(e,"withdrawal-quote",t,r,n,o,"sendWithdrawalQuoteMessage")}onReceiveWithdrawalQuoteMessage(e,t){return this.registerCallback(`${e}.*.withdrawal-quote`,t,"onReceiveWithdrawalQuoteMessage")}respondToWithdrawalQuoteMessage(e,t){return this.respondToMessage(e,t,"respondToWithdrawalQuoteMessage")}}},2646:function(e,t,r){"use strict";function n(){return(new Date).getTime()*Math.pow(10,3)+Math.floor(Math.random()*Math.pow(10,3))}Object.defineProperty(t,"__esModule",{value:!0}),t.constructRpcRequest=t.payloadId=void 0,t.payloadId=n;t.constructRpcRequest=(e,t)=>({id:n(),jsonrpc:"2.0",method:e,params:t})},2647:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RestServerNodeService=t.ServerNodeServiceError=void 0;const c=r(27),l=o(r(629)),d=o(r(450)),h=r(213),f=new l.default;class m extends c.NodeError{constructor(e,t,r,n,o={}){super(e,Object.assign({requestUrl:r,publicIdentifier:t,params:n},o)),this.msg=e}}t.ServerNodeServiceError=m,m.type="ServerNodeServiceError",m.reasons={InternalServerError:"Failed to send request",InvalidParams:"Request has invalid parameters",MultinodeProhibitted:"Not allowed to have multiple nodes",NoEvts:"No evts for event",NoPublicIdentifier:"Public identifier not supplied, and no default identifier",Timeout:"Timeout"};class y{constructor(e,t,r){this.serverNodeUrl=e,this.logger=t,this.evts=r,this.publicIdentifier="",this.signerAddress="",this.ctxs={}}static connect(e,t,r,o,c){return n(this,void 0,void 0,(function*(){const n=new y(e,t,r);if("number"==typeof o){const e=yield n.createNode({index:o,skipCheckIn:c});if(e.isError)throw t.error({error:e.getError().message,method:"connect"},"Failed to create node"),e.getError();const{publicIdentifier:r,signerAddress:l}=e.getValue();n.publicIdentifier=r,n.signerAddress=l}return n}))}getStatus(e){return this.executeHttpRequest(`${null!=e?e:this.publicIdentifier}/status`,"get",{},c.NodeParams.GetStatusSchema)}getRouterConfig(e){var t;return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/router/config/${e.routerIdentifier}`,"get",e,c.NodeParams.GetRouterConfigSchema)}getConfig(){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("config","get",{},c.NodeParams.GetConfigSchema)}))}getWithdrawalCommitment(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/withdraw/transfer/${e.transferId}`,"get",{},c.NodeParams.GetWithdrawalCommitmentSchema)}))}getWithdrawalCommitmentByTransactionHash(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/withdraw/transaction/${e.transactionHash}`,"get",{},c.NodeParams.GetWithdrawalCommitmentByTransactionHashSchema)}))}sendDisputeChannelTx(e){return this.executeHttpRequest("send-dispute-channel-tx","post",e,c.NodeParams.SendDisputeChannelTxSchema)}sendDefundChannelTx(e){return this.executeHttpRequest("send-defund-channel-tx","post",e,c.NodeParams.SendDefundChannelTxSchema)}sendDisputeTransferTx(e){return this.executeHttpRequest("send-dispute-transfer-tx","post",e,c.NodeParams.SendDisputeTransferTxSchema)}sendDefundTransferTx(e){return this.executeHttpRequest("send-defund-transfer-tx","post",e,c.NodeParams.SendDefundTransferTxSchema)}createNode(e){return n(this,void 0,void 0,(function*(){const t=yield this.executeHttpRequest("node","post",e,c.NodeParams.CreateNodeSchema);if(t.isError)return t;if(!this.evts)return t;const{publicIdentifier:r}=t.getValue();if(this.ctxs[r])return t;const n=Object.fromEntries(Object.entries(this.evts).map((([e,t])=>{var r;return[e,null!==(r=t.url)&&void 0!==r?r:""]})));this.ctxs[r]=h.Evt.newCtx();const o={events:n,publicIdentifier:r},l=yield this.executeHttpRequest("event/subscribe","post",o,c.NodeParams.RegisterListenerSchema);return l.isError?(this.logger.error({error:l.getError(),publicIdentifier:r},"Failed to create subscription"),c.Result.fail(l.getError())):(this.logger.info({urls:n,method:"createNode",publicIdentifier:r},"Engine event subscription created"),t)}))}getStateChannel(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/channels/${e.channelAddress}`,"get",e,c.NodeParams.GetChannelStateSchema)}))}getStateChannels(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/channels`,"get",e,c.NodeParams.GetChannelStatesSchema)}))}getTransfersByRoutingId(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/transfers/routing-id/${e.routingId}`,"get",e,c.NodeParams.GetTransferStatesByRoutingIdSchema)}))}getTransferByRoutingId(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/channels/${e.channelAddress}/transfers/routing-id/${e.routingId}`,"get",e,c.NodeParams.GetTransferStateByRoutingIdSchema)}))}getTransfer(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/transfers/${e.transferId}`,"get",e,c.NodeParams.GetTransferStateSchema)}))}getActiveTransfers(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/channels/${e.channelAddress}/active-transfers`,"get",e,c.NodeParams.GetActiveTransfersByChannelAddressSchema)}))}getTransfers(e){var t;return n(this,void 0,void 0,(function*(){const r=[e.active?`active=${e.active}`:void 0,e.channelAddress?`channelAddress=${e.channelAddress}`:void 0,e.routingId?`routingId=${e.routingId}`:void 0,e.startDate?`startDate=${Date.parse(e.startDate.toString())}`:void 0,e.endDate?`endDate=${Date.parse(e.endDate.toString())}`:void 0].filter((e=>!!e)).join("&");return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/transfers?${r}`,"get",e,c.NodeParams.GetActiveTransfersByChannelAddressSchema)}))}getStateChannelByParticipants(e){var t;return n(this,void 0,void 0,(function*(){return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/channels/counterparty/${e.counterparty}/chain-id/${e.chainId}`,"get",e,c.NodeParams.GetChannelStateByParticipantsSchema)}))}getRegisteredTransfers(e){var t;return this.executeHttpRequest(`${null!==(t=e.publicIdentifier)&&void 0!==t?t:this.publicIdentifier}/registered-transfers/chain-id/${e.chainId}`,"get",e,c.NodeParams.GetRegisteredTransfersSchema)}restoreState(e){return this.executeHttpRequest("restore","post",e,c.NodeParams.RestoreStateSchema)}setup(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("setup","post",e,c.NodeParams.RequestSetupSchema)}))}internalSetup(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("internal-setup","post",e,c.NodeParams.SetupSchema)}))}sendDepositTx(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("send-deposit-tx","post",e,c.NodeParams.SendDepositTxSchema)}))}reconcileDeposit(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("deposit","post",{channelAddress:e.channelAddress,assetId:e.assetId,publicIdentifier:e.publicIdentifier},c.NodeParams.DepositSchema)}))}requestCollateral(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("request-collateral","post",e,c.NodeParams.RequestCollateralSchema)}))}getTransferQuote(e){return this.executeHttpRequest("transfers/quote","post",e,c.NodeParams.TransferQuoteSchema)}conditionalTransfer(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("transfers/create","post",e,c.NodeParams.ConditionalTransferSchema)}))}resolveTransfer(e){return n(this,void 0,void 0,(function*(){return this.executeHttpRequest("transfers/resolve","post",e,c.NodeParams.ResolveTransferSchema)}))}withdraw(e){return this.executeHttpRequest("withdraw","post",e,c.NodeParams.WithdrawSchema)}getWithdrawalQuote(e){return this.executeHttpRequest("withdraw/quote","post",e,c.NodeParams.WithdrawalQuoteSchema)}signUtilityMessage(e){return this.executeHttpRequest("sign-utility-message","post",e,c.NodeParams.SignUtilityMessageSchema)}sendIsAliveMessage(e){return this.executeHttpRequest("is-alive","post",e,c.NodeParams.SendIsAliveSchema)}once(e,t,filter=(()=>!0),r){var n;if(!this.evts||!(null===(n=this.evts[e])||void 0===n?void 0:n.evt))throw new m(m.reasons.NoEvts,null!=r?r:this.publicIdentifier,"",{event:e,publicIdentifier:r});const o=null!=r?r:this.publicIdentifier;if(!o)throw new m(m.reasons.NoPublicIdentifier,"","",{event:e,publicIdentifier:r});const c=this.ctxs[null!=r?r:this.publicIdentifier];this.evts[e].evt.pipe(c).pipe((data=>{const e=filter(data),t=data,r=[t.publicIdentifier,t.bobIdentifier,t.aliceIdentifier].filter((e=>!!e));return e&&r.includes(o)})).attachOnce(t)}on(e,t,filter=(()=>!0),r){var n;if(!this.evts||!(null===(n=this.evts[e])||void 0===n?void 0:n.evt))throw new m(m.reasons.NoEvts,null!=r?r:this.publicIdentifier,"",{event:e,publicIdentifier:r});const o=null!=r?r:this.publicIdentifier;if(!o)throw new m(m.reasons.NoPublicIdentifier,"","",{event:e,publicIdentifier:r});const c=this.ctxs[o];this.evts[e].evt.pipe(c).pipe((data=>{const e=filter(data),t=data,r=[t.publicIdentifier,t.bobIdentifier,t.aliceIdentifier].filter((e=>!!e));return e&&r.includes(o)})).attach(t)}waitFor(e,t,filter=(()=>!0),r){var n;if(!this.evts||!(null===(n=this.evts[e])||void 0===n?void 0:n.evt))throw new m(m.reasons.NoEvts,null!=r?r:this.publicIdentifier,"",{event:e,timeout:t,publicIdentifier:r});const o=null!=r?r:this.publicIdentifier;if(!o)throw new m(m.reasons.NoPublicIdentifier,"","",{event:e,publicIdentifier:r});const c=this.ctxs[o];return this.evts[e].evt.pipe(c).pipe((data=>{const e=filter(data),t=data,r=[t.publicIdentifier,t.bobIdentifier,t.aliceIdentifier].filter((e=>!!e));return e&&r.includes(o)})).waitFor(t)}off(e,t){var r;if(!this.evts||!(null===(r=this.evts[e])||void 0===r?void 0:r.evt))throw new m(m.reasons.NoEvts,null!=t?t:this.publicIdentifier,"",{event:e,publicIdentifier:t});if(!t&&!this.publicIdentifier)throw new m(m.reasons.NoPublicIdentifier,"","",{event:e,publicIdentifier:t});this.ctxs[null!=t?t:this.publicIdentifier].done()}executeHttpRequest(e,t,r,o){var l,h,y,v,T,w,E,S;return n(this,void 0,void 0,(function*(){const n=`${this.serverNodeUrl}/${e}`,I=f.compile(o),k=Object.assign({publicIdentifier:this.publicIdentifier},r);if(!I(k))return c.Result.fail(new m(m.reasons.InvalidParams,k.publicIdentifer,e,r,{paramsError:null===(l=I.errors)||void 0===l?void 0:l.map((e=>e.message)).join(",")}));try{const e="get"===t?yield d.default.get(n):yield d.default.post(n,k);return c.Result.ok(e.data)}catch(t){const n=Object.keys(t).includes("toJSON")?t.toJSON():t,o=null!==(T=null!==(v=null===(y=null===(h=t.response)||void 0===h?void 0:h.data)||void 0===y?void 0:y.message)&&void 0!==v?v:n.message)&&void 0!==T?T:m.reasons.InternalServerError,l=new m(o.includes("timed out")||o.includes("timeout")?m.reasons.Timeout:o,k.publicIdentifier,e,r,Object.assign({},null!==(E=null===(w=t.response)||void 0===w?void 0:w.data)&&void 0!==E?E:{stack:null!==(S=n.stack)&&void 0!==S?S:""}));return c.Result.fail(l)}}))}}t.RestServerNodeService=y},27:function(e,t,r){"use strict";r.r(t),r.d(t,"ARBITRUM_TESTNET_1_CHAIN_ID",(function(){return te})),r.d(t,"AUTODEPLOY_CHAIN_IDS",(function(){return re})),r.d(t,"AllowedSwapSchema",(function(){return De})),r.d(t,"ApproveParamsSchema",(function(){return Ze})),r.d(t,"ApproveResponseSchema",(function(){return Ye})),r.d(t,"BalanceEncoding",(function(){return H})),r.d(t,"CHAINS_WITH_ONE_CONFIRMATION",(function(){return oe})),r.d(t,"CONDITIONAL_TRANSFER_CREATED_EVENT",(function(){return fe})),r.d(t,"CONDITIONAL_TRANSFER_RESOLVED_EVENT",(function(){return me})),r.d(t,"ChainError",(function(){return F})),r.d(t,"ChannelCommitmentTypes",(function(){return $})),r.d(t,"ChannelRpcMethods",(function(){return ot})),r.d(t,"CheckStatusParamsSchema",(function(){return nt})),r.d(t,"CheckStatusResponseSchema",(function(){return st})),r.d(t,"CoreChannelStateEncoding",(function(){return G})),r.d(t,"CoreTransferStateEncoding",(function(){return V})),r.d(t,"DEFAULT_CHANNEL_TIMEOUT",(function(){return Q})),r.d(t,"DEFAULT_FEE_EXPIRY",(function(){return se})),r.d(t,"DEFAULT_TRANSFER_TIMEOUT",(function(){return K})),r.d(t,"DEPOSIT_RECONCILED_EVENT",(function(){return pe})),r.d(t,"ERC20Abi",(function(){return D})),r.d(t,"ETH_READER_MAX_RETRIES",(function(){return ce})),r.d(t,"EngineError",(function(){return C})),r.d(t,"EngineEvents",(function(){return we})),r.d(t,"EngineParams",(function(){return Ft})),r.d(t,"ExecuteParamsSchema",(function(){return et})),r.d(t,"ExecuteResponseSchema",(function(){return tt})),r.d(t,"GAS_ESTIMATES",(function(){return P})),r.d(t,"GetTransfersFilterOptsSchema",(function(){return yt})),r.d(t,"HashlockTransferName",(function(){return Sn})),r.d(t,"HashlockTransferResolverEncoding",(function(){return kn})),r.d(t,"HashlockTransferStateEncoding",(function(){return In})),r.d(t,"IS_ALIVE_EVENT",(function(){return de})),r.d(t,"MAXIMUM_CHANNEL_TIMEOUT",(function(){return Z})),r.d(t,"MAXIMUM_TRANSFER_TIMEOUT",(function(){return z})),r.d(t,"MINIMUM_CHANNEL_TIMEOUT",(function(){return X})),r.d(t,"MINIMUM_TRANSFER_TIMEOUT",(function(){return J})),r.d(t,"MessagingError",(function(){return _})),r.d(t,"NUM_CONFIRMATIONS",(function(){return ie})),r.d(t,"NodeError",(function(){return R})),r.d(t,"NodeParams",(function(){return un})),r.d(t,"NodeResponses",(function(){return hn})),r.d(t,"ProtocolError",(function(){return N})),r.d(t,"ProtocolEventName",(function(){return le})),r.d(t,"ProtocolParams",(function(){return bn})),r.d(t,"REDUCED_GAS_PRICE",(function(){return ne})),r.d(t,"REQUEST_COLLATERAL_EVENT",(function(){return ge})),r.d(t,"RESTORE_STATE_EVENT",(function(){return Te})),r.d(t,"Result",(function(){return O})),r.d(t,"RouterError",(function(){return j})),r.d(t,"RouterSchemas",(function(){return Tn})),r.d(t,"SETUP_EVENT",(function(){return he})),r.d(t,"SIMPLE_WITHDRAWAL_GAS_ESTIMATE",(function(){return B})),r.d(t,"StoredTransactionStatus",(function(){return wn})),r.d(t,"TAddress",(function(){return Ee})),r.d(t,"TBalance",(function(){return Ce})),r.d(t,"TBasicMeta",(function(){return Re})),r.d(t,"TBytes",(function(){return Oe})),r.d(t,"TBytes32",(function(){return xe})),r.d(t,"TChainId",(function(){return Ne})),r.d(t,"TChannelUpdate",(function(){return Je})),r.d(t,"TChannelUpdateDetails",(function(){return Ve})),r.d(t,"TChannelUpdateType",(function(){return Ke})),r.d(t,"TContractAddresses",(function(){return Pe})),r.d(t,"TCreateUpdateDetails",(function(){return $e})),r.d(t,"TDecimalString",(function(){return Ie})),r.d(t,"TDepositUpdateDetails",(function(){return We})),r.d(t,"TFullChannelState",(function(){return ze})),r.d(t,"TFullTransferState",(function(){return Le})),r.d(t,"TIntegerString",(function(){return Se})),r.d(t,"TNetworkContext",(function(){return Be})),r.d(t,"TPublicIdentifier",(function(){return ke})),r.d(t,"TRANSFER_DECREMENT",(function(){return Y})),r.d(t,"TResolveUpdateDetails",(function(){return Ge})),r.d(t,"TSetupUpdateDetails",(function(){return qe})),r.d(t,"TSignature",(function(){return Ae})),r.d(t,"TTransferMeta",(function(){return je})),r.d(t,"TUrl",(function(){return _e})),r.d(t,"TransactionEvents",(function(){return ue})),r.d(t,"TransactionReason",(function(){return En})),r.d(t,"TransferEncodingSchema",(function(){return Me})),r.d(t,"TransferEncodingsMap",(function(){return Cn})),r.d(t,"TransferNameSchema",(function(){return He})),r.d(t,"TransferNames",(function(){return Nn})),r.d(t,"TransferQuoteEncoding",(function(){return Rn})),r.d(t,"TransferQuoteSchema",(function(){return Qe})),r.d(t,"TransferResolverSchema",(function(){return Ue})),r.d(t,"TransferStateSchema",(function(){return Fe})),r.d(t,"UINT_MAX",(function(){return ee})),r.d(t,"UpdateType",(function(){return W})),r.d(t,"VectorError",(function(){return A})),r.d(t,"VectorNodeConfigSchema",(function(){return it})),r.d(t,"WITHDRAWAL_CREATED_EVENT",(function(){return be})),r.d(t,"WITHDRAWAL_RECONCILED_EVENT",(function(){return ve})),r.d(t,"WITHDRAWAL_RESOLVED_EVENT",(function(){return ye})),r.d(t,"WithdrawDataEncoding",(function(){return L})),r.d(t,"WithdrawName",(function(){return xn})),r.d(t,"WithdrawResolverEncoding",(function(){return An})),r.d(t,"WithdrawStateEncoding",(function(){return On})),r.d(t,"WithdrawalQuoteEncoding",(function(){return _n})),r.d(t,"WithdrawalQuoteSchema",(function(){return Xe})),r.d(t,"enumify",(function(){return U})),r.d(t,"getConfirmationsForChain",(function(){return ae})),r.d(t,"jsonifyError",(function(){return x})),r.d(t,"tidy",(function(){return M}));var n=r(14),o=r.n(n),c=r(1),l=r(2);var d=o.a.BN;const h=new l.b("bignumber/5.0.14"),f={},m=9007199254740991;let y=!1;class v{constructor(e,t){h.checkNew(new.target,v),e!==f&&h.throwError("cannot call constructor directly; use BigNumber.from",l.b.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return w(E(this).fromTwos(e))}toTwos(e){return w(E(this).toTwos(e))}abs(){return"-"===this._hex[0]?v.from(this._hex.substring(1)):this}add(e){return w(E(this).add(E(e)))}sub(e){return w(E(this).sub(E(e)))}div(e){return v.from(e).isZero()&&S("division by zero","div"),w(E(this).div(E(e)))}mul(e){return w(E(this).mul(E(e)))}mod(e){const t=E(e);return t.isNeg()&&S("cannot modulo negative values","mod"),w(E(this).umod(t))}pow(e){const t=E(e);return t.isNeg()&&S("cannot raise to negative values","pow"),w(E(this).pow(t))}and(e){const t=E(e);return(this.isNegative()||t.isNeg())&&S("cannot 'and' negative values","and"),w(E(this).and(t))}or(e){const t=E(e);return(this.isNegative()||t.isNeg())&&S("cannot 'or' negative values","or"),w(E(this).or(t))}xor(e){const t=E(e);return(this.isNegative()||t.isNeg())&&S("cannot 'xor' negative values","xor"),w(E(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&S("cannot mask negative values","mask"),w(E(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&S("cannot shift negative values","shl"),w(E(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&S("cannot shift negative values","shr"),w(E(this).shrn(e))}eq(e){return E(this).eq(E(e))}lt(e){return E(this).lt(E(e))}lte(e){return E(this).lte(E(e))}gt(e){return E(this).gt(E(e))}gte(e){return E(this).gte(E(e))}isNegative(){return"-"===this._hex[0]}isZero(){return E(this).isZero()}toNumber(){try{return E(this).toNumber()}catch(e){S("overflow","toNumber",this.toString())}return null}toString(){return arguments.length>0&&(10===arguments[0]?y||(y=!0,h.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?h.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",l.b.errors.UNEXPECTED_ARGUMENT,{}):h.throwError("BigNumber.toString does not accept parameters",l.b.errors.UNEXPECTED_ARGUMENT,{})),E(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof v)return e;if("string"==typeof e)return e.match(/^-?0x[0-9a-f]+$/i)?new v(f,T(e)):e.match(/^-?[0-9]+$/)?new v(f,T(new d(e))):h.throwArgumentError("invalid BigNumber string","value",e);if("number"==typeof e)return e%1&&S("underflow","BigNumber.from",e),(e>=m||e<=-m)&&S("overflow","BigNumber.from",e),v.from(String(e));const t=e;if("bigint"==typeof t)return v.from(t.toString());if(Object(c.j)(t))return v.from(Object(c.i)(t));if(t)if(t.toHexString){const e=t.toHexString();if("string"==typeof e)return v.from(e)}else{let e=t._hex;if(null==e&&"BigNumber"===t.type&&(e=t.hex),"string"==typeof e&&(Object(c.l)(e)||"-"===e[0]&&Object(c.l)(e.substring(1))))return v.from(e)}return h.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!(!e||!e._isBigNumber)}}function T(e){if("string"!=typeof e)return T(e.toString(16));if("-"===e[0])return"-"===(e=e.substring(1))[0]&&h.throwArgumentError("invalid hex","value",e),"0x00"===(e=T(e))?e:"-"+e;if("0x"!==e.substring(0,2)&&(e="0x"+e),"0x"===e)return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&"0x00"===e.substring(0,4);)e="0x"+e.substring(4);return e}function w(e){return v.from(T(e))}function E(e){const t=v.from(e).toHexString();return"-"===t[0]?new d("-"+t.substring(3),16):new d(t.substring(2),16)}function S(e,t,r){const n={fault:e,operation:t};return null!=r&&(n.value=r),h.throwError(e,l.b.errors.NUMERIC_FAULT,n)}var I=r(251),k=r(3);const x=e=>e.type?e.toJson():{message:e.message,type:e.name,context:{},stack:e.stack};class O{constructor(e,t){e?(this.isError=!0,this.error=e):(this.isError=!1,this.value=t)}getValue(){if(this.isError)throw new Error(`Can't getValue() of error result: ${this.error}`);return this.value}getError(){if(this.isError)return this.error}toJson(){return this.isError?{isError:!0,error:x(this.error)}:{isError:!1,value:this.value}}static fromJson(e){return e.isError?e.error.type?O.fail(A.fromJson(e.error)):O.fail(e.error):O.ok(e.value)}static fail(e){return new O(e)}static ok(e){return new O(void 0,e)}}class A extends Error{constructor(e,t={},r="VectorError"){super(e),this.msg=e,this.context=t,this.type=r}toJson(){return{message:this.msg,context:this.context,type:this.type,stack:this.stack}}static fromJson(e){var t,r,n;return new A(e.message,null!==(t=e.context)&&void 0!==t?t:{},null!==(n=null!==(r=e.type)&&void 0!==r?r:e.name)&&void 0!==n?n:"VectorError")}}class _ extends A{constructor(e,t={},r="MessagingError"){super(e,t,r),this.message=e,this.context=t,this.type=r}}_.reasons={Timeout:"Request timed out",Unknown:"Unknown messaging error"};class N extends A{constructor(e,t,r,n,o={},c="ProtocolError"){super(e,Object.assign(Object.assign({},o),{update:r,state:t,params:n}),c),this.msg=e,this.type=c}}class C extends A{constructor(e,t,r,n={},o="EngineError"){super(e,Object.assign(Object.assign({},n),{channelAddress:t,publicIdentifier:r}),o),this.msg=e,this.type=o}}class R extends A{constructor(e,t={},r="NodeError"){super(e,Object.assign({},t),r),this.msg=e,this.type=r}}class j extends A{constructor(e,t={},r="RouterError"){super(e,Object.assign({},t),r),this.msg=e,this.type=r}}const P={createChannelAndDepositAlice:v.from(2e5),createChannel:v.from(15e4),depositAlice:v.from(85e3),depositBob:v.from(5e4),withdraw:v.from(95e3)},B=v.from(1e5),D=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function totalSupply() external view returns (uint256)","function allowance(address owner, address spender) external view returns (uint256)","function approve(address spender, uint256 amount) external returns (bool)","function transfer(address to, uint amount) returns (boolean)","function transferFrom(address sender, address recipient, uint256 amount) external returns (bool)","event Transfer(address indexed from, address indexed to, uint amount)","event Approval(address indexed owner, address indexed spender, uint256 value)"];class F extends A{constructor(e,t={}){super(e,t,F.type),this.message=e,this.context=t,this.canRetry=Object.values(F.retryableTxErrors).includes(this.message)}}F.type="ChainError",F.reasons={ProviderNotFound:"Provider not found for chainId",SignerNotFound:"Signer not found for chainId",SenderNotInChannel:"Sender is not a channel participant",NegativeDepositAmount:"Cannot deposit a negative amount",NotEnoughFunds:"Not enough funds in wallet",FailedToDeploy:"Could not deploy vector channel",FailedToSendTx:"Failed to send transaction to chain",TransferNotRegistered:"Transfer not in registry",MissingSigs:"Channel state is not double signed",ResolverNeeded:"Transfer resolver must be provided in dispute",NotInitialState:"Transfer must be disputed with initial state",MultisigDeployed:"Multisig already deployed",TransferNotFound:"Transfer is not included in active transfers",TxNotFound:"Transaction not found",TxReverted:"Transaction reverted on chain"},F.retryableTxErrors={BadNonce:"the tx doesn't have the correct nonce",InvalidNonce:"Invalid nonce",MissingHash:"no transaction hash found in tx response",UnderpricedReplancement:"replacement transaction underpriced"};const U=e=>e,M=e=>`${e.replace(/\n/g,"").replace(/ +/g," ")}`,H=M("tuple(\n    uint256[2] amount,\n    address[2] to\n  )"),L=M("tuple(\n    address channelAddress,\n    address assetId,\n    address recipient,\n    uint256 amount,\n    uint256 nonce,\n    address callTo,\n    bytes callData\n  )"),W={create:"create",deposit:"deposit",resolve:"resolve",setup:"setup"};var $;!function(e){e[e.ChannelState=0]="ChannelState",e[e.WithdrawData=1]="WithdrawData"}($||($={}));const G=M(`tuple(\n  address channelAddress,\n  address alice,\n  address bob,\n  address[] assetIds,\n  ${H}[] balances,\n  uint256[] processedDepositsA,\n  uint256[] processedDepositsB,\n  uint256[] defundNonces,\n  uint256 timeout,\n  uint256 nonce,\n  bytes32 merkleRoot\n)`),V=M(`tuple(\n  address channelAddress,\n  bytes32 transferId,\n  address transferDefinition,\n  address initiator,\n  address responder,\n  address assetId,\n  ${H} balance,\n  uint256 transferTimeout,\n  bytes32 initialStateHash\n)`),K=86400,J=K/2,z=2*K,Q=2*K,X=Q/2,Z=7*Q,Y=4320,ee=v.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff").toString(),te=0x8ae379bfda71,re=[te],ne=Object(I.e)("125","gwei"),se=3e5,ie=3,oe=[1,1337,1338,1340,1341,1342],ae=e=>oe.includes(e)?1:ie,ce=5,le={CHANNEL_UPDATE_EVENT:"CHANNEL_UPDATE_EVENT"},ue={TRANSACTION_SUBMITTED:"TRANSACTION_SUBMITTED",TRANSACTION_MINED:"TRANSACTION_MINED",TRANSACTION_FAILED:"TRANSACTION_FAILED"},de="IS_ALIVE",he="SETUP",fe="CONDITIONAL_TRANSFER_CREATED",me="CONDITIONAL_TRANSFER_RESOLVED",pe="DEPOSIT_RECONCILED",ge="REQUEST_COLLATERAL",be="WITHDRAWAL_CREATED",ye="WITHDRAWAL_RESOLVED",ve="WITHDRAWAL_RECONCILED",Te="RESTORE_STATE_EVENT",we=Object.assign({[de]:de,[he]:he,[fe]:fe,[me]:me,[pe]:pe,[ge]:ge,[Te]:Te,[he]:he,[be]:be,[ye]:ye,[ve]:ve},ue),Ee=k.Type.RegEx(/^0x[a-fA-F0-9]{40}$/),Se=k.Type.RegEx(/^([0-9])*$/),Ie=k.Type.RegEx(/^[0-9]*\.?[0-9]*$/),ke=k.Type.RegEx(/^vector([a-zA-Z0-9]{50})$/),xe=k.Type.RegEx(/^0x([a-fA-F0-9]{64})$/),Oe=k.Type.RegEx(/^0x([a-fA-F0-9])$/),Ae=k.Type.RegEx(/^0x([a-fA-F0-9]{130})$/),_e=k.Type.String({format:"uri"}),Ne=k.Type.Number({minimum:1}),Ce=k.Type.Object({to:k.Type.Array(Ee),amount:k.Type.Array(Se)}),Re=k.Type.Optional(k.Type.Dict(k.Type.Any())),je=k.Type.Intersect([k.Type.Object({createdAt:k.Type.Number(),resolvedAt:k.Type.Optional(k.Type.Number())}),k.Type.Dict(k.Type.Any())]),Pe=k.Type.Object({channelFactoryAddress:Ee,transferRegistryAddress:Ee}),Be=k.Type.Intersect([Pe,k.Type.Object({chainId:Ne})]),De=k.Type.Object({fromChainId:Ne,toChainId:Ne,fromAssetId:Ee,toAssetId:Ee,priceType:k.Type.Union([k.Type.Literal("hardcoded")]),hardcodedRate:Ie,rebalancerUrl:k.Type.Optional(k.Type.String({format:"uri"})),rebalanceThresholdPct:k.Type.Optional(k.Type.Number({minimum:0,maximum:100})),percentageFee:k.Type.Optional(k.Type.Number({minimum:0,maximum:100})),flatFee:k.Type.Optional(Se),gasSubsidyPercentage:k.Type.Optional(k.Type.Number({minimum:0,maximum:100}))}),Fe=k.Type.Dict(k.Type.Any()),Ue=k.Type.Any(),Me=k.Type.Array(k.Type.String(),{maxItems:2,minItems:2}),He=k.Type.String(),Le=k.Type.Object({balance:Ce,assetId:Ee,channelAddress:Ee,inDispute:k.Type.Boolean(),transferId:xe,transferDefinition:Ee,transferTimeout:Se,initialStateHash:xe,initiator:Ee,responder:Ee,channelFactoryAddress:Ee,chainId:Ne,transferEncodings:Me,transferState:Fe,transferResolver:k.Type.Optional(Ue),meta:je,channelNonce:k.Type.Integer({minimum:1}),initiatorIdentifier:ke,responderIdentifier:ke}),qe=k.Type.Object({timeout:Se,networkContext:Be,meta:Re}),We=k.Type.Object({totalDepositsAlice:Se,totalDepositsBob:Se,meta:Re}),$e=k.Type.Object({transferId:xe,balance:Ce,transferDefinition:Ee,transferTimeout:Se,transferInitialState:Fe,transferEncodings:Me,merkleProofData:k.Type.Array(k.Type.String()),merkleRoot:xe,meta:Re}),Ge=k.Type.Object({transferId:xe,transferDefinition:Ee,transferResolver:Ue,merkleRoot:xe,meta:Re}),Ve=k.Type.Union([qe,We,$e,Ge]),Ke=k.Type.Union(Object.values(W).map((e=>k.Type.Literal(e)))),Je=k.Type.Object({channelAddress:Ee,fromIdentifier:ke,toIdentifier:ke,type:Ke,nonce:k.Type.Number(),balance:Ce,assetId:Ee,details:k.Type.Dict(k.Type.Any()),aliceSignature:k.Type.Optional(k.Type.Union([Ae,k.Type.Null()])),bobSignature:k.Type.Optional(k.Type.Union([Ae,k.Type.Null()]))}),ze=k.Type.Object({assetIds:k.Type.Array(Ee,{minItems:1}),balances:k.Type.Array(Ce,{minItems:1}),channelAddress:Ee,alice:Ee,bob:Ee,merkleRoot:Oe,nonce:k.Type.Number(),processedDepositsA:k.Type.Array(Se),processedDepositsB:k.Type.Array(Se),timeout:Se,aliceIdentifier:ke,bobIdentifier:ke,latestUpdate:Je,networkContext:Be,defundNonces:k.Type.Array(Se),inDispute:k.Type.Boolean()}),Qe=k.Type.Object({routerIdentifier:ke,amount:Se,assetId:Ee,chainId:Ne,recipient:ke,recipientChainId:Ne,recipientAssetId:Ee,fee:Se,expiry:Se,signature:k.Type.Optional(Ae)}),Xe=k.Type.Object({channelAddress:Ee,amount:Se,assetId:Ee,fee:Se,expiry:Se,signature:k.Type.Optional(Ae)}),Ze=k.Type.Object({amount:Se,assetId:Ee,signer:Ee,fromProvider:k.Type.String({format:"uri"}),toProvider:k.Type.String({format:"uri"}),fromChainId:Ne,toChainId:Ne}),Ye={200:k.Type.Object({allowance:k.Type.String(),transaction:k.Type.Optional(k.Type.Object({to:k.Type.String(),data:k.Type.String()}))})},et=Ze,tt={200:k.Type.Object({transaction:k.Type.Optional(k.Type.Object({to:k.Type.String(),data:k.Type.String()}))})},nt=k.Type.Object({txHash:xe,fromProvider:k.Type.String({format:"uri"}),toProvider:k.Type.String({format:"uri"}),fromChainId:Ne,toChainId:Ne,signer:Ee}),st={200:k.Type.Object({status:k.Type.Object({completed:k.Type.Boolean()}),transaction:k.Type.Optional(k.Type.Object({to:k.Type.String(),data:k.Type.String()}))})},it=k.Type.Object({adminToken:k.Type.String(),authUrl:k.Type.Optional(k.Type.String({format:"uri"})),chainAddresses:k.Type.Dict(Pe),chainProviders:k.Type.Dict(_e),dbUrl:k.Type.Optional(_e),logLevel:k.Type.Optional(k.Type.Union([k.Type.Literal("fatal"),k.Type.Literal("error"),k.Type.Literal("warn"),k.Type.Literal("info"),k.Type.Literal("debug"),k.Type.Literal("trace"),k.Type.Literal("silent")])),messagingUrl:k.Type.Optional(_e),mnemonic:k.Type.Optional(k.Type.String()),natsUrl:k.Type.Optional(_e),skipCheckIn:k.Type.Optional(k.Type.Boolean()),baseGasSubsidyPercentage:k.Type.Number({minimum:0,maximum:100})}),ot={chan_signUtilityMessage:"chan_signUtilityMessage",chan_getConfig:"chan_getConfig",chan_getRouterConfig:"chan_getRouterConfig",chan_getTransferQuote:"chan_getTransferQuote",chan_getWithdrawalQuote:"chan_getWithdrawalQuote",chan_getStatus:"chan_getStatus",chan_getChannelState:"chan_getChannelState",chan_getChannelStateByParticipants:"chan_getChannelStateByParticipants",chan_getChannelStates:"chan_getChannelStates",chan_getTransferStateByRoutingId:"chan_getTransferStateByRoutingId",chan_getTransferStatesByRoutingId:"chan_getTransferStatesByRoutingId",chan_getActiveTransfers:"chan_getActiveTransfers",chan_getRegisteredTransfers:"chan_getRegisteredTransfers",chan_getTransferState:"chan_getTransferState",chan_getTransfers:"chan_getTransfers",chan_getWithdrawalCommitment:"chan_getWithdrawalCommitment",chan_getWithdrawalCommitmentByTransactionHash:"chan_getWithdrawalCommitmentByTransactionHash",chan_setup:"chan_setup",chan_sendIsAlive:"chan_sendIsAlive",chan_requestSetup:"chan_requestSetup",chan_deposit:"chan_deposit",chan_requestCollateral:"chan_requestCollateral",chan_createTransfer:"chan_createTransfer",chan_resolveTransfer:"chan_resolveTransfer",chan_restoreState:"chan_restoreState",chan_withdraw:"chan_withdraw",chan_subscribe:"chan_subscribe",chan_unsubscribeAll:"chan_unsubscribeAll",connext_authenticate:"connext_authenticate",chan_dispute:"chan_dispute",chan_defund:"chan_defund",chan_disputeTransfer:"chan_disputeTransfer",chan_defundTransfer:"chan_defundTransfer",chan_decrypt:"chan_decrypt",chan_subscription:"chan_subscription"},at=k.Type.Object({amount:Se,assetId:Ee,channelAddress:Ee,receiveExactAmount:k.Type.Optional(k.Type.Boolean())}),ct=k.Type.Object({routerIdentifier:ke,amount:Se,assetId:Ee,chainId:Ne,recipient:k.Type.Optional(ke),recipientChainId:k.Type.Optional(Ne),recipientAssetId:k.Type.Optional(Ee),receiveExactAmount:k.Type.Optional(k.Type.Boolean())}),lt=k.Type.Object({routerIdentifier:ke}),ut=k.Type.Object({channelAddress:Ee,routingId:xe}),ht=k.Type.Object({routingId:xe}),ft=k.Type.Object({channelAddress:Ee}),mt=k.Type.Object({}),pt=k.Type.Object({alice:ke,bob:ke,chainId:Ne}),gt=k.Type.Object({channelAddress:Ee}),bt=k.Type.Object({transferId:xe}),yt=k.Type.Object({channelAddress:k.Type.Optional(Ee),startDate:k.Type.Optional(k.Type.Any()),endDate:k.Type.Optional(k.Type.Any()),active:k.Type.Optional(k.Type.Boolean()),routingId:k.Type.Optional(xe),transferDefinition:k.Type.Optional(Ee)}),vt=k.Type.Object({filterOpts:k.Type.Optional(yt)}),Tt=k.Type.Object({chainId:Ne}),wt=k.Type.Object({transferId:xe}),Et=k.Type.Object({transactionHash:xe}),St=k.Type.Object({counterpartyIdentifier:ke,chainId:Ne,timeout:k.Type.Optional(Se),meta:k.Type.Optional(Re)}),It=k.Type.Object({channelAddress:Ee,assetId:Ee,meta:k.Type.Optional(Re)}),kt=k.Type.Object({channelAddress:Ee,assetId:Ee,amount:k.Type.Optional(Se)}),xt=k.Type.Object({channelAddress:Ee,amount:Se,assetId:Ee,recipient:k.Type.Optional(ke),recipientChainId:k.Type.Optional(Ne),recipientAssetId:k.Type.Optional(Ee),timeout:k.Type.Optional(Se),meta:k.Type.Optional(Re),type:k.Type.String(),details:k.Type.Dict(k.Type.Any()),quote:k.Type.Optional(Qe)}),Ot=k.Type.Object({channelAddress:Ee,transferId:xe,meta:k.Type.Optional(Re),transferResolver:Ue}),At=k.Type.Object({channelAddress:Ee,amount:Se,assetId:Ee,recipient:Ee,timeout:k.Type.Optional(Se),quote:k.Type.Optional(Xe),callTo:k.Type.Optional(Ee),callData:k.Type.Optional(k.Type.String()),meta:k.Type.Optional(Re),initiatorSubmits:k.Type.Optional(k.Type.Boolean())}),_t=k.Type.Object({channelAddress:Ee}),Nt=k.Type.Object({channelAddress:Ee}),Ct=k.Type.Object({transferId:xe}),Rt=k.Type.Object({transferId:xe}),jt=k.Type.Object({message:k.Type.String()}),Pt=k.Type.Object({channelAddress:Ee,skipCheckIn:k.Type.Boolean()}),Bt=k.Type.Object({counterpartyIdentifier:ke,chainId:Ne}),Dt=k.Type.Object({id:k.Type.Number({minimum:1}),jsonrpc:k.Type.Literal("2.0"),method:k.Type.Union(Object.values(ot).map((e=>k.Type.Literal(e)))),params:k.Type.Optional(k.Type.Any())});var Ft;!function(e){e.RpcRequestSchema=Dt,e.GetRouterConfigSchema=lt,e.SignUtilityMessageSchema=jt,e.SendIsAliveSchema=Pt,e.GetTransferStateByRoutingIdSchema=ut,e.GetTransferStatesByRoutingIdSchema=ht,e.GetChannelStatesSchema=mt,e.GetChannelStateSchema=ft,e.GetChannelStateByParticipantsSchema=pt,e.GetActiveTransfersSchema=gt,e.GetTransferStateSchema=bt,e.GetTransfersSchema=vt,e.GetRegisteredTransfersSchema=Tt,e.GetWithdrawalCommitmentSchema=wt,e.GetWithdrawalCommitmentByTransactionHashSchema=Et,e.SetupSchema=St,e.RestoreStateSchema=Bt,e.DepositSchema=It,e.RequestCollateralSchema=kt,e.ConditionalTransferSchema=xt,e.ResolveTransferSchema=Ot,e.WithdrawSchema=At,e.DisputeChannelSchema=_t,e.DefundChannelSchema=Nt,e.DisputeTransferSchema=Ct,e.DefundTransferSchema=Rt,e.GetTransferQuoteSchema=ct,e.GetWithdrawalQuoteSchema=at}(Ft||(Ft={}));const Ut={200:k.Type.Object({channelAddress:Ee})},Mt={200:k.Type.Object({channelAddress:Ee,transferId:xe,routingId:k.Type.Optional(xe)})},Ht=k.Type.Intersect([Ft.GetWithdrawalQuoteSchema,k.Type.Object({publicIdentifier:ke})]),Lt={200:Xe},qt=k.Type.Intersect([Ft.GetTransferQuoteSchema,k.Type.Object({publicIdentifier:ke})]),Wt={200:Qe},$t=k.Type.Intersect([Ft.GetRouterConfigSchema,k.Type.Object({publicIdentifier:ke})]),Gt={200:k.Type.Object({supportedChains:k.Type.Array(Ne),allowedSwaps:k.Type.Array(De)})},Vt=k.Type.Intersect([Ft.GetTransferStateByRoutingIdSchema,k.Type.Object({publicIdentifier:ke})]),Kt={200:k.Type.Union([k.Type.Undefined(),Le])},Jt=k.Type.Intersect([Ft.GetTransferStatesByRoutingIdSchema,k.Type.Object({publicIdentifier:ke})]),zt={200:k.Type.Array(Le)},Qt=k.Type.Intersect([Ft.GetActiveTransfersSchema,k.Type.Object({publicIdentifier:ke})]),Xt={200:k.Type.Array(Le)},Zt=k.Type.Intersect([Ft.GetTransferStateSchema,k.Type.Object({publicIdentifier:ke})]),Yt={200:k.Type.Union([k.Type.Undefined(),Le])},er=k.Type.Object({publicIdentifier:ke}),rr={200:k.Type.Array(Le)},nr=k.Type.Intersect([Ft.GetChannelStateSchema,k.Type.Object({publicIdentifier:ke})]),sr={200:k.Type.Union([k.Type.Undefined(),ze])},ir=k.Type.Intersect([Ft.GetChannelStatesSchema,k.Type.Object({publicIdentifier:ke})]),or={200:k.Type.Array(Ee)},ar=k.Type.Object({publicIdentifier:ke,counterparty:ke,chainId:Ne}),cr=sr,lr={200:k.Type.Array(k.Type.Object({publicIdentifier:ke,signerAddress:Ee,index:k.Type.Integer(),chainAddresses:k.Type.Dict(Pe)}))},ur={200:k.Type.Object({publicIdentifier:ke,signerAddress:Ee,providerSyncing:k.Type.Dict(k.Type.Union([k.Type.Boolean(),k.Type.Object({startingBlock:k.Type.String(),currentBlock:k.Type.String(),highestBlock:k.Type.String()}),k.Type.String(),k.Type.Undefined()])),version:k.Type.String()})},dr=k.Type.Object({eventName:k.Type.Union(Object.values(we).map((e=>k.Type.Literal(e)))),publicIdentifier:ke}),fr={200:k.Type.Object({url:_e})},mr=k.Type.Object({publicIdentifier:ke}),pr={200:k.Type.Dict(_e)},gr=k.Type.Intersect([Ft.GetRegisteredTransfersSchema,k.Type.Object({publicIdentifier:ke})]),yr={200:k.Type.Array(k.Type.Object({name:k.Type.String(),stateEncoding:k.Type.String(),resolverEncoding:k.Type.String(),definition:Ee,encodedCancel:k.Type.String()}))},vr=k.Type.Intersect([Ft.GetWithdrawalCommitmentSchema,k.Type.Object({publicIdentifier:ke})]),Tr={200:k.Type.Union([k.Type.Undefined(),k.Type.Object({aliceSignature:k.Type.Optional(Ae),bobSignature:k.Type.Optional(Ae),channelAddress:Ee,alice:Ee,bob:Ee,recipient:Ee,assetId:Ee,amount:Se,nonce:Se,callTo:Ee,callData:Oe,transactionHash:k.Type.Optional(xe)})])},wr=k.Type.Intersect([Ft.GetWithdrawalCommitmentByTransactionHashSchema,k.Type.Object({publicIdentifier:ke})]),Er={200:k.Type.Union([k.Type.Undefined(),k.Type.Object({aliceSignature:k.Type.Optional(Ae),bobSignature:k.Type.Optional(Ae),channelAddress:Ee,alice:Ee,bob:Ee,recipient:Ee,assetId:Ee,amount:Se,nonce:Se,callTo:Ee,callData:Oe,transactionHash:k.Type.Optional(xe)})])},Sr=k.Type.Object({publicIdentifier:ke,events:k.Type.Dict(k.Type.String())}),Ir={200:k.Type.Object({message:k.Type.String()})},kr=k.Type.Intersect([Ft.SetupSchema,k.Type.Object({publicIdentifier:ke})]),xr=Ut,Or=kr,Ar=Ut,_r=k.Type.Intersect([Ft.DepositSchema,k.Type.Object({publicIdentifier:ke})]),Nr=Ut,Cr=k.Type.Intersect([Ft.RequestCollateralSchema,k.Type.Object({publicIdentifier:ke})]),Rr=Ut,jr=k.Type.Object({channelAddress:Ee,amount:Se,assetId:Ee,chainId:Ne,publicIdentifier:ke}),Pr={200:k.Type.Object({txHash:xe})},Br=k.Type.Intersect([Ft.ConditionalTransferSchema,k.Type.Object({publicIdentifier:ke})]),Dr=Mt,Fr=k.Type.Intersect([Ft.ResolveTransferSchema,k.Type.Object({publicIdentifier:ke})]),Ur=Mt,Mr=k.Type.Intersect([Ft.WithdrawSchema,k.Type.Object({publicIdentifier:ke})]),Hr={200:k.Type.Object({channelAddress:Ee,transferId:xe,transactionHash:k.Type.Optional(xe),transaction:k.Type.Object({to:Ee,value:Se,data:k.Type.String()})})},Lr=k.Type.Intersect([Ft.SignUtilityMessageSchema,k.Type.Object({publicIdentifier:ke})]),qr={200:k.Type.Object({signedMessage:k.Type.String()})},Wr=k.Type.Intersect([Ft.RestoreStateSchema,k.Type.Object({publicIdentifier:ke})]),$r={200:k.Type.Object({channelAddress:Ee})},Gr=k.Type.Object({index:k.Type.Integer({minimum:0,maximum:2147483647}),mnemonic:k.Type.Optional(k.Type.String()),skipCheckIn:k.Type.Optional(k.Type.Boolean())}),Vr={200:k.Type.Object({publicIdentifier:ke,signerAddress:Ee,index:k.Type.Integer()})},Kr=k.Type.Object({adminToken:k.Type.String({example:"cxt1234",description:"Admin token"})}),Jr={200:k.Type.Object({message:k.Type.String()})},zr=k.Type.Object({adminToken:k.Type.String(),transferId:xe}),Qr={200:k.Type.Object({transferId:xe,transactionHash:k.Type.String()})},Xr=k.Type.Object({adminToken:k.Type.String()}),Zr={200:k.Type.Dict(k.Type.Union([k.Type.Array(k.Type.Object({transactionHash:k.Type.String(),transferId:xe,channelAddress:Ee})),k.Type.Object({message:k.Type.String(),type:k.Type.String(),context:k.Type.Dict(k.Type.Any()),stack:k.Type.String()})]))},Yr=k.Type.Intersect([Ft.DisputeChannelSchema,k.Type.Object({publicIdentifier:ke})]),en={200:k.Type.Object({txHash:xe})},tn=k.Type.Intersect([Ft.DefundChannelSchema,k.Type.Object({publicIdentifier:ke})]),rn={200:k.Type.Object({txHash:xe})},nn=k.Type.Intersect([Ft.DisputeTransferSchema,k.Type.Object({publicIdentifier:ke})]),sn={200:k.Type.Object({txHash:xe})},on=k.Type.Intersect([Ft.DefundTransferSchema,k.Type.Object({publicIdentifier:ke})]),an={200:k.Type.Object({txHash:xe})},cn=k.Type.Intersect([Ft.SendIsAliveSchema,k.Type.Object({publicIdentifier:ke})]),ln={200:k.Type.Object({channelAddress:Ee})};var un,dn,hn;(dn=un||(un={})).GetStatusSchema=k.Type.Object({}),dn.WithdrawalQuoteSchema=Ht,dn.TransferQuoteSchema=qt,dn.GetRouterConfigSchema=$t,dn.GetTransferStateByRoutingIdSchema=Vt,dn.GetTransferStatesByRoutingIdSchema=Jt,dn.GetTransferStateSchema=Zt,dn.GetTransfersSchema=er,dn.GetActiveTransfersByChannelAddressSchema=Qt,dn.GetChannelStateSchema=nr,dn.GetChannelStatesSchema=ir,dn.GetChannelStateByParticipantsSchema=ar,dn.GetListenerSchema=dr,dn.GetListenersSchema=mr,dn.GetRegisteredTransfersSchema=gr,dn.GetWithdrawalCommitmentSchema=vr,dn.GetWithdrawalCommitmentByTransactionHashSchema=wr,dn.GetConfigSchema=k.Type.Object({}),dn.SetupSchema=kr,dn.RequestSetupSchema=Or,dn.DepositSchema=_r,dn.RequestCollateralSchema=Cr,dn.SendDepositTxSchema=jr,dn.ConditionalTransferSchema=Br,dn.ResolveTransferSchema=Fr,dn.WithdrawSchema=Mr,dn.RegisterListenerSchema=Sr,dn.SignUtilityMessageSchema=Lr,dn.RestoreStateSchema=Wr,dn.AdminSchema=Kr,dn.CreateNodeSchema=Gr,dn.SendDisputeChannelTxSchema=Yr,dn.SendDefundChannelTxSchema=tn,dn.SendDisputeTransferTxSchema=nn,dn.SendDefundTransferTxSchema=on,dn.SendIsAliveSchema=cn,dn.RetryWithdrawTransactionSchema=zr,dn.SubmitWithdrawalsSchema=Xr,function(e){e.WithdrawalQuoteSchema=Lt,e.TransferQuoteSchema=Wt,e.GetRouterConfigSchema=Gt,e.GetTransferStateByRoutingIdSchema=Kt,e.GetTransferStatesByRoutingIdSchema=zt,e.GetTransferStateSchema=Yt,e.GetTransfersSchema=rr,e.GetActiveTransfersByChannelAddressSchema=Xt,e.GetChannelStateSchema=sr,e.GetChannelStateByParticipantsSchema=cr,e.GetChannelStatesSchema=or,e.GetListenerSchema=fr,e.GetListenersSchema=pr,e.GetConfigSchema=lr,e.GetStatusSchema=ur,e.GetRegisteredTransfersSchema=yr,e.GetWithdrawalCommitmentSchema=Tr,e.GetWithdrawalCommitmentByTransactionHashSchema=Er,e.SetupSchema=xr,e.RequestSetupSchema=Ar,e.DepositSchema=Nr,e.RequestCollateralSchema=Rr,e.SendDepositTxSchema=Pr,e.ConditionalTransferSchema=Dr,e.ResolveTransferSchema=Ur,e.WithdrawSchema=Hr,e.RegisterListenerSchema=Ir,e.SignUtilityMessageSchema=qr,e.RestoreStateSchema=$r,e.AdminSchema=Jr,e.CreateNodeSchema=Vr,e.SendDisputeChannelTxSchema=en,e.SendDefundChannelTxSchema=rn,e.SendDisputeTransferTxSchema=sn,e.SendDefundTransferTxSchema=an,e.SendIsAliveSchema=ln,e.RetryWithdrawTransactionSchema=Qr,e.SubmitWithdrawalsSchema=Zr}(hn||(hn={}));const fn=k.Type.Object({timeout:Se,networkContext:Be,counterpartyIdentifier:ke,meta:k.Type.Optional(Re)}),mn=k.Type.Object({channelAddress:Ee,assetId:Ee,meta:k.Type.Optional(Re)}),pn=k.Type.Object({channelAddress:Ee,balance:Ce,assetId:Ee,transferDefinition:Ee,transferInitialState:Fe,timeout:Se,meta:k.Type.Optional(Re)}),gn=k.Type.Object({channelAddress:Ee,transferId:xe,transferResolver:Ue,meta:k.Type.Optional(Re)});var bn;!function(e){e.SetupSchema=fn,e.DepositSchema=mn,e.CreateSchema=pn,e.ResolveSchema=gn}(bn||(bn={}));const yn=k.Type.Object({recipient:ke,recipientChainId:Ne,recipientAssetId:Ee}),vn=k.Type.Object({routingId:xe,requireOnline:k.Type.Boolean(),path:k.Type.Array(yn),quote:k.Type.Optional(Qe)});var Tn;!function(e){e.RouterMeta=vn}(Tn||(Tn={}));const wn={submitted:"submitted",mined:"mined",failed:"failed"},En={allowance:"allowance",approveTokens:"approveTokens",disputeChannel:"disputeChannel",disputeTransfer:"disputeTransfer",defundChannel:"defundChannel",defundTransfer:"defundTransfer",depositA:"depositA",depositB:"depositB",deploy:"deploy",deployWithDepositAlice:"deployWithDepositAlice",transferTokens:"transferTokens",withdraw:"withdraw"},Sn="HashlockTransfer",In=M("tuple(\n    bytes32 lockHash,\n    uint256 expiry\n  )"),kn=M("tuple(\n    bytes32 preImage\n  )"),xn="Withdraw",On=M("tuple(\n    bytes initiatorSignature,\n    address initiator,\n    address responder,\n    bytes32 data,\n    uint256 nonce,\n    uint256 fee,\n    address callTo,\n    bytes callData\n  )"),An=M("tuple(\n    bytes responderSignature\n  )"),_n=M("tuple(\n  address channelAddress,\n  uint256 amount,\n  address assetId,\n  uint256 fee,\n  uint256 expiry\n)"),Nn={[Sn]:Sn,[xn]:xn},Cn={[Sn]:[In,kn],[xn]:[On,An]},Rn=M("tuple(\n  string routerIdentifier,\n  uint256 amount,\n  address assetId,\n  uint256 chainId,\n  string recipient,\n  uint256 recipientChainId,\n  address recipientAssetId,\n  uint256 fee,\n  uint256 expiry\n)")},2722:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var p in e)"default"===p||Object.prototype.hasOwnProperty.call(t,p)||n(t,e,p)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(2723),t),o(r(989),t),o(r(2724),t),o(r(2767),t),o(r(2768),t),o(r(2769),t),o(r(990),t),o(r(382),t)},2723:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTestTxReceipt=t.createTestTxResponse=void 0;const n=r(96),o=r(382);t.createTestTxResponse=(e={})=>{var r,c,l,d,h;const f=null!==(r=e.to)&&void 0!==r?r:o.mkAddress("0x1111"),m=null!==(c=e.from)&&void 0!==c?c:o.mkAddress("0x2222"),y=null!==(l=e.hash)&&void 0!==l?l:o.mkHash("0xade134"),v=null!==(d=e.blockHash)&&void 0!==d?d:o.mkHash("0xbbbbb"),T=null!==(h=e.blockNumber)&&void 0!==h?h:487;return Object.assign({hash:y,to:f,from:m,data:o.mkHash(),value:n.BigNumber.from(10),chainId:1,nonce:43,gasLimit:n.BigNumber.from(123576),gasPrice:n.BigNumber.from(1657639),timestamp:Date.now(),raw:o.mkHash(),blockHash:v,blockNumber:T,confirmations:0,wait:()=>Promise.resolve(t.createTestTxReceipt({transactionHash:y,to:f,from:m,contractAddress:f,blockHash:v,blockNumber:T}))},e)};t.createTestTxReceipt=(e={})=>Object.assign({transactionHash:o.mkHash("0xaecb"),to:o.mkAddress("0x1111"),from:o.mkAddress("0x2222"),blockHash:o.mkHash("0xbbbbb"),blockNumber:487,contractAddress:o.mkAddress("0xcccc"),transactionIndex:3,root:o.mkHash(),gasUsed:n.BigNumber.from(1657639),logsBloom:"logs",logs:[],cumulativeGasUsed:n.BigNumber.from(1657639),byzantium:!0,confirmations:15},e)},2724:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expect=void 0;const o=r(991),c=n(r(2747)),l=n(r(2748)),d=r(2749);o.use(l.default),o.use(c.default),o.use(d.waffleChai);var h=r(991);Object.defineProperty(t,"expect",{enumerable:!0,get:function(){return h.expect}})},2767:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getTestLoggers=void 0;const o=n(r(455));t.getTestLoggers=(e,t="info",r=20,n=200)=>{const c=o.default({level:t,name:e});return{log:c,timer:e=>t=>{const o=Date.now()-e;o<r?c.debug(t):o<n?c.info(t):c.warn(t)}}}},2768:function(e,t,r){"use strict";var n=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(t,"__esModule",{value:!0}),t.createVectorChannelMessage=void 0;const o=r(27),c=r(989),l=r(382);t.createVectorChannelMessage=function(e={}){var t,r,d,h,f,m;const{data:data}=e,y=n(e,["data"]),v=Object.assign({},c.createTestChannelUpdate(null!==(r=null===(t=null==data?void 0:data.update)||void 0===t?void 0:t.type)&&void 0!==r?r:o.UpdateType.setup,null==data?void 0:data.update)),T=(null==data?void 0:data.latestUpdate)&&Object.assign({},c.createTestChannelUpdate(null!==(h=null===(d=null==data?void 0:data.latestUpdate)||void 0===d?void 0:d.type)&&void 0!==h?h:o.UpdateType.setup,null==data?void 0:data.latestUpdate));return Object.assign({to:l.mkPublicIdentifier("vectorBBB"),from:l.mkPublicIdentifier("vectorAAA"),inbox:"test_inbox",data:{update:Object.assign(Object.assign({},v),{fromIdentifier:null!==(f=y.from)&&void 0!==f?f:v.fromIdentifier,toIdentifier:null!==(m=y.to)&&void 0!==m?m:v.toIdentifier}),latestUpdate:T}},y)}},2769:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var p in e)"default"===p||Object.prototype.hasOwnProperty.call(t,p)||n(t,e,p)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(951),t),o(r(2770),t),o(r(2771),t)},2770:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryMessagingService=void 0;const o=r(27),c=r(213),l=r(319);t.MemoryMessagingService=class{constructor(){this.evt=c.Evt.create()}flush(){throw new Error("Method not implemented.")}connect(){return n(this,void 0,void 0,(function*(){}))}disconnect(){return n(this,void 0,void 0,(function*(){this.evt.detach()}))}sendProtocolMessage(e,t,r=2e4,c=0){return n(this,void 0,void 0,(function*(){const n=l.getRandomBytes32(),c=this.evt.pipe((e=>e.inbox===n)).waitFor(r);this.evt.post({to:e.toIdentifier,from:e.fromIdentifier,replyTo:n,data:{update:e,previousUpdate:t}});const d=yield c;return d.data.error?o.Result.fail(d.data.error):o.Result.ok({update:d.data.update,previousUpdate:d.data.previousUpdate})}))}respondToProtocolMessage(e,t,r){return n(this,void 0,void 0,(function*(){this.evt.post({inbox:e,data:{update:t,previousUpdate:r},from:t.toIdentifier})}))}respondWithProtocolError(e,t){return n(this,void 0,void 0,(function*(){this.evt.post({inbox:e,data:{error:t},from:t.context.update.toIdentifier})}))}onReceiveProtocolMessage(e,t){return n(this,void 0,void 0,(function*(){this.evt.pipe((({to:t})=>t===e)).attach((({data:data,replyTo:e,from:r})=>{t(o.Result.ok({previousUpdate:data.previousUpdate,update:data.update}),r,e)}))}))}sendSetupMessage(e,t,r,n,o){throw new Error("Method not implemented.")}onReceiveSetupMessage(e,t){throw new Error("Method not implemented.")}respondToSetupMessage(e,t){throw new Error("Method not implemented.")}sendRequestCollateralMessage(e,t,r,n,o){throw new Error("Method not implemented.")}onReceiveRequestCollateralMessage(e,t){throw new Error("Method not implemented.")}respondToRequestCollateralMessage(e,t){throw new Error("Method not implemented.")}sendRestoreStateMessage(e,t,r,n,o){throw new Error("Method not implemented.")}onReceiveRestoreStateMessage(e,t){throw new Error("Method not implemented.")}respondToRestoreStateMessage(e,t){throw new Error("Method not implemented.")}respondToLockMessage(e,t){throw new Error("Method not implemented.")}onReceiveLockMessage(e,t){throw new Error("Method not implemented.")}sendLockMessage(e,t,r,n,o){throw new Error("Method not implemented.")}sendIsAliveMessage(e,t,r,n,o){throw new Error("Method not implemented.")}onReceiveIsAliveMessage(e,t){throw new Error("Method not implemented.")}respondToIsAliveMessage(e,t){throw new Error("Method not implemented.")}sendRouterConfigMessage(e,t,r,n,o){throw new Error("Method not implemented")}sendTransferQuoteMessage(e,t,r,n,o){throw new Error("Method not implemented.")}onReceiveWithdrawalQuoteMessage(e,t){throw new Error("Method not implemented.")}sendWithdrawalQuoteMessage(e,t,r,n,o){throw new Error("Method not implemented.")}respondToWithdrawalQuoteMessage(e,t){throw new Error("Method not implemented.")}subscribe(e,t){return n(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}request(e,t,data){throw new Error("Method not implemented.")}publish(e,data){return n(this,void 0,void 0,(function*(){throw new Error("Method not implemented.")}))}unsubscribe(e){throw new Error("Method not implemented.")}}},2771:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStoreService=void 0;t.MemoryStoreService=class{constructor(){this.transfersInChannel=new Map,this.transfers=new Map,this.channelStates=new Map,this.schemaVersion=void 0,this.transferDisputes=new Map,this.channelDisputes=new Map}getWithdrawalCommitmentByTransactionHash(e){throw new Error("Method not implemented.")}saveChannelDispute(e,t,r){this.channelDisputes.set(e.channelAddress,t);const n=this.channelStates.get(e.channelAddress);if(n&&this.channelStates.set(e.channelAddress,Object.assign(Object.assign({},n),{inDispute:e.inDispute})),r&&this.transfers.has(r.transferId)){this.transferDisputes.set(r.transferId,r);const e=this.transfers.get(r.transferId);this.transfers.set(e.transferId,Object.assign(Object.assign({},e),{inDispute:!0}))}return Promise.resolve()}getTransactionByHash(e){return Promise.resolve(void 0)}saveTransactionFailure(e,t,r){return Promise.resolve(void 0)}saveTransactionReceipt(e,t){return Promise.resolve(void 0)}saveTransactionResponse(e,t,r){return Promise.resolve(void 0)}connect(){return Promise.resolve()}disconnect(){return Promise.resolve()}clear(){return this.channelStates.clear(),this.transfersInChannel.clear(),this.transfers.clear(),Promise.resolve()}getChannelState(e){const t=this.channelStates.get(e);return Promise.resolve(t)}getChannelStateByParticipants(e,t,r){return Promise.resolve([...this.channelStates.values()].find((r=>{r.alice===e&&r.bob===t&&r.networkContext.chainId})))}getChannelStates(){return Promise.resolve([...this.channelStates.values()])}saveChannelState(e,t){var r;if(this.channelStates.set(e.channelAddress,Object.assign({},e)),!t)return Promise.resolve();this.transfers.set(t.transferId,t);const n=null!==(r=this.transfersInChannel.get(e.channelAddress))&&void 0!==r?r:[];return t.transferResolver?(this.transfersInChannel.set(e.channelAddress,n.filter((e=>e!==t.transferId))),Promise.resolve()):(this.transfersInChannel.set(e.channelAddress,[...n,t.transferId]),Promise.resolve())}saveChannelStateAndTransfers(e,t){return Promise.reject("Method not implemented")}getActiveTransfers(e){var t;const r=[...null!==(t=this.transfersInChannel.get(e))&&void 0!==t?t:[]].map((e=>this.transfers.get(e))).filter((e=>!!e));return Promise.resolve(r)}getTransferState(e){return Promise.resolve(this.transfers.get(e))}getTransfersByRoutingId(e){throw new Error("getTransfersByRoutingId not implemented.")}getTransfers(e){throw new Error("Method not implemented.")}getSchemaVersion(){return Promise.resolve(this.schemaVersion)}updateSchemaVersion(e){return this.schemaVersion=e,Promise.resolve()}getWithdrawalCommitment(e){return Promise.resolve(void 0)}saveWithdrawalCommitment(e,t){return Promise.resolve()}getTransferByRoutingId(e,t){return Promise.resolve(void 0)}}},2772:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(t,"__esModule",{value:!0}),t.validateChannelUpdateSignatures=void 0;const c=r(27),l=r(929),d=r(376);t.validateChannelUpdateSignatures=function(e,t,r,h="both",f){return n(this,void 0,void 0,(function*(){const m=(e,details={},t="info")=>{f&&f[t](details,e)},{networkContext:y}=e,v=o(e,["networkContext"]);let T;try{T=l.hashChannelCommitment(v)}catch(e){return c.Result.fail(new Error("Failed to generate channel commitment hash"))}const w=(t,r)=>n(this,void 0,void 0,(function*(){if(m("Attempting recovery",{hash:T,sig:t},"debug"),!t)return"No signature provided";let n;try{n=yield d.recoverAddressFromChannelMessage(T,t)}catch(o){m("Recovery failed",{hash:T,sig:t,recoveryError:o.message,expectedSigner:r,state:e},"error"),n=o.message}return n})),[E,S]=yield Promise.all([w(t,e.alice),w(r,e.bob)]),I=E===e.alice,k=S===e.bob,x="bob"===h||"both"===h,O="alice"===h||"both"===h;if(O&&x&&I&&k)return c.Result.ok(void 0);if(O&&I&&!r&&!x)return c.Result.ok(void 0);if(x&&k&&!t&&!O)return c.Result.ok(void 0);if(t&&I&&r&&k)return c.Result.ok(void 0);const A=`Expected ${"both"===h?"alice + bob":h} ${O?e.alice:""}${x?" + "+e.bob:""}. Got: `,details=`${O?"(alice) "+E:""}${x?"+ (bob) "+S:""}`;return c.Result.fail(new Error(A+details))}))}},2773:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(t,"__esModule",{value:!0}),t.testStore=void 0;const c=r(27),l=r(50);t.testStore=(e,t,r=!1)=>{describe(e,(()=>{let e;before((()=>n(void 0,void 0,void 0,(function*(){e=t()})))),beforeEach((()=>n(void 0,void 0,void 0,(function*(){yield e.clear()})))),after((()=>n(void 0,void 0,void 0,(function*(){yield e.disconnect()})))),describe("saveChannelStateAndTransfers",(()=>{it("saveChannelStateAndTransfers removes previous state",(()=>n(void 0,void 0,void 0,(function*(){const{channel:t,transfer:r}=l.createTestChannelState("create",{nonce:10},{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")}});yield e.saveChannelState(t,r);const n=yield e.getChannelState(t.channelAddress);l.expect(n).to.deep.eq(t);const{channel:o,transfer:c}=l.createTestChannelState("create",{nonce:9},{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")}});yield e.saveChannelStateAndTransfers(o,[c]);const d=yield e.getChannelState(t.channelAddress);l.expect(d).to.deep.eq(o)})))),it("saveChannelStateAndTransfers should work when provided with transfers",(()=>n(void 0,void 0,void 0,(function*(){const{channel:t,transfer:r}=l.createTestChannelState("create",{},{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")}}),n=r.channelNonce,o=Array(5).fill(0).map(((e,t)=>Object.assign(Object.assign({},r),{transferId:l.getRandomBytes32(),channelNonce:n+t,meta:{routingId:l.getRandomBytes32()}})));yield e.saveChannelStateAndTransfers(t,o);const c=yield e.getChannelState(t.channelAddress);l.expect(c).to.be.deep.eq(t);for(const t of o){const r=yield e.getTransferState(t.transferId);l.expect(r).to.be.deep.eq(t)}l.expect((yield e.getActiveTransfers(t.channelAddress)).sort(((a,b)=>a.channelNonce-b.channelNonce))).to.be.deep.eq(o.sort(((a,b)=>a.channelNonce-b.channelNonce)));const d=Object.assign(Object.assign({},t),{nonce:30}),h=o.map(((e,t)=>Object.assign(Object.assign({},e),{channelNonce:30+t,meta:{routingId:l.getRandomBytes32()}}))).slice(0,3);yield e.saveChannelStateAndTransfers(d,h);const f=yield e.getChannelState(d.channelAddress);l.expect(f).to.be.deep.eq(d);for(const t of h){const r=yield e.getTransferState(t.transferId);l.expect(r).to.be.deep.eq(t)}l.expect((yield e.getActiveTransfers(d.channelAddress)).sort(((a,b)=>a.channelNonce-b.channelNonce))).to.be.deep.eq(h.sort(((a,b)=>a.channelNonce-b.channelNonce)))})))),it("saveChannelStateAndTransfers should work when provided with no active transfers",(()=>n(void 0,void 0,void 0,(function*(){const{channel:t}=l.createTestChannelState("create",void 0,{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")}});yield e.saveChannelStateAndTransfers(t,[]);const r=yield e.getChannelState(t.channelAddress);l.expect(r).to.be.deep.eq(t)}))))})),describe("getActiveTransfers",(()=>{it("should get active transfers for different channels",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkAddress("0xaaa"),r=l.createTestChannelState("create",{channelAddress:t},{transferId:l.mkHash("0x123"),meta:{routingId:l.mkHash("0x123")}});yield e.saveChannelState(r.channel,r.transfer);const n=l.createTestChannelState("create",{channelAddress:t,nonce:r.channel.nonce+1},{transferId:l.mkHash("0x456"),meta:{routingId:l.mkHash("0x456")}});yield e.saveChannelState(n.channel,n.transfer);const o=l.mkAddress("0xbbb"),c=l.createTestChannelState("create",{channelAddress:o,bob:l.mkAddress("0xbaba"),bobIdentifier:l.mkPublicIdentifier("vectorABCD")},{transferId:l.mkHash("0x789"),meta:{routingId:l.mkHash("0x789")}});yield e.saveChannelState(c.channel,c.transfer);const d=yield e.getChannelState(r.channel.channelAddress);l.expect(d).to.deep.eq(n.channel);const h=yield e.getActiveTransfers(r.channel.channelAddress);l.expect(h.length).eq(2);const f=h.find((e=>e.transferId===r.transfer.transferId)),m=h.find((e=>e.transferId===n.transfer.transferId));l.expect(f).to.deep.eq(r.transfer),l.expect(m).to.deep.eq(n.transfer);const y=(yield e.getActiveTransfers(c.channel.channelAddress)).find((e=>e.transferId===c.transfer.transferId));l.expect(y).to.deep.eq(c.transfer)})))),it("should consider resolved transfers",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkAddress("0xaaa"),r=l.createTestChannelState("create",{channelAddress:t},{transferId:l.mkHash("0x123"),meta:{routingId:l.mkHash("0x123")}});yield e.saveChannelState(r.channel,r.transfer);const n=l.createTestChannelState("create",{channelAddress:t,nonce:r.channel.nonce+1},{transferId:l.mkHash("0x456"),meta:{routingId:l.mkHash("0x456")}});yield e.saveChannelState(n.channel,n.transfer);const o=l.createTestChannelState("resolve",{channelAddress:t,nonce:n.channel.nonce+1},{transferId:l.mkHash("0x456"),meta:{routingId:l.mkHash("0x456")}});yield e.saveChannelState(o.channel,o.transfer);const c=l.mkAddress("0xbbb"),d=l.createTestChannelState("create",{channelAddress:c,bob:l.mkAddress("0xbaba"),bobIdentifier:l.mkPublicIdentifier("vectorABCD")},{transferId:l.mkHash("0x789"),meta:{routingId:l.mkHash("0x789")}});yield e.saveChannelState(d.channel,d.transfer);const h=yield e.getChannelState(r.channel.channelAddress);l.expect(h).to.deep.eq(o.channel);const f=yield e.getActiveTransfers(r.channel.channelAddress);l.expect(f.length).eq(1);const m=f.find((e=>e.transferId===r.transfer.transferId));l.expect(m).to.deep.eq(r.transfer);const y=(yield e.getActiveTransfers(d.channel.channelAddress)).find((e=>e.transferId===d.transfer.transferId));l.expect(y).to.deep.eq(d.transfer)}))))})),describe("getTransfers",(()=>{it("should work with and without filter",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkAddress("0xaaa"),r=l.createTestChannelState("create",{channelAddress:t},{transferId:l.mkHash("0x123"),transferDefinition:l.mkAddress("0xabc"),meta:{routingId:l.mkHash("0x123")}});yield e.saveChannelState(r.channel,r.transfer),yield l.delay(100);const n=new Date;yield l.delay(100);const o=l.createTestChannelState("create",{channelAddress:t,nonce:r.channel.nonce+1},{transferId:l.mkHash("0x456"),meta:{routingId:l.mkHash("0x456")}});yield e.saveChannelState(o.channel,o.transfer);const c=l.createTestChannelState("resolve",{channelAddress:t,nonce:o.channel.nonce+1},{transferId:l.mkHash("0x456"),meta:{routingId:l.mkHash("0x456")}});yield e.saveChannelState(c.channel,c.transfer),yield l.delay(100);const d=new Date;yield l.delay(100);const h=l.mkAddress("0xbbb"),f=l.createTestChannelState("create",{channelAddress:h,bob:l.mkAddress("0xbaba"),bobIdentifier:l.mkPublicIdentifier("vectorABCD")},{transferId:l.mkHash("0x789"),meta:{routingId:l.mkHash("0x789")}});yield e.saveChannelState(f.channel,f.transfer);const m=yield e.getTransfers();l.expect(m.length).to.eq(3),l.expect(m).to.deep.contain(r.transfer),l.expect(m).to.deep.contain(Object.assign(Object.assign({},o.transfer),{transferResolver:c.transfer.transferResolver})),l.expect(m).to.deep.contain(f.transfer);const y=yield e.getTransfers({channelAddress:t});l.expect(y.length).to.eq(2),l.expect(y).to.deep.contain(r.transfer),l.expect(y).to.deep.contain(Object.assign(Object.assign({},o.transfer),{transferResolver:c.transfer.transferResolver}));const v=yield e.getTransfers({startDate:d});l.expect(v.length).to.eq(1),l.expect(v).to.deep.contain(f.transfer);const T=yield e.getTransfers({endDate:n});l.expect(T.length).to.eq(1),l.expect(T).to.deep.contain(r.transfer);const w=yield e.getTransfers({startDate:n,endDate:d});l.expect(w.length).to.eq(1),l.expect(w).to.deep.contain(Object.assign(Object.assign({},o.transfer),{transferResolver:c.transfer.transferResolver}));const E=yield e.getTransfers({transferDefinition:r.transfer.transferDefinition});l.expect(E.length).to.be.eq(1),l.expect(E[0]).to.be.deep.eq(r.transfer)}))))})),describe("getChannelStateByParticipants",(()=>{it("should work (regardless of order)",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("deposit").channel;yield e.saveChannelState(t),l.expect(yield e.getChannelStateByParticipants(t.aliceIdentifier,t.bobIdentifier,t.networkContext.chainId)).to.be.deep.eq(t),l.expect(yield e.getChannelStateByParticipants(t.bobIdentifier,t.aliceIdentifier,t.networkContext.chainId)).to.be.deep.eq(t)}))))})),describe("getTransferByRoutingId",(()=>{it("should work",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("create",{},{meta:{routingId:l.getRandomBytes32()}});yield e.saveChannelState(t.channel,t.transfer),l.expect(yield e.getTransferByRoutingId(t.channel.channelAddress,t.transfer.meta.routingId)).to.be.deep.eq(t.transfer)}))))})),describe("getChannelStates",(()=>{it("should return all channel states",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("deposit",{channelAddress:l.mkAddress("0xccc1111"),aliceIdentifier:l.mkPublicIdentifier("vectorA"),alice:l.mkAddress("0xa")}).channel;t.latestUpdate.channelAddress=l.mkAddress("0xccc1111");const r=l.createTestChannelState("deposit",{channelAddress:l.mkAddress("0xccc2222"),aliceIdentifier:l.mkPublicIdentifier("vectorB"),alice:l.mkAddress("0xb")}).channel;r.latestUpdate.channelAddress=l.mkAddress("0xccc2222"),yield Promise.all([t,r].map((t=>e.saveChannelState(t))));const n=yield e.getChannelStates();l.expect(n).to.be.deep.include(t),l.expect(n).to.be.deep.include(r),l.expect(n.length).to.be.eq(2)}))))})),describe("getWithdrawalCommitment / getWithdrawalCommitmentByTransactionHash / saveWithdrawalCommitment",(()=>{if(r){const t=l.getRandomChannelSigner(),r=l.getRandomChannelSigner(),o=l.getRandomBytes32(),c={channelAddress:l.mkAddress("0xcc"),amount:"10",alice:t.address,bob:r.address,assetId:l.mkAddress(),aliceSignature:l.mkSig("0xaaa"),bobSignature:l.mkSig("0xbbb"),recipient:l.mkAddress("0xrrr"),nonce:"12",callData:"0x",callTo:l.mkAddress(),transactionHash:l.mkHash("0xttt")};beforeEach((()=>n(void 0,void 0,void 0,(function*(){yield e.saveWithdrawalCommitment(o,c)})))),it("getWithdrawalCommitment should work",(()=>n(void 0,void 0,void 0,(function*(){l.expect(yield e.getWithdrawalCommitment(o)).to.be.deep.eq(c)})))),it("getWithdrawalCommitmentByTransactionHash should work",(()=>n(void 0,void 0,void 0,(function*(){l.expect(yield e.getWithdrawalCommitmentByTransactionHash(c.transactionHash)).to.be.deep.eq(c)}))))}else{let t,r;const o=l.getRandomChannelSigner(),d=l.getRandomChannelSigner(),h=l.getRandomBytes32(),f={channelAddress:l.mkAddress("0xcc"),amount:"10",alice:o.address,bob:d.address,assetId:l.mkAddress(),aliceSignature:l.mkSig("0xaaa"),bobSignature:l.mkSig("0xbbb"),recipient:l.mkAddress("0xrrr"),nonce:"12",callData:"0x",callTo:l.mkAddress(),transactionHash:l.mkHash("0xttt")};beforeEach((()=>n(void 0,void 0,void 0,(function*(){t=l.createTestChannelUpdate(c.UpdateType.resolve,{channelAddress:f.channelAddress,details:{transferId:h,transferResolver:{responderSignature:f.bobSignature},meta:{transactionHash:f.transactionHash}},fromIdentifier:d.publicIdentifier,toIdentifier:o.publicIdentifier,assetId:f.assetId,nonce:5}),r=l.createTestChannelUpdate(c.UpdateType.create,{channelAddress:f.channelAddress,details:{transferId:h,balance:{amount:[f.amount,"0"],to:[f.recipient,d.address]},transferInitialState:{initiatorSignature:f.aliceSignature,initiator:f.alice,responder:f.bob,nonce:f.nonce,callTo:f.callTo,callData:f.callData,fee:"0"}},fromIdentifier:o.publicIdentifier,toIdentifier:d.publicIdentifier,assetId:f.assetId,nonce:4});const{channel:n,transfer:m}=l.createTestChannelState(c.UpdateType.create,{channelAddress:f.channelAddress,alice:f.alice,bob:f.bob,aliceIdentifier:o.publicIdentifier,bobIdentifier:d.publicIdentifier,latestUpdate:Object.assign({},r)});yield e.saveChannelState(n,Object.assign(Object.assign({},m),{balance:r.balance}));const y=l.createTestChannelState(c.UpdateType.resolve,{channelAddress:f.channelAddress,alice:f.alice,bob:f.bob,aliceIdentifier:o.publicIdentifier,bobIdentifier:d.publicIdentifier,latestUpdate:Object.assign({},t)}).channel;yield e.saveChannelState(Object.assign(Object.assign({},y),{latestUpdate:t}),Object.assign(Object.assign({},m),{transferResolver:{responderSignature:f.bobSignature},balance:r.balance})),yield e.saveWithdrawalCommitment(h,f)})))),it("should update transfer resolver",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkBytes32("0xabcde"),r=l.createTestChannelState("create",{},{transferId:t});yield e.saveChannelState(r.channel,r.transfer);let n=yield e.getTransferState(r.transfer.transferId);l.expect(n).to.deep.eq(Object.assign(Object.assign({},r.transfer),{transferState:Object.assign({balance:r.channel.latestUpdate.details.balance},r.transfer.transferState)}))})))),it("should create an event subscription",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkPublicIdentifier(),r={[c.EngineEvents.CONDITIONAL_TRANSFER_CREATED]:"sub1",[c.EngineEvents.CONDITIONAL_TRANSFER_RESOLVED]:"sub2",[c.EngineEvents.DEPOSIT_RECONCILED]:"sub3"},n=e;yield n.registerSubscription(t,c.EngineEvents.CONDITIONAL_TRANSFER_CREATED,"othersub");const o=yield n.getSubscription(t,c.EngineEvents.CONDITIONAL_TRANSFER_CREATED);l.expect(o).to.eq("othersub");for(const[e,o]of Object.entries(r))yield n.registerSubscription(t,e,o);const d=yield n.getSubscriptions(t);l.expect(d).to.deep.eq(r)}))))}it("should save transaction responses and receipts",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("setup").channel;yield e.saveChannelState(t);const r=l.createTestTxResponse();yield e.saveTransactionResponse(t.channelAddress,c.TransactionReason.depositA,r);const n=yield e.getTransactionByHash(r.hash),{wait:d,confirmations:h,hash:f}=r,m=o(r,["wait","confirmations","hash"]);l.expect(n).to.containSubset(Object.assign(Object.assign({},m),{status:c.StoredTransactionStatus.submitted,channelAddress:t.channelAddress,transactionHash:f,gasLimit:r.gasLimit.toString(),gasPrice:r.gasPrice.toString(),value:r.value.toString()}));const y=yield r.wait();yield e.saveTransactionReceipt(t.channelAddress,y);const v=yield e.getTransactionByHash(r.hash),{confirmations:T}=y,w=o(y,["confirmations"]);l.expect(v).to.containSubset(Object.assign(Object.assign(Object.assign({},m),w),{channelAddress:t.channelAddress,transactionHash:f,gasLimit:r.gasLimit.toString(),gasPrice:r.gasPrice.toString(),value:r.value.toString(),cumulativeGasUsed:y.cumulativeGasUsed.toString(),gasUsed:y.gasUsed.toString(),status:c.StoredTransactionStatus.mined}));const E=l.createTestTxResponse({hash:l.mkHash("0x13754"),nonce:65});yield e.saveTransactionResponse(t.channelAddress,c.TransactionReason.depositB,E),yield e.saveTransactionFailure(t.channelAddress,E.hash,"failed to send");const{wait:S,confirmations:I,hash:k}=E,x=o(E,["wait","confirmations","hash"]),O=yield e.getTransactionByHash(k);l.expect(O).to.containSubset(Object.assign(Object.assign({},x),{transactionHash:k,gasLimit:E.gasLimit.toString(),gasPrice:E.gasPrice.toString(),value:E.value.toString(),status:c.StoredTransactionStatus.failed,error:"failed to send"}))})))),it("should save and retrieve all update types and keep updating the channel",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("setup").channel;yield e.saveChannelState(t);let r=yield e.getChannelState(t.channelAddress);l.expect(r).to.deep.eq(t);const n={amount:["10","20"],to:t.balances[0].to},o=l.createTestChannelState("deposit",{nonce:t.nonce+1,defundNonces:t.defundNonces,balances:[n,t.balances[0]],networkContext:t.networkContext}).channel;yield e.saveChannelState(o),r=yield e.getChannelState(t.channelAddress),l.expect(r).to.deep.eq(o);const c=l.createTestChannelState("create",{channelAddress:t.channelAddress,nonce:o.nonce+1,defundNonces:t.defundNonces,networkContext:t.networkContext},{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")}});yield e.saveChannelState(c.channel,c.transfer),r=yield e.getChannelState(t.channelAddress),l.expect(r).to.deep.eq(c.channel);const d=l.createTestChannelState("resolve",{nonce:c.channel.nonce+1,defundNonces:t.defundNonces,networkContext:t.networkContext},{transferId:l.mkHash("0x111")});yield e.saveChannelState(d.channel,d.transfer),r=yield e.getChannelState(t.channelAddress),l.expect(r).to.deep.eq(d.channel)})))),it("should update transfer resolver",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkBytes32("0xabcde"),r=l.createTestChannelState("create",{},{transferId:t});yield e.saveChannelState(r.channel,r.transfer);let n=yield e.getTransferState(r.transfer.transferId);l.expect(n).to.deep.eq(r.transfer);const o=l.createTestChannelState("resolve",{nonce:r.channel.nonce+1},{transferId:t});yield e.saveChannelState(o.channel,o.transfer);const c=yield e.getChannelState(o.channel.channelAddress);l.expect(c).to.deep.eq(o.channel),n=yield e.getTransferState(o.transfer.transferId),l.expect(n.transferResolver).to.deep.eq(o.channel.latestUpdate.details.transferResolver)})))),it("should create multiple active transfers",(()=>n(void 0,void 0,void 0,(function*(){const t=l.createTestChannelState("create",{},{transferId:l.mkHash("0x111"),meta:{routingId:l.mkBytes32("0xddd")},balance:{to:[l.mkAddress("0xaaa"),l.mkAddress("0xbbb")],amount:["5","0"]}});yield e.saveChannelState(t.channel,t.transfer);const r=l.createTestChannelState("create",{nonce:t.channel.nonce+1},{transferId:l.mkHash("0x112"),meta:{routingId:l.mkBytes32("0xeee")},balance:{to:[l.mkAddress("0xaaa"),l.mkAddress("0xbbb")],amount:["5","0"]}});yield e.saveChannelState(r.channel,r.transfer);const n=yield e.getChannelState(t.channel.channelAddress);l.expect(n).to.deep.eq(r.channel);const o=yield e.getActiveTransfers(t.channel.channelAddress);l.expect(o.length).eq(2);const c=o.find((e=>e.transferId===t.transfer.transferId)),d=o.find((e=>e.transferId===r.transfer.transferId));l.expect(c).to.deep.eq(t.transfer),l.expect(d).to.deep.eq(r.transfer)})))),it("should get multiple transfers by routingId",(()=>n(void 0,void 0,void 0,(function*(){const t=l.mkBytes32("0xddd"),r=l.getRandomIdentifier(),n=l.getRandomIdentifier(),o=l.createTestChannelState("create",{aliceIdentifier:r,alice:l.getSignerAddressFromPublicIdentifier(r),bobIdentifier:n,bob:l.getSignerAddressFromPublicIdentifier(n)},{transferId:l.mkHash("0x111"),meta:{routingId:t},balance:{to:[l.getSignerAddressFromPublicIdentifier(r),l.getSignerAddressFromPublicIdentifier(n)],amount:["7","0"]},responder:l.getSignerAddressFromPublicIdentifier(r),initiator:l.getSignerAddressFromPublicIdentifier(n)});yield e.saveChannelState(o.channel,o.transfer);const c=l.getRandomIdentifier(),d=l.createTestChannelState("create",{aliceIdentifier:r,alice:l.getSignerAddressFromPublicIdentifier(r),channelAddress:l.getRandomBytes32(),bob:l.getSignerAddressFromPublicIdentifier(c),bobIdentifier:c},{transferId:l.mkHash("0x122"),meta:{routingId:t},balance:{to:[l.getSignerAddressFromPublicIdentifier(r),l.getSignerAddressFromPublicIdentifier(c)],amount:["7","0"]},initiator:l.getSignerAddressFromPublicIdentifier(r),responder:l.getSignerAddressFromPublicIdentifier(c)});yield e.saveChannelState(d.channel,d.transfer);const h=yield e.getTransfersByRoutingId(t);l.expect(h.length).to.eq(2);const f=h.find((e=>e.transferId===o.transfer.transferId)),m=h.find((e=>e.transferId===d.transfer.transferId));l.expect(f).to.deep.eq(o.transfer),l.expect(m).to.deep.eq(d.transfer)}))))}))}))}},278:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return h})),r.d(t,"a",(function(){return f}));var n=r(91);const o=n.a.from(-1),c=n.a.from(0),l=n.a.from(1),d=n.a.from(2),h=n.a.from("1000000000000000000"),f=n.a.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")},3156:function(e,t,r){"use strict";r.r(t),r.d(t,"Mutex",(function(){return h})),r.d(t,"Semaphore",(function(){return d})),r.d(t,"withTimeout",(function(){return f})),r.d(t,"tryAcquire",(function(){return m})),r.d(t,"E_TIMEOUT",(function(){return o})),r.d(t,"E_ALREADY_LOCKED",(function(){return c})),r.d(t,"E_CANCELED",(function(){return l}));var n=r(4),o=new Error("timeout while waiting for mutex to become available"),c=new Error("mutex already locked"),l=new Error("request for lock canceled"),d=function(){function e(e,t){if(void 0===t&&(t=l),this._maxConcurrency=e,this._cancelError=t,this._queue=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),r=new Promise((function(t,r){return e._queue.push({resolve:t,reject:r})}));return t||this._dispatch(),r},e.prototype.runExclusive=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r,o;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,this.acquire()];case 1:t=n.sent(),r=t[0],o=t[1],n.label=2;case 2:return n.trys.push([2,,4,5]),[4,e(r)];case 3:return[2,n.sent()];case 4:return o(),[7];case 5:return[2]}}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var r=!1;this._currentReleaser=function(){r||(r=!0,e._value++,e._dispatch())},t.resolve([this._value--,this._currentReleaser])}},e}(),h=function(){function e(e){this._semaphore=new d(1,e)}return e.prototype.acquire=function(){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.release=function(){this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();function f(e,t,r){var c=this;return void 0===r&&(r=o),{acquire:function(){return new Promise((function(o,l){return Object(n.b)(c,void 0,void 0,(function(){var c,d,h,f;return Object(n.d)(this,(function(n){switch(n.label){case 0:c=!1,d=setTimeout((function(){c=!0,l(r)}),t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.acquire()];case 2:return h=n.sent(),c?(Array.isArray(h)?h[1]:h)():(clearTimeout(d),o(h)),[3,4];case 3:return f=n.sent(),c||(clearTimeout(d),l(f)),[3,4];case 4:return[2]}}))}))}))},runExclusive:function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:t=function(){},n.label=1;case 1:return n.trys.push([1,,7,8]),[4,this.acquire()];case 2:return r=n.sent(),Array.isArray(r)?(t=r[1],[4,e(r[0])]):[3,4];case 3:return[2,n.sent()];case 4:return t=r,[4,e()];case 5:return[2,n.sent()];case 6:return[3,8];case 7:return t(),[7];case 8:return[2]}}))}))},release:function(){e.release()},cancel:function(){return e.cancel()},isLocked:function(){return e.isLocked()}}}function m(e,t){return void 0===t&&(t=c),f(e,0,t)}},3161:function(e,t,r){"use strict";r.r(t),r.d(t,"Wallet",(function(){return O})),r.d(t,"verifyMessage",(function(){return A})),r.d(t,"verifyTypedData",(function(){return _}));var n=r(118),o=r(220),c=r(397),l=r(11),d=r(3179),h=r(3177),f=r(74),m=r(26),y=r(0),v=r(934),T=r(86),w=r(339),E=r(222),S=r(37),I=r(2);var k=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const x=new I.b("wallet/5.0.11");class O extends c.Signer{constructor(e,t){if(x.checkNew(new.target,O),super(),null!=(r=e)&&Object(l.isHexString)(r.privateKey,32)&&null!=r.address){const t=new T.a(e.privateKey);if(Object(y.d)(this,"_signingKey",(()=>t)),Object(y.d)(this,"address",Object(S.computeAddress)(this.publicKey)),this.address!==Object(n.getAddress)(e.address)&&x.throwArgumentError("privateKey/address mismatch","privateKey","[REDACTED]"),function(e){const t=e.mnemonic;return t&&t.phrase}(e)){const t=e.mnemonic;Object(y.d)(this,"_mnemonic",(()=>({phrase:t.phrase,path:t.path||f.b,locale:t.locale||"en"})));const r=this.mnemonic,n=f.a.fromMnemonic(r.phrase,null,r.locale).derivePath(r.path);Object(S.computeAddress)(n.privateKey)!==this.address&&x.throwArgumentError("mnemonic/address mismatch","privateKey","[REDACTED]")}else Object(y.d)(this,"_mnemonic",(()=>null))}else{if(T.a.isSigningKey(e))"secp256k1"!==e.curve&&x.throwArgumentError("unsupported curve; must be secp256k1","privateKey","[REDACTED]"),Object(y.d)(this,"_signingKey",(()=>e));else{"string"==typeof e&&e.match(/^[0-9a-f]*$/i)&&64===e.length&&(e="0x"+e);const t=new T.a(e);Object(y.d)(this,"_signingKey",(()=>t))}Object(y.d)(this,"_mnemonic",(()=>null)),Object(y.d)(this,"address",Object(S.computeAddress)(this.publicKey))}var r;t&&!o.b.isProvider(t)&&x.throwArgumentError("invalid provider","provider",t),Object(y.d)(this,"provider",t||null)}get mnemonic(){return this._mnemonic()}get privateKey(){return this._signingKey().privateKey}get publicKey(){return this._signingKey().publicKey}getAddress(){return Promise.resolve(this.address)}connect(e){return new O(this,e)}signTransaction(e){return Object(y.f)(e).then((t=>{null!=t.from&&(Object(n.getAddress)(t.from)!==this.address&&x.throwArgumentError("transaction from address mismatch","transaction.from",e.from),delete t.from);const r=this._signingKey().signDigest(Object(m.keccak256)(Object(S.serialize)(t)));return Object(S.serialize)(t,r)}))}signMessage(e){return k(this,void 0,void 0,(function*(){return Object(l.joinSignature)(this._signingKey().signDigest(Object(d.a)(e)))}))}_signTypedData(e,t,r){return k(this,void 0,void 0,(function*(){const n=yield h.a.resolveNames(e,t,r,(e=>(null==this.provider&&x.throwError("cannot resolve ENS names without a provider",I.b.errors.UNSUPPORTED_OPERATION,{operation:"resolveName",value:e}),this.provider.resolveName(e))));return Object(l.joinSignature)(this._signingKey().signDigest(h.a.hash(n.domain,t,n.value)))}))}encrypt(e,t,r){if("function"!=typeof t||r||(r=t,t={}),r&&"function"!=typeof r)throw new Error("invalid callback");return t||(t={}),Object(w.c)(this,e,t,r)}static createRandom(e){let t=Object(v.a)(16);e||(e={}),e.extraEntropy&&(t=Object(l.arrayify)(Object(l.hexDataSlice)(Object(m.keccak256)(Object(l.concat)([t,e.extraEntropy])),0,16)));const r=Object(f.c)(t,e.locale);return O.fromMnemonic(r,e.path,e.locale)}static fromEncryptedJson(e,t,r){return Object(E.a)(e,t,r).then((e=>new O(e)))}static fromEncryptedJsonSync(e,t){return new O(Object(E.b)(e,t))}static fromMnemonic(e,path,t){return path||(path=f.b),new O(f.a.fromMnemonic(e,null,t).derivePath(path))}}function A(e,t){return Object(S.recoverAddress)(Object(d.a)(e),t)}function _(e,t,r,n){return Object(S.recoverAddress)(h.a.hash(e,t,r),n)}},319:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomBytes32=t.getRandomAddress=t.isValidBytes32=t.getBytes32Error=t.isValidAddress=t.getAddressError=t.isValidHexString=t.getHexStringError=void 0;const n=r(118),o=r(11),c=r(452);t.getHexStringError=(e,t)=>"string"!=typeof e?`Invalid hex string: ${e} is a ${typeof e}, expected a string`:e.startsWith("0x")?o.isHexString(e)?t&&o.hexDataLength(e)!==t?`Invalid hex string of length ${t}: ${e} is ${o.hexDataLength(e)} bytes long`:void 0:`Invalid hex string: ${e}`:`Invalid hex string: ${e} doesn't start with 0x`;t.isValidHexString=e=>!t.getHexStringError(e);t.getAddressError=e=>{try{const r=t.getHexStringError(e,20);return r||void n.getAddress(e)}catch(e){return e.message}};t.isValidAddress=e=>!t.getAddressError(e);t.getBytes32Error=e=>{const r=t.getHexStringError(e,32);if(r)return r};t.isValidBytes32=e=>!t.getBytes32Error(e);t.getRandomAddress=()=>n.getAddress(o.hexlify(c.randomBytes(20)));t.getRandomBytes32=()=>o.hexlify(c.randomBytes(32))},374:function(e,t,r){"use strict";r.d(t,"c",(function(){return w})),r.d(t,"d",(function(){return E})),r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return I}));var n=r(11),o=r(2),c=r(509),l=r(91);const d=new o.b(c.a),h={},f=l.a.from(0),m=l.a.from(-1);function y(e,t,r,n){const c={fault:t,operation:r};return void 0!==n&&(c.value=n),d.throwError(e,o.b.errors.NUMERIC_FAULT,c)}let v="0";for(;v.length<256;)v+=v;function T(e){if("number"!=typeof e)try{e=l.a.from(e).toNumber()}catch(e){}return"number"==typeof e&&e>=0&&e<=256&&!(e%1)?"1"+v.substring(0,e):d.throwArgumentError("invalid decimal size","decimals",e)}function w(e,t){null==t&&(t=0);const r=T(t),n=(e=l.a.from(e)).lt(f);n&&(e=e.mul(m));let o=e.mod(r).toString();for(;o.length<r.length-1;)o="0"+o;o=o.match(/^([0-9]*[1-9]|0)(0*)/)[1];const c=e.div(r).toString();return e=c+"."+o,n&&(e="-"+e),e}function E(e,t){null==t&&(t=0);const r=T(t);if("string"==typeof e&&e.match(/^-?[0-9.,]+$/)||d.throwArgumentError("invalid decimal value","value",e),r.length-1==0)return l.a.from(e);const n="-"===e.substring(0,1);n&&(e=e.substring(1)),"."===e&&d.throwArgumentError("missing value","value",e);const o=e.split(".");o.length>2&&d.throwArgumentError("too many decimal points","value",e);let c=o[0],h=o[1];for(c||(c="0"),h||(h="0"),h.length>r.length-1&&y("fractional component exceeds decimals","underflow","parseFixed");h.length<r.length-1;)h+="0";const f=l.a.from(c),v=l.a.from(h);let w=f.mul(r).add(v);return n&&(w=w.mul(m)),w}class S{constructor(e,t,r,n){e!==h&&d.throwError("cannot use FixedFormat constructor; use FixedFormat.from",o.b.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=t,this.width=r,this.decimals=n,this.name=(t?"":"u")+"fixed"+String(r)+"x"+String(n),this._multiplier=T(n),Object.freeze(this)}static from(e){if(e instanceof S)return e;let t=!0,r=128,n=18;if("string"==typeof e){if("fixed"===e);else if("ufixed"===e)t=!1;else if(null!=e){const o=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);o||d.throwArgumentError("invalid fixed format","format",e),t="u"!==o[1],r=parseInt(o[2]),n=parseInt(o[3])}}else if(e){const o=(t,r,n)=>null==e[t]?n:(typeof e[t]!==r&&d.throwArgumentError("invalid fixed format ("+t+" not "+r+")","format."+t,e[t]),e[t]);t=o("signed","boolean",t),r=o("width","number",r),n=o("decimals","number",n)}return r%8&&d.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",r),n>80&&d.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",n),new S(h,t,r,n)}}class I{constructor(e,t,r,n){d.checkNew(new.target,I),e!==h&&d.throwError("cannot use FixedNumber constructor; use FixedNumber.from",o.b.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=n,this._hex=t,this._value=r,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&d.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const a=E(this._value,this.format.decimals),b=E(e._value,e.format.decimals);return I.fromValue(a.add(b),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const a=E(this._value,this.format.decimals),b=E(e._value,e.format.decimals);return I.fromValue(a.sub(b),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const a=E(this._value,this.format.decimals),b=E(e._value,e.format.decimals);return I.fromValue(a.mul(b).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const a=E(this._value,this.format.decimals),b=E(e._value,e.format.decimals);return I.fromValue(a.mul(this.format._multiplier).div(b),this.format.decimals,this.format)}floor(){let e=this.toString().split("."),t=I.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return this.isNegative()&&r&&(t=t.subUnsafe(k)),t}ceiling(){let e=this.toString().split("."),t=I.from(e[0],this.format);const r=!e[1].match(/^(0*)$/);return!this.isNegative()&&r&&(t=t.addUnsafe(k)),t}round(e){null==e&&(e=0);let t=this.toString().split(".");if((e<0||e>80||e%1)&&d.throwArgumentError("invalid decimal count","decimals",e),t[1].length<=e)return this;const r=I.from("1"+v.substring(0,e));return this.mulUnsafe(r).addUnsafe(x).floor().divUnsafe(r)}isZero(){return"0.0"===this._value}isNegative(){return"-"===this._value[0]}toString(){return this._value}toHexString(e){if(null==e)return this._hex;e%8&&d.throwArgumentError("invalid byte width","width",e);const t=l.a.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return Object(n.hexZeroPad)(t,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return I.fromString(this._value,e)}static fromValue(e,t,r){return null!=r||null==t||Object(l.d)(t)||(r=t,t=null),null==t&&(t=0),null==r&&(r="fixed"),I.fromString(w(e,t),S.from(r))}static fromString(e,t){null==t&&(t="fixed");const r=S.from(t),o=E(e,r.decimals);!r.signed&&o.lt(f)&&y("unsigned value cannot be negative","overflow","value",e);let c=null;r.signed?c=o.toTwos(r.width).toHexString():(c=o.toHexString(),c=Object(n.hexZeroPad)(c,r.width/8));const l=w(o,r.decimals);return new I(h,c,l,r)}static fromBytes(e,t){null==t&&(t="fixed");const r=S.from(t);if(Object(n.arrayify)(e).length>r.width/8)throw new Error("overflow");let o=l.a.from(e);r.signed&&(o=o.fromTwos(r.width));const c=o.toTwos((r.signed?0:1)+r.width).toHexString(),d=w(o,r.decimals);return new I(h,c,d,r)}static from(e,t){if("string"==typeof e)return I.fromString(e,t);if(Object(n.isBytes)(e))return I.fromBytes(e,t);try{return I.fromValue(e,0,t)}catch(e){if(e.code!==o.b.errors.INVALID_ARGUMENT)throw e}return d.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!(!e||!e._isFixedNumber)}}const k=I.from(1),x=I.from("0.5")},376:function(e,t,r){"use strict";(function(e){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.recoverAddressFroUtilityMessage=t.signUtilityMessage=t.recoverAddressFromChannelMessage=t.signChannelMessage=t.decrypt=t.encrypt=t.hashUtilityMessage=t.hashChannelMessage=t.getRandomSignature=t.getRandomPublicKey=t.getRandomPrivateKey=t.getAddressFromPrivateKey=t.getAddressFromPublicKey=t.getPublicKeyFromPrivateKey=t.isValidEthSignature=t.getEthSignatureError=t.isValidPrivateKey=t.getPrivateKeyError=t.isValidPublicKey=t.getPublicKeyError=t.bufferify=t.UTILITY_SIGN_PREFIX=t.VECTOR_SIGN_PREFIX=void 0;const o=r(118),c=r(11),l=r(452),d=r(389),h=r(935),f=r(319);t.VECTOR_SIGN_PREFIX="Vector Signed Message:\n",t.UTILITY_SIGN_PREFIX="Utility Signed Message:\n";t.bufferify=input=>"string"==typeof input?f.isValidHexString(input)?h.hexToBuffer(input):h.utf8ToBuffer(input):e.isBuffer(input)?input:h.arrayToBuffer(c.arrayify(input));t.getPublicKeyError=e=>{try{const r=f.getHexStringError(e,65);if(r)return r;const n=f.getAddressError(t.getAddressFromPublicKey(e));return n?`Got invalid address from public key ${e}: ${n}`:void 0}catch(e){return e.message}};t.isValidPublicKey=e=>!t.getPublicKeyError(e);t.getPrivateKeyError=e=>{try{const r=f.getHexStringError(e,32);if(r)return r;const n=f.getAddressError(t.getAddressFromPrivateKey(e));return n?`Got invalid address from private key: ${n}`:void 0}catch(e){return e.message}};t.isValidPrivateKey=e=>!t.getPrivateKeyError(e);t.getEthSignatureError=e=>{const t=f.getHexStringError(e,65);if(t)return t};t.isValidEthSignature=e=>!t.getEthSignatureError(e);t.getPublicKeyFromPrivateKey=e=>c.hexlify(h.getPublic(t.bufferify(e)));t.getAddressFromPublicKey=e=>{const r=t.bufferify(e);return o.getAddress(c.hexlify(h.keccak256((h.isDecompressed(r)?r:h.decompress(r)).slice(1)).slice(12)))};t.getAddressFromPrivateKey=e=>t.getAddressFromPublicKey(t.getPublicKeyFromPrivateKey(e));t.getRandomPrivateKey=()=>c.hexlify(l.randomBytes(32));t.getRandomPublicKey=()=>t.getPublicKeyFromPrivateKey(t.getRandomPrivateKey()),t.getRandomSignature=t.getRandomPublicKey;t.hashChannelMessage=e=>c.hexlify(h.keccak256(h.concatBuffers(t.bufferify(t.VECTOR_SIGN_PREFIX),t.bufferify(`${t.bufferify(e).length}`),t.bufferify(e))));t.hashUtilityMessage=e=>c.hexlify(h.keccak256(h.concatBuffers(t.bufferify(t.UTILITY_SIGN_PREFIX),t.bufferify(`${t.bufferify(e).length}`),t.bufferify(e))));t.encrypt=(e,r)=>n(void 0,void 0,void 0,(function*(){return c.hexlify(h.serialize(yield h.encrypt(t.bufferify(r),h.utf8ToBuffer(e))))}));t.decrypt=(e,r)=>n(void 0,void 0,void 0,(function*(){return d.toUtf8String(yield h.decrypt(t.bufferify(r),h.deserialize(t.bufferify(`0x${e.replace(/^0x/,"")}`))))}));t.signChannelMessage=(e,r)=>n(void 0,void 0,void 0,(function*(){return c.hexlify(h.sign(t.bufferify(r),t.bufferify(t.hashChannelMessage(e)),!0))}));t.recoverAddressFromChannelMessage=(e,r)=>n(void 0,void 0,void 0,(function*(){return t.getAddressFromPublicKey(c.hexlify(h.recover(t.bufferify(t.hashChannelMessage(e)),t.bufferify(r))))}));t.signUtilityMessage=(e,r)=>n(void 0,void 0,void 0,(function*(){return c.hexlify(h.sign(t.bufferify(r),t.bufferify(t.hashUtilityMessage(e)),!0))}));t.recoverAddressFroUtilityMessage=(e,r)=>n(void 0,void 0,void 0,(function*(){return t.getAddressFromPublicKey(c.hexlify(h.recover(t.bufferify(t.hashUtilityMessage(e)),t.bufferify(r))))}))}).call(this,r(9).Buffer)},382:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkSig=t.mkBytes32=t.mkHash=t.mkPublicIdentifier=t.mkAddress=void 0;t.mkAddress=(e="0x0")=>e.padEnd(42,"0");t.mkPublicIdentifier=(e="vectorA")=>e.padEnd(56,"0");t.mkHash=(e="0x")=>e.padEnd(66,"0");t.mkBytes32=(e="0xa")=>e.padEnd(66,"0");t.mkSig=(e="0xa")=>e.padEnd(132,"0")},389:function(e,t,r){"use strict";r.r(t),r.d(t,"_toEscapedUtf8String",(function(){return c.d})),r.d(t,"toUtf8Bytes",(function(){return c.f})),r.d(t,"toUtf8CodePoints",(function(){return c.g})),r.d(t,"toUtf8String",(function(){return c.h})),r.d(t,"Utf8ErrorFuncs",(function(){return c.b})),r.d(t,"Utf8ErrorReason",(function(){return c.c})),r.d(t,"UnicodeNormalizationForm",(function(){return c.a})),r.d(t,"formatBytes32String",(function(){return l})),r.d(t,"parseBytes32String",(function(){return d})),r.d(t,"nameprep",(function(){return k}));var n=r(928),o=r(11),c=r(119);function l(text){const e=Object(c.f)(text);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return Object(o.hexlify)(Object(o.concat)([e,n.a]).slice(0,32))}function d(e){const data=Object(o.arrayify)(e);if(32!==data.length)throw new Error("invalid bytes32 - not 32 bytes long");if(0!==data[31])throw new Error("invalid bytes32 string - no null terminator");let t=31;for(;0===data[t-1];)t--;return Object(c.h)(data.slice(0,t))}function h(data,e){e||(e=function(e){return[parseInt(e,16)]});let t=0,r={};return data.split(",").forEach((n=>{let o=n.split(":");t+=parseInt(o[0],16),r[t]=e(o[1])})),r}function f(data){let e=0;return data.split(",").map((t=>{let r=t.split("-");1===r.length?r[1]="0":""===r[1]&&(r[1]="1");let n=e+parseInt(r[0],16);return e=parseInt(r[1],16),{l:n,h:e}}))}function m(e,t){let r=0;for(let i=0;i<t.length;i++){let n=t[i];if(r+=n.l,e>=r&&e<=r+n.h&&(e-r)%(n.d||1)==0){if(n.e&&-1!==n.e.indexOf(e-r))continue;return n}}return null}const y=f("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),v="ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map((e=>parseInt(e,16))),T=[{h:25,s:32,l:65},{h:30,s:32,e:[23],l:127},{h:54,s:1,e:[48],l:64,d:2},{h:14,s:1,l:57,d:2},{h:44,s:1,l:17,d:2},{h:10,s:1,e:[2,6,8],l:61,d:2},{h:16,s:1,l:68,d:2},{h:84,s:1,e:[18,24,66],l:19,d:2},{h:26,s:32,e:[17],l:435},{h:22,s:1,l:71,d:2},{h:15,s:80,l:40},{h:31,s:32,l:16},{h:32,s:1,l:80,d:2},{h:52,s:1,l:42,d:2},{h:12,s:1,l:55,d:2},{h:40,s:1,e:[38],l:15,d:2},{h:14,s:1,l:48,d:2},{h:37,s:48,l:49},{h:148,s:1,l:6351,d:2},{h:88,s:1,l:160,d:2},{h:15,s:16,l:704},{h:25,s:26,l:854},{h:25,s:32,l:55915},{h:37,s:40,l:1247},{h:25,s:-119711,l:53248},{h:25,s:-119763,l:52},{h:25,s:-119815,l:52},{h:25,s:-119867,e:[1,4,5,7,8,11,12,17],l:52},{h:25,s:-119919,l:52},{h:24,s:-119971,e:[2,7,8,17],l:52},{h:24,s:-120023,e:[2,7,13,15,16,17],l:52},{h:25,s:-120075,l:52},{h:25,s:-120127,l:52},{h:25,s:-120179,l:52},{h:25,s:-120231,l:52},{h:25,s:-120283,l:52},{h:25,s:-120335,l:52},{h:24,s:-119543,e:[17],l:56},{h:24,s:-119601,e:[17],l:58},{h:24,s:-119659,e:[17],l:58},{h:24,s:-119717,e:[17],l:58},{h:24,s:-119775,e:[17],l:58}],w=h("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),E=h("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),S=h("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",(function(data){if(data.length%4!=0)throw new Error("bad data");let e=[];for(let i=0;i<data.length;i+=4)e.push(parseInt(data.substring(i,i+4),16));return e})),I=f("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function k(e){if(e.match(/^[a-z0-9-]*$/i)&&e.length<=59)return e.toLowerCase();let t=Object(c.g)(e);var r;r=t.map((code=>{if(v.indexOf(code)>=0)return[];if(code>=65024&&code<=65039)return[];let e=function(e){let t=m(e,T);if(t)return[e+t.s];let r=w[e];if(r)return r;let n=E[e];return n?[e+n[0]]:S[e]||null}(code);return e||[code]})),t=r.reduce(((e,t)=>(t.forEach((t=>{e.push(t)})),e)),[]),t=Object(c.g)(Object(c.e)(t),c.a.NFKC),t.forEach((code=>{if(m(code,I))throw new Error("STRINGPREP_CONTAINS_PROHIBITED")})),t.forEach((code=>{if(m(code,y))throw new Error("STRINGPREP_CONTAINS_UNASSIGNED")}));let n=Object(c.e)(t);if("-"===n.substring(0,1)||"--"===n.substring(2,4)||"-"===n.substring(n.length-1))throw new Error("invalid hyphen");if(n.length>63)throw new Error("too long");return n}},397:function(e,t,r){"use strict";r.r(t),r.d(t,"Signer",(function(){return f})),r.d(t,"VoidSigner",(function(){return m}));var n=r(0),o=r(2);var c=function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};const l=new o.b("abstract-signer/5.0.13"),d=["chainId","data","from","gasLimit","gasPrice","nonce","to","value"],h=[o.b.errors.INSUFFICIENT_FUNDS,o.b.errors.NONCE_EXPIRED,o.b.errors.REPLACEMENT_UNDERPRICED];class f{constructor(){l.checkAbstract(new.target,f),Object(n.d)(this,"_isSigner",!0)}getBalance(e){return c(this,void 0,void 0,(function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),e)}))}getTransactionCount(e){return c(this,void 0,void 0,(function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),e)}))}estimateGas(e){return c(this,void 0,void 0,(function*(){this._checkProvider("estimateGas");const t=yield Object(n.f)(this.checkTransaction(e));return yield this.provider.estimateGas(t)}))}call(e,t){return c(this,void 0,void 0,(function*(){this._checkProvider("call");const r=yield Object(n.f)(this.checkTransaction(e));return yield this.provider.call(r,t)}))}sendTransaction(e){return this._checkProvider("sendTransaction"),this.populateTransaction(e).then((e=>this.signTransaction(e).then((e=>this.provider.sendTransaction(e)))))}getChainId(){return c(this,void 0,void 0,(function*(){this._checkProvider("getChainId");return(yield this.provider.getNetwork()).chainId}))}getGasPrice(){return c(this,void 0,void 0,(function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()}))}resolveName(e){return c(this,void 0,void 0,(function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(e)}))}checkTransaction(e){for(const t in e)-1===d.indexOf(t)&&l.throwArgumentError("invalid transaction key: "+t,"transaction",e);const t=Object(n.g)(e);return null==t.from?t.from=this.getAddress():t.from=Promise.all([Promise.resolve(t.from),this.getAddress()]).then((t=>(t[0].toLowerCase()!==t[1].toLowerCase()&&l.throwArgumentError("from address mismatch","transaction",e),t[0]))),t}populateTransaction(e){return c(this,void 0,void 0,(function*(){const t=yield Object(n.f)(this.checkTransaction(e));return null!=t.to&&(t.to=Promise.resolve(t.to).then((e=>c(this,void 0,void 0,(function*(){if(null==e)return null;const address=yield this.resolveName(e);return null==address&&l.throwArgumentError("provided ENS name resolves to null","tx.to",e),address}))))),null==t.gasPrice&&(t.gasPrice=this.getGasPrice()),null==t.nonce&&(t.nonce=this.getTransactionCount("pending")),null==t.gasLimit&&(t.gasLimit=this.estimateGas(t).catch((e=>{if(h.indexOf(e.code)>=0)throw e;return l.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",o.b.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,tx:t})}))),null==t.chainId?t.chainId=this.getChainId():t.chainId=Promise.all([Promise.resolve(t.chainId),this.getChainId()]).then((t=>(0!==t[1]&&t[0]!==t[1]&&l.throwArgumentError("chainId address mismatch","transaction",e),t[0]))),yield Object(n.f)(t)}))}_checkProvider(e){this.provider||l.throwError("missing provider",o.b.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})}static isSigner(e){return!(!e||!e._isSigner)}}class m extends f{constructor(address,e){l.checkNew(new.target,m),super(),Object(n.d)(this,"address",address),Object(n.d)(this,"provider",e||null)}getAddress(){return Promise.resolve(this.address)}_fail(e,t){return Promise.resolve().then((()=>{l.throwError(e,o.b.errors.UNSUPPORTED_OPERATION,{operation:t})}))}signMessage(e){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(e){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(e,t,r){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(e){return new m(this.address,e)}}},451:function(e,t,r){"use strict";r.r(t),r.d(t,"pack",(function(){return v})),r.d(t,"keccak256",(function(){return T})),r.d(t,"sha256",(function(){return w}));var n=r(91),o=r(11),c=r(26),l=r(408),d=r(119);const h=new RegExp("^bytes([0-9]+)$"),f=new RegExp("^(u?int)([0-9]*)$"),m=new RegExp("^(.*)\\[([0-9]*)\\]$");function y(e,t,r){switch(e){case"address":return r?Object(o.zeroPad)(t,32):Object(o.arrayify)(t);case"string":return Object(d.f)(t);case"bytes":return Object(o.arrayify)(t);case"bool":return t=t?"0x01":"0x00",r?Object(o.zeroPad)(t,32):Object(o.arrayify)(t)}let c=e.match(f);if(c){let l=parseInt(c[2]||"256");if(c[2]&&String(l)!==c[2]||l%8!=0||0===l||l>256)throw new Error("invalid number type - "+e);return r&&(l=256),t=n.a.from(t).toTwos(l),Object(o.zeroPad)(t,l/8)}if(c=e.match(h),c){const n=parseInt(c[1]);if(String(n)!==c[1]||0===n||n>32)throw new Error("invalid bytes type - "+e);if(Object(o.arrayify)(t).byteLength!==n)throw new Error("invalid value for "+e);return r?Object(o.arrayify)((t+"0000000000000000000000000000000000000000000000000000000000000000").substring(0,66)):t}if(c=e.match(m),c&&Array.isArray(t)){const r=c[1];if(parseInt(c[2]||String(t.length))!=t.length)throw new Error("invalid value for "+e);const n=[];return t.forEach((function(e){n.push(y(r,e,!0))})),Object(o.concat)(n)}throw new Error("invalid type - "+e)}function v(e,t){if(e.length!=t.length)throw new Error("type/value count mismatch");const r=[];return e.forEach((function(e,n){r.push(y(e,t[n]))})),Object(o.hexlify)(Object(o.concat)(r))}function T(e,t){return Object(c.keccak256)(v(e,t))}function w(e,t){return Object(l.c)(v(e,t))}},452:function(e,t,r){"use strict";r.r(t);var n=r(934);r.d(t,"randomBytes",(function(){return n.a}));var o=r(933);r.d(t,"shuffled",(function(){return o.a}))},50:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var p in e)"default"===p||Object.prototype.hasOwnProperty.call(t,p)||n(t,e,p)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(615),t),o(r(918),t),o(r(2540),t),o(r(929),t),o(r(2548),t),o(r(2569),t),o(r(2570),t),o(r(376),t),o(r(2571),t),o(r(2572),t),o(r(946),t),o(r(947),t),o(r(2573),t),o(r(2574),t),o(r(319),t),o(r(617),t),o(r(949),t),o(r(951),t),o(r(2575),t),o(r(952),t),o(r(2576),t),o(r(2604),t),o(r(2646),t),o(r(2647),t),o(r(950),t),o(r(2722),t),o(r(621),t),o(r(2772),t),o(r(2773),t)},509:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="bignumber/5.0.14"},615:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBigNumberishError=t.getBigNumberError=t.toBNJson=t.toBN=t.isBNJson=t.isBN=void 0;const n=r(96);t.isBN=n.BigNumber.isBigNumber;t.isBNJson=e=>!t.isBN(e)&&!!e._hex;t.toBN=e=>n.BigNumber.from(e&&"string"==typeof e._hex?e._hex:"function"==typeof e.toString?e.toString():"0");t.toBNJson=e=>({_hex:t.toBN(e).toHexString(),_isBigNumber:!0});t.getBigNumberError=e=>t.isBN(e)?void 0:`Value "${e}" is not a BigNumber`;t.getBigNumberishError=e=>{try{t.toBN(e)}catch(t){return`Value "${e}" is not BigNumberish: ${t.message}`}}},617:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isValidPublicIdentifier=t.getPublicIdentifierError=t.getRandomIdentifier=t.getAddressFromAssetId=t.getSignerAddressFromPublicIdentifier=t.getPublicKeyFromPublicIdentifier=t.getPublicIdentifierFromPublicKey=t.VECTOR_PUB_ID_PREFIX=void 0;const o=r(118),c=n(r(2565)),l=r(935),d=r(319),h=r(2568),f=r(376);t.VECTOR_PUB_ID_PREFIX="vector";const m=new h.LimitedCache(200);t.getPublicIdentifierFromPublicKey=e=>t.VECTOR_PUB_ID_PREFIX+c.default.encode(l.compress(l.hexToBuffer(e)));t.getPublicKeyFromPublicIdentifier=e=>`0x${l.bufferToHex(l.decompress(c.default.decode(e.replace(t.VECTOR_PUB_ID_PREFIX,""))))}`;t.getSignerAddressFromPublicIdentifier=e=>{const r=`signer-address:${e}`,n=m.get(r);if(n)return n;const o=f.getAddressFromPublicKey(t.getPublicKeyFromPublicIdentifier(e));return m.set(r,o),o};t.getAddressFromAssetId=e=>o.getAddress(e.toLowerCase());t.getRandomIdentifier=()=>t.getPublicIdentifierFromPublicKey(f.getRandomPublicKey());t.getPublicIdentifierError=e=>{try{if("string"!=typeof e)return"Invalid public identifier. Expected a string, got "+typeof e;if(!e.startsWith(t.VECTOR_PUB_ID_PREFIX))return`Invalid public identifier. Expected ${e} to start with ${t.VECTOR_PUB_ID_PREFIX}`;const r=d.getAddressError(t.getSignerAddressFromPublicIdentifier(e));return r?`Invalid public identifier. Got errors recovering address from ${e}: ${r}`:void 0}catch(e){return e.message}};t.isValidPublicIdentifier=e=>!t.getPublicIdentifierError(e)},621:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTransferBalance=t.getTransferParticipant=t.hashWithdrawalQuote=t.decodeWithdrawalQuote=t.encodeWithdrawalQuote=t.hashTransferQuote=t.decodeTransferQuote=t.encodeTransferQuote=t.createlockHash=t.hashCoreTransferState=t.hashTransferState=t.encodeCoreTransferState=t.encodeTransferResolver=t.decodeTransferResolver=t.encodeBalance=t.encodeTransferState=t.getTransferId=void 0;const n=r(27),o=r(1062),c=r(451);t.getTransferId=(e,t,r,n)=>c.keccak256(["address","address","uint256","uint256"],[r,e,n,t]);t.encodeTransferState=(e,t)=>o.defaultAbiCoder.encode([t],[e]);t.encodeBalance=e=>o.defaultAbiCoder.encode([n.BalanceEncoding],[e]);t.decodeTransferResolver=(e,t)=>o.defaultAbiCoder.decode([t],e)[0];t.encodeTransferResolver=(e,t)=>o.defaultAbiCoder.encode([t],[e]);t.encodeCoreTransferState=e=>o.defaultAbiCoder.encode([n.CoreTransferStateEncoding],[e]);t.hashTransferState=(e,r)=>c.keccak256(["bytes"],[t.encodeTransferState(e,r)]);t.hashCoreTransferState=e=>c.keccak256(["bytes"],[t.encodeCoreTransferState(e)]);t.createlockHash=e=>c.sha256(["bytes32"],[e]);t.encodeTransferQuote=e=>o.defaultAbiCoder.encode([n.TransferQuoteEncoding],[e]);t.decodeTransferQuote=e=>{const t=o.defaultAbiCoder.decode([n.TransferQuoteEncoding],e)[0];return{routerIdentifier:t.routerIdentifier,amount:t.amount.toString(),assetId:t.assetId,chainId:t.chainId.toNumber(),recipient:t.recipient,recipientChainId:t.recipientChainId.toNumber(),recipientAssetId:t.recipientAssetId,fee:t.fee.toString(),expiry:t.expiry.toString()}};t.hashTransferQuote=e=>c.keccak256(["bytes"],[t.encodeTransferQuote(e)]);t.encodeWithdrawalQuote=e=>o.defaultAbiCoder.encode([n.WithdrawalQuoteEncoding],[e]);t.decodeWithdrawalQuote=e=>{const t=o.defaultAbiCoder.decode([n.WithdrawalQuoteEncoding],e)[0];return{channelAddress:t.channelAddress,amount:t.amount.toString(),assetId:t.assetId,fee:t.fee.toString(),expiry:t.expiry.toString()}};t.hashWithdrawalQuote=e=>c.keccak256(["bytes"],[t.encodeWithdrawalQuote(e)]);t.getTransferParticipant=(e,t)=>{const r=e.initiatorIdentifier.toLowerCase()===t.toLowerCase();if(r||e.responderIdentifier.toLowerCase()===t.toLowerCase())return r?"initiator":"responder"};t.getTransferBalance=(e,t)=>e.balance.amount["initiator"===t?0:1]},91:function(e,t,r){"use strict";r.d(t,"d",(function(){return v})),r.d(t,"a",(function(){return w})),r.d(t,"c",(function(){return x})),r.d(t,"b",(function(){return O}));var n=r(14),o=r.n(n),c=r(11),l=r(2),d=r(509),h=o.a.BN;const f=new l.b(d.a),m={},y=9007199254740991;function v(e){return null!=e&&(w.isBigNumber(e)||"number"==typeof e&&e%1==0||"string"==typeof e&&!!e.match(/^-?[0-9]+$/)||Object(c.isHexString)(e)||"bigint"==typeof e||Object(c.isBytes)(e))}let T=!1;class w{constructor(e,t){f.checkNew(new.target,w),e!==m&&f.throwError("cannot call constructor directly; use BigNumber.from",l.b.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return S(I(this).fromTwos(e))}toTwos(e){return S(I(this).toTwos(e))}abs(){return"-"===this._hex[0]?w.from(this._hex.substring(1)):this}add(e){return S(I(this).add(I(e)))}sub(e){return S(I(this).sub(I(e)))}div(e){return w.from(e).isZero()&&k("division by zero","div"),S(I(this).div(I(e)))}mul(e){return S(I(this).mul(I(e)))}mod(e){const t=I(e);return t.isNeg()&&k("cannot modulo negative values","mod"),S(I(this).umod(t))}pow(e){const t=I(e);return t.isNeg()&&k("cannot raise to negative values","pow"),S(I(this).pow(t))}and(e){const t=I(e);return(this.isNegative()||t.isNeg())&&k("cannot 'and' negative values","and"),S(I(this).and(t))}or(e){const t=I(e);return(this.isNegative()||t.isNeg())&&k("cannot 'or' negative values","or"),S(I(this).or(t))}xor(e){const t=I(e);return(this.isNegative()||t.isNeg())&&k("cannot 'xor' negative values","xor"),S(I(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&k("cannot mask negative values","mask"),S(I(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&k("cannot shift negative values","shl"),S(I(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&k("cannot shift negative values","shr"),S(I(this).shrn(e))}eq(e){return I(this).eq(I(e))}lt(e){return I(this).lt(I(e))}lte(e){return I(this).lte(I(e))}gt(e){return I(this).gt(I(e))}gte(e){return I(this).gte(I(e))}isNegative(){return"-"===this._hex[0]}isZero(){return I(this).isZero()}toNumber(){try{return I(this).toNumber()}catch(e){k("overflow","toNumber",this.toString())}return null}toString(){return arguments.length>0&&(10===arguments[0]?T||(T=!0,f.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?f.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",l.b.errors.UNEXPECTED_ARGUMENT,{}):f.throwError("BigNumber.toString does not accept parameters",l.b.errors.UNEXPECTED_ARGUMENT,{})),I(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof w)return e;if("string"==typeof e)return e.match(/^-?0x[0-9a-f]+$/i)?new w(m,E(e)):e.match(/^-?[0-9]+$/)?new w(m,E(new h(e))):f.throwArgumentError("invalid BigNumber string","value",e);if("number"==typeof e)return e%1&&k("underflow","BigNumber.from",e),(e>=y||e<=-y)&&k("overflow","BigNumber.from",e),w.from(String(e));const t=e;if("bigint"==typeof t)return w.from(t.toString());if(Object(c.isBytes)(t))return w.from(Object(c.hexlify)(t));if(t)if(t.toHexString){const e=t.toHexString();if("string"==typeof e)return w.from(e)}else{let e=t._hex;if(null==e&&"BigNumber"===t.type&&(e=t.hex),"string"==typeof e&&(Object(c.isHexString)(e)||"-"===e[0]&&Object(c.isHexString)(e.substring(1))))return w.from(e)}return f.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!(!e||!e._isBigNumber)}}function E(e){if("string"!=typeof e)return E(e.toString(16));if("-"===e[0])return"-"===(e=e.substring(1))[0]&&f.throwArgumentError("invalid hex","value",e),"0x00"===(e=E(e))?e:"-"+e;if("0x"!==e.substring(0,2)&&(e="0x"+e),"0x"===e)return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&"0x00"===e.substring(0,4);)e="0x"+e.substring(4);return e}function S(e){return w.from(E(e))}function I(e){const t=w.from(e).toHexString();return"-"===t[0]?new h("-"+t.substring(3),16):new h(t.substring(2),16)}function k(e,t,r){const n={fault:e,operation:t};return null!=r&&(n.value=r),f.throwError(e,l.b.errors.NUMERIC_FAULT,n)}function x(e){return new h(e,36).toString(16)}function O(e){return new h(e,16).toString(36)}},918:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getChainId=void 0;const c=r(96),l=o(r(450));t.getChainId=e=>n(void 0,void 0,void 0,(function*(){const t=yield l.default.post(`${e}`,{id:1,jsonrpc:"2.0",method:"eth_chainId",params:[]},{headers:{"content-type":"application/json"}});return c.BigNumber.from(t.data.result).toNumber()}))},927:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="0x0000000000000000000000000000000000000000"},928:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n="0x0000000000000000000000000000000000000000000000000000000000000000"},929:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getParticipant=t.getBalanceForAssetId=t.hashChannelCommitment=t.hashCoreChannelState=t.encodeCoreChannelState=t.hashBalances=t.hashBalance=void 0;const n=r(27),o=r(1062),c=r(118),l=r(451);t.hashBalance=e=>l.keccak256(["bytes32","bytes32"],[l.keccak256(["uint256[]"],[e.amount]),l.keccak256(["address[]"],[e.to])]);t.hashBalances=e=>l.keccak256(["bytes32[]"],[e.map(t.hashBalance)]);t.encodeCoreChannelState=e=>o.defaultAbiCoder.encode([n.CoreChannelStateEncoding],[e]);t.hashCoreChannelState=e=>l.keccak256(["bytes"],[t.encodeCoreChannelState(e)]);t.hashChannelCommitment=e=>l.keccak256(["bytes"],[o.defaultAbiCoder.encode(["uint8","bytes32"],[n.ChannelCommitmentTypes.ChannelState,t.hashCoreChannelState(e)])]);t.getBalanceForAssetId=(e,t,r)=>{const n=e.assetIds.findIndex((a=>c.getAddress(a)===c.getAddress(t)));return-1===n?"0":e.balances[n].amount["alice"===r?0:1]};t.getParticipant=(e,t)=>{const r=t.toLowerCase()===e.aliceIdentifier.toLowerCase();if(r||t.toLowerCase()===e.bobIdentifier.toLowerCase())return r?"alice":"bob"}},933:function(e,t,r){"use strict";function n(e){for(let i=(e=e.slice()).length-1;i>0;i--){const t=Math.floor(Math.random()*(i+1)),r=e[i];e[i]=e[t],e[t]=r}return e}r.d(t,"a",(function(){return n}))},934:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return f}));var n=r(11),o=r(2),c=r(1091);const l=new o.b(c.a);let d=null;try{if(d=window,null==d)throw new Error("try next")}catch(t){try{if(d=e,null==d)throw new Error("try next")}catch(e){d={}}}let h=d.crypto||d.msCrypto;function f(e){(e<=0||e>1024||e%1)&&l.throwArgumentError("invalid length","length",e);const t=new Uint8Array(e);return h.getRandomValues(t),Object(n.arrayify)(t)}h&&h.getRandomValues||(l.warn("WARNING: Missing strong random number source"),h={getRandomValues:function(e){return l.throwError("no secure random source avaialble",o.b.errors.UNSUPPORTED_OPERATION,{operation:"crypto.getRandomValues"})}})}).call(this,r(21))},946:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=void 0;t.isNode=()=>void 0!==e&&void 0!==e.versions&&void 0!==e.versions.node}).call(this,r(23))},947:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logAxiosError=void 0;t.logAxiosError=(e,t,r={},n="Error sending request")=>{var o;let c={message:null!==(o=t.message)&&void 0!==o?o:n};t.response?c=Object.assign(Object.assign({},c),{data:t.response.data,status:t.response.status,headers:t.response.headers}):t.request&&(c=Object.assign(Object.assign({},c),{request:"Error in request"})),e.error(Object.assign(Object.assign(Object.assign({},c),r),{config:t.config}),n)}},949:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyify=t.safeJsonParse=t.safeJsonStringify=t.stringify=t.deBigNumberifyJson=t.bigNumberifyJson=void 0;const n=r(96),o=r(615),c=r(950);t.bigNumberifyJson=function(e){return"string"==typeof e?e:JSON.parse(JSON.stringify(e),((e,t)=>t&&t._hex&&t._isBigNumber?o.toBN(t._hex):t&&t.hex&&"BigNumber"===t.type?o.toBN(t.hex):t))},t.deBigNumberifyJson=function(e){return JSON.parse(JSON.stringify(e),((e,t)=>t&&o.isBN(t)&&t.toHexString?t.toHexString():t))};t.stringify=(e,t=!1,r=2)=>JSON.stringify(e,((e,r)=>r&&r._hex?n.BigNumber.from(r).toString():t&&r&&"string"==typeof r&&r.startsWith("vector")||t&&r&&"string"==typeof r&&r.startsWith("0x")&&r.length>12?c.abbreviate(r):r),r);const l=(e,t)=>void 0===t?null:t;t.safeJsonStringify=e=>{try{return"string"==typeof e?e:JSON.stringify(e,l)}catch(t){return e}},t.safeJsonParse=function(e){try{return"string"==typeof e?JSON.parse(e,l):e}catch(t){return e}};t.keyify=(e,r,n)=>{const template=n?e[n]:e,data=n?r[n]:r;let output;if(o.isBN(template)||"object"!=typeof template)output=data;else if("object"==typeof template&&"number"==typeof template.length){output=[];for(const e in template)output.push(t.keyify(template,data,e))}else{if("object"!=typeof template||"number"==typeof template.length)throw new Error(`Couldn't keyify, unrecogized key/value: ${n}/${data}`);output={};for(const e in template)output[e]=t.keyify(template,data,e)}return output}},950:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=t.abrv=t.abbreviate=void 0;t.abbreviate=(e,t=4)=>e?e.startsWith("vector")?`${e.substring(0,5+t)}..${e.substring(e.length-t)}`:e.startsWith("0x")?`${e.substring(0,2+t)}..${e.substring(e.length-t)}`:`${e.substring(0,t)}..${e.substring(e.length-t)}`:"undefined";t.abrv=(e,r=4)=>t.abbreviate(e,r);t.capitalize=e=>e.charAt(0).toUpperCase()+e.substring(1)},951:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,c){function l(e){try{h(n.next(e))}catch(e){c(e)}}function d(e){try{h(n.throw(e))}catch(e){c(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,d)}h((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryLockService=t.LOCK_TTL=void 0;const o=r(142),c=r(3156);t.LOCK_TTL=3e4;t.MemoryLockService=class{constructor(){this.locks=new Map,this.ttl=t.LOCK_TTL}acquireLock(e){var t;return n(this,void 0,void 0,(function*(){let r=null===(t=this.locks.get(e))||void 0===t?void 0:t.lock;r||(r=new c.Mutex,this.locks.set(e,{lock:r,releaser:void 0,timer:void 0,secret:void 0}));const n=yield r.acquire(),o=this.randomValue(),l=setTimeout((()=>this.releaseLock(e,o)),this.ttl);return this.locks.set(e,{lock:r,releaser:n,timer:l,secret:o}),o}))}releaseLock(e,t){return n(this,void 0,void 0,(function*(){const r=this.locks.get(e);if(!r)throw new Error(`Can't release a lock that doesn't exist: ${e}`);if(t!==r.secret)throw new Error("Incorrect lock value");return clearTimeout(r.timer),r.releaser()}))}randomValue(){return o.randomBytes(16).toString("hex")}}},952:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDisplayAmount=t.calculateExchangeWad=t.calculateExchangeAmount=t.removeDecimals=t.sanitizeDecimals=t.inverse=t.minBN=t.maxBN=t.fromWad=t.toWad=void 0;const n=r(233),o=r(1070);t.toWad=(e,r=18)=>o.parseUnits(t.sanitizeDecimals(e,r),r);t.fromWad=(e,r=18)=>t.sanitizeDecimals(o.formatUnits(e,r),r);t.maxBN=e=>e.reduce(((e,t)=>e.gt(t)?e:t),n.Zero);t.minBN=e=>e.reduce(((e,t)=>e.lt(t)?e:t),n.MaxUint256);t.inverse=(e,r=18)=>t.fromWad(t.toWad("1",2*r).div(t.toWad(e,r)),r);t.sanitizeDecimals=(e,t=18)=>{const[r,n]=e.split("."),o=n?n.substring(0,t).replace(/0+$/gi,""):void 0;return o?[r,o].join("."):r};t.removeDecimals=e=>{const[t]=e.split(".");return t};t.calculateExchangeAmount=(e,r,n=18)=>{const o=t.toWad(r,n),c=t.toWad(e,2*n).mul(o);return t.fromWad(c,3*n)};t.calculateExchangeWad=(e,r,n,o)=>{const c=t.fromWad(e,r),l=t.calculateExchangeAmount(c,n);return t.toWad(l,o)};t.formatDisplayAmount=(e,t=2,symbol="")=>{const r=symbol.trim()?`${symbol.trim()} `:"",[n,o]=e.split(".");let c=o?o.length<t?o:((e,t=2)=>String(Math.round(Number(e.substring(0,t)+"."+e.substring(t,t+1)))))(o,t):"",l=n;c.length>t&&(c=c.substring(c.length-t,c.length),l=String(Number(n)+1)),c=function(e,t,r="0"){return function(e,t,r,n="0"){const o=t-e.length;let c=e;if(o>0){const t=n.repeat(o);c=r?t+e:e+t}return c}(e,t,!1,r)}(c,t);return`${r}${[l,c].join(".")}`}},96:function(e,t,r){"use strict";r.r(t);var n=r(91);r.d(t,"BigNumber",(function(){return n.a}));var o=r(374);r.d(t,"formatFixed",(function(){return o.c})),r.d(t,"FixedFormat",(function(){return o.a})),r.d(t,"FixedNumber",(function(){return o.b})),r.d(t,"parseFixed",(function(){return o.d})),r.d(t,"_base16To36",(function(){return n.b})),r.d(t,"_base36To16",(function(){return n.c}))},989:function(e,t,r){"use strict";var n=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTestChannelUpdateWithSigners=t.createTestChannelStateWithSigners=t.createTestChannelState=t.createTestChannelUpdate=t.createTestUpdateParams=void 0;const o=r(27),c=r(990),l=r(382);function d(e,t={}){const r={assetId:l.mkAddress("0x0"),balance:{amount:["1","0"],to:[l.mkAddress("0xaaa"),l.mkAddress("0xbbb")]},channelAddress:l.mkAddress("0xccc"),fromIdentifier:l.mkPublicIdentifier("vectorA"),nonce:1,aliceSignature:l.mkSig("0x0001"),bobSignature:l.mkSig("0x0002"),toIdentifier:l.mkPublicIdentifier("vectorB"),type:e},{details:c}=t,d=n(t,["details"]);let details;switch(e){case o.UpdateType.setup:details={networkContext:{chainId:1337,channelFactoryAddress:l.mkAddress("0xccccddddaaaaaffff"),transferRegistryAddress:l.mkAddress("0xffffeeeeeecccc")},timeout:"1"};break;case o.UpdateType.deposit:details={totalDepositsAlice:"10",totalDepositsBob:"5"};break;case o.UpdateType.create:const e={merkleProofData:[l.mkBytes32("0xproof")],merkleRoot:l.mkBytes32("0xeeeeaaaaa333344444"),transferDefinition:l.mkAddress("0xdef"),transferId:l.mkBytes32("0xaaaeee"),transferEncodings:["state","resolver"],balance:{to:[l.mkAddress("0x111"),l.mkAddress("0x222")],amount:["7","0"]},transferInitialState:{lockHash:l.mkBytes32("0xlockHash"),expiry:"0"},transferTimeout:o.DEFAULT_TRANSFER_TIMEOUT.toString()};details=Object.assign({},e);break;case o.UpdateType.resolve:const t={merkleRoot:l.mkBytes32("0xeeeaaa32333"),transferDefinition:l.mkAddress("0xdef"),transferId:l.mkBytes32("0xeee3332222111"),transferResolver:{preImage:l.mkBytes32("0xpre")}};details=Object.assign({},t)}return Object.assign(Object.assign(Object.assign({},r),{details:Object.assign(Object.assign({},details),null!=c?c:{})}),null!=d?d:{})}function h(e,t={},r={}){var h,f,m,y,v,T,w,E,S,I,k,x,O,A,_,N;const C=[null!==(h=t.aliceIdentifier)&&void 0!==h?h:l.mkPublicIdentifier("vectorA"),null!==(f=t.bobIdentifier)&&void 0!==f?f:l.mkPublicIdentifier("vectorB")],R=[null!==(m=t.alice)&&void 0!==m?m:l.mkAddress("0xaaa"),null!==(y=t.bob)&&void 0!==y?y:l.mkAddress("0xbbb")],j=null!==(v=t.channelAddress)&&void 0!==v?v:l.mkAddress("0xccc"),P=null!==(T=t.assetIds)&&void 0!==T?T:[l.mkAddress("0x0"),l.mkAddress("0x1")],B=null!==(w=t.nonce)&&void 0!==w?w:1,D=null!==(E=t.defundNonces)&&void 0!==E?E:["1","1"],{latestUpdate:F,networkContext:U,inDispute:M}=t,H=n(t,["latestUpdate","networkContext","inDispute"]),L=d(e,Object.assign({channelAddress:j,fromIdentifier:C[0],toIdentifier:C[1],assetId:P[0],nonce:B},F));L.details=Object.assign(Object.assign({},L.details),r);const W=e===o.UpdateType.setup?Object.assign({},L.details.networkContext):Object.assign({chainId:1337,channelFactoryAddress:l.mkAddress("0xccccddddaaaaaffff"),transferRegistryAddress:l.mkAddress("0xcc22233323132")},null!=U?U:{}),$=null!=M&&M;let G;return"create"!==e&&"resolve"!==e||(G=c.createTestFullHashlockTransferState(),G.balance=null!==(S=L.balance)&&void 0!==S?S:G.balance,G.meta="create"===e?L.details.meta:void 0,L.details.meta="create"===e?L.details.meta:void 0,G.channelFactoryAddress=null!==(I=W.channelFactoryAddress)&&void 0!==I?I:G.channelFactoryAddress,G.inDispute=null!=$?$:G.inDispute,G.initiator=L.fromIdentifier===C[0]?R[0]:R[1],G.responder=L.toIdentifier===C[0]?R[0]:R[1],G.initiatorIdentifier=L.fromIdentifier===C[0]?C[0]:C[1],G.responderIdentifier=L.toIdentifier===C[0]?C[0]:C[1],G.transferDefinition=null!==(k=L.details.transferDefinition)&&void 0!==k?k:G.transferDefinition,G.transferEncodings=null!==(x=L.details.transferEncodings)&&void 0!==x?x:G.transferEncodings,G.initialStateHash=null!==(O=r.initialStateHash)&&void 0!==O?O:G.initialStateHash,G.transferId=null!==(A=L.details.transferId)&&void 0!==A?A:G.transferId,G.transferResolver="resolve"===e?L.details.transferResolver:void 0,G.transferState=null!==(_=Object.assign({balance:L.details.balance},L.details.transferInitialState))&&void 0!==_?_:G.transferState,G.transferTimeout=null!==(N=L.details.transferTimeout)&&void 0!==N?N:G.transferTimeout,G.chainId=W.chainId,G.channelAddress=j),{channel:Object.assign({assetIds:P,balances:[{amount:["1","2"],to:[...R]},{amount:["1","2"],to:[...R]}],processedDepositsA:["1","2"],processedDepositsB:["1","2"],channelAddress:j,latestUpdate:L,merkleRoot:l.mkHash(),networkContext:W,nonce:B,alice:R[0],bob:R[1],aliceIdentifier:C[0],bobIdentifier:C[1],timeout:"1",defundNonces:D,inDispute:$},H),transfer:G}}t.createTestUpdateParams=function(e,t={}){var r;const base={channelAddress:null!==(r=t.channelAddress)&&void 0!==r?r:l.mkAddress("0xccc"),type:e};let details;switch(e){case o.UpdateType.setup:details={counterpartyIdentifier:l.mkPublicIdentifier("vectorBdea4"),timeout:"1200",networkContext:{chainId:2,channelFactoryAddress:l.mkAddress("0xccccddddaaaaaffff"),transferRegistryAddress:l.mkAddress("0xdddeffff2222")}};break;case o.UpdateType.deposit:details={channelAddress:base.channelAddress,assetId:l.mkAddress()};break;case o.UpdateType.create:details={channelAddress:base.channelAddress,balance:{to:[l.mkAddress("0x111"),l.mkAddress("0x222")],amount:["15","0"]},assetId:l.mkAddress("0x0"),transferDefinition:l.mkAddress("0xdef"),transferInitialState:c.createTestHashlockTransferState(),timeout:"1",meta:{test:"meta"}};break;case o.UpdateType.resolve:details={channelAddress:base.channelAddress,transferId:l.mkBytes32("0xabcdef"),transferResolver:{preImage:l.mkBytes32("0xcdef")},meta:{test:"meta"}}}const{details:d}=t,h=n(t,["details"]);return Object.assign(Object.assign(Object.assign({},base),{details:Object.assign(Object.assign(Object.assign({},details),{channelAddress:base.channelAddress}),null!=d?d:{})}),h)},t.createTestChannelUpdate=d,t.createTestChannelState=h,t.createTestChannelStateWithSigners=function(e,t,r={}){return h(t,Object.assign({aliceIdentifier:e[0].publicIdentifier,bobIdentifier:e[1].publicIdentifier,alice:e[0].address,bob:e[1].address},null!=r?r:{})).channel},t.createTestChannelUpdateWithSigners=function(e,t,r={}){var n,l;const details={};return t===o.UpdateType.create&&(details.transferInitialState=c.createTestHashlockTransferState(Object.assign({},null!==(l=null===(n=r.details)||void 0===n?void 0:n.transferInitialState)&&void 0!==l?l:{}))),d(t,Object.assign({balance:{to:e.map((s=>s.address)),amount:["1","0"]},fromIdentifier:e[0].publicIdentifier,toIdentifier:e[1].publicIdentifier},null!=r?r:{}))}},990:function(e,t,r){"use strict";var n=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTestFullHashlockTransferState=t.createCoreTransferState=t.createTestHashlockTransferStates=t.createTestHashlockTransferState=void 0;const o=r(27),c=r(451),l=r(319),d=r(621),h=r(382);t.createTestHashlockTransferState=(e={})=>Object.assign({lockHash:h.mkHash("0xeee"),expiry:"0"},e);t.createTestHashlockTransferStates=(e=2,r=[])=>Array(e).fill(0).map(((e,n)=>{var o;return t.createTestHashlockTransferState(Object.assign({},null!==(o=r[n])&&void 0!==o?o:{}))}));t.createCoreTransferState=(e={})=>Object.assign({balance:{to:[h.mkAddress("0xaa"),h.mkAddress("0xbbb")],amount:["1","0"]},assetId:h.mkAddress(),channelAddress:h.mkAddress("0xccc"),transferId:h.mkBytes32("0xeeefff"),transferDefinition:h.mkAddress("0xdef"),initialStateHash:h.mkBytes32("0xabcdef"),transferTimeout:"1",initiator:h.mkAddress("0xaa"),responder:h.mkAddress("0xbbb")},e),t.createTestFullHashlockTransferState=function(e={},r){var f,m,y,v,T,w,E,S,I,k;const{assetId:x,preImage:O,expiry:A,meta:meta}=e,_=n(e,["assetId","preImage","expiry","meta"]),N=[o.HashlockTransferStateEncoding,o.HashlockTransferResolverEncoding],C={preImage:null!=O?O:l.getRandomBytes32()},R=t.createTestHashlockTransferState({lockHash:c.sha256(["bytes32"],[C.preImage]),expiry:null!=A?A:"0"}),j={assetId:null!=x?x:h.mkAddress(),chainId:2,channelAddress:h.mkAddress("0xccc"),channelFactoryAddress:h.mkAddress("0xaaaaddddffff"),balance:null!==(f=e.balance)&&void 0!==f?f:{to:[h.mkAddress("0x111"),h.mkAddress("0x222")],amount:["13","0"]},initialStateHash:d.hashTransferState(R,N[0]),meta:null!=meta?meta:{super:"cool stuff",routingId:h.mkHash("0xaabb")},transferDefinition:h.mkAddress("0xdef"),transferEncodings:N,transferId:l.getRandomBytes32(),transferResolver:C,transferState:R,transferTimeout:o.DEFAULT_TRANSFER_TIMEOUT.toString(),initiator:null!==(y=null===(m=e.balance)||void 0===m?void 0:m.to[0])&&void 0!==y?y:h.mkAddress("0x111"),responder:null!==(T=null===(v=e.balance)||void 0===v?void 0:v.to[1])&&void 0!==T?T:h.mkAddress("0x222"),inDispute:!1,initiatorIdentifier:null!==(E=null!==(w=e.initiatorIdentifier)&&void 0!==w?w:null==r?void 0:r.aliceIdentifier)&&void 0!==E?E:h.mkPublicIdentifier("vector111"),responderIdentifier:null!==(I=null!==(S=e.responderIdentifier)&&void 0!==S?S:null==r?void 0:r.bobIdentifier)&&void 0!==I?I:h.mkPublicIdentifier("vector222"),channelNonce:null!==(k=null==r?void 0:r.nonce)&&void 0!==k?k:9},P=r?Object.assign(Object.assign({inDispute:r.inDispute,aliceIdentifier:j.initiatorIdentifier,bobIdentifier:j.responderIdentifier},r.networkContext),r.latestUpdate):{};return Object.assign(Object.assign(Object.assign({},j),_),P)}}}]);
//# sourceMappingURL=9aee009.js.map